alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"检测到SCAN Amap TCP服务扫描"; flow:to_server; flags:PA; content:"service|3A|thc|3A 2F 2F|"; depth:105; content:"service|3A|thc"; within:40; reference:url,freeworld.thc.org/thc-amap/; reference:url,doc.emergingthreats.net/2010371; classtype:attempted-recon; sid:2010371; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"检测到SCAN Amap UDP服务扫描"; dsize:<135; content:"THCTHCTHCTHCTHC|20 20 20|"; reference:url,freeworld.thc.org/thc-amap/; reference:url,doc.emergingthreats.net/2010372; classtype:attempted-recon; sid:2010372; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 69 (msg:"发现Cisco Torch TFTP扫描"; content:"|52 61 6E 64 30 6D 53 54 52 49 4E 47 00 6E 65 74 61 73 63 69 69|"; offset:2; depth:21; reference:url,www.hackingexposedcisco.com/?link=tools; reference:url,www.securiteam.com/tools/5EP0F1FEUA.html; reference:url,doc.emergingthreats.net/2008414; classtype:attempted-recon; sid:2008414; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"从单个源扫描多个FTP根登录尝试-可能的暴力尝试"; flow:established,to_server; content:"USER "; nocase; depth:5; content:"root"; within:15; nocase; threshold: type threshold, track by_src, count 5, seconds 60; reference:url,doc.emergingthreats.net/2010642; classtype:attempted-recon; sid:2010642; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"从单一来源扫描多个FTP管理员登录尝试-可能的暴力破解尝试"; flow:established,to_server; content:"USER "; nocase; depth:5; content:"administrator"; within:25; nocase; threshold: type threshold, track by_src, count 5, seconds 60; reference:url,doc.emergingthreats.net/2010643; classtype:attempted-recon; sid:2010643; metadata:alarm_type 恶意扫描;)
alert tcp any any -> any 21 (msg:"发现 Grim的Ping ftp扫描工具"; flow:to_server,established; content:"PASS "; content:"gpuser@home.com"; within:18; reference:url,archives.neohapsis.com/archives/snort/2002-04/0448.html; reference:url,grimsping.cjb.net; reference:url,doc.emergingthreats.net/2007802; classtype:network-scan; sid:2007802; metadata:alarm_type 恶意扫描;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 ICMP PING IP工具"; itype: 8; icode: 0; content:"|A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7 A7|"; depth: 64; reference:url,www.ks-soft.net/ip-tools.eng; reference:url,www.ks-soft.net/ip-tools.eng/index.htm; reference:url,doc.emergingthreats.net/2000575; classtype:misc-activity; sid:2000575; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1434 (msg:"利用服务远程拒绝服务攻击漏洞MS02-039攻击"; content:"nng Snort (Snort)"; offset:90; threshold:type threshold, track by_dst, count 4, seconds 15; reference:url,packetstormsecurity.nl/filedesc/nng-4.13r-public.rar.html; reference:url,doc.emergingthreats.net/2008560; classtype:misc-activity; sid:2008560; metadata:alarm_type 漏洞利用;)
#alert tcp any any -> any 502 (msg:"检测到SCAN Modbus扫描"; content:"|00 00 00 00 00 02|"; flow:established,to_server; depth:6; threshold: type both, track by_src, count 100, seconds 10; reference:url,code.google.com/p/modscan/; reference:url,www.rtaautomation.com/modbustcp/; reference:url,doc.emergingthreats.net/2009286; classtype:bad-unknown; sid:2009286; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"发现MYSQL 4.0暴力root登录尝试"; flow:to_server,established; content:"|01|"; offset:3; depth:4; content:"root|00|"; nocase; distance:5; within:5; threshold:type both,track by_src,count 5,seconds 60; reference:url,www.redferni.uklinux.net/mysql/MySQL-323.html; reference:url,doc.emergingthreats.net/2001906; classtype:protocol-command-decode; sid:2001906; metadata:alarm_type 暴力破解;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"发现MYSQL 4.1暴力root登录尝试"; flow:to_server,established; content:"|01|"; offset:3; depth:4; content:"root|00|"; nocase; distance:32; within:5; threshold:type both,track by_src,count 5,seconds 60; reference:url,www.redferni.uklinux.net/mysql/MySQL-Protocol.html; reference:url,doc.emergingthreats.net/2002842; classtype:protocol-command-decode; sid:2002842; metadata:alarm_type 暴力破解;)
alert tcp $HOME_NET 3306 -> any any (msg:"发现存在不允许的主机尝试连接到MySQL服务器"; flow:from_server,established; content:"|6A 04|Host|20 27|"; depth:70; content:"|27 20|is not allowed to connect to this MySQL server"; distance:0; reference:url,www.cyberciti.biz/tips/how-do-i-enable-remote-access-to-mysql-database-server.html; reference:url,doc.emergingthreats.net/2010493; classtype:attempted-recon; sid:2010493; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP -sS窗口2048"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000537; classtype:attempted-recon; sid:2000537; metadata:alarm_type 恶意扫描;)
#alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP"; dsize:0; ip_proto:21; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000536; classtype:attempted-recon; sid:2000536; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP -sA（1）"; fragbits:!D; dsize:0; flags:A,12; window:1024; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000538; classtype:attempted-recon; sid:2000538; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP -sA（2）"; fragbits:!D; dsize:0; flags:A,12; window:3072; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000540; classtype:attempted-recon; sid:2000540; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP -f -sF"; fragbits:!M; dsize:0; flags:F,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000543; classtype:attempted-recon; sid:2000543; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP -f -sN"; fragbits:!M; dsize:0; flags:0,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000544; classtype:attempted-recon; sid:2000544; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP -f -sX"; fragbits:!M; dsize:0; flags:FPU,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000546; classtype:attempted-recon; sid:2000546; metadata:alarm_type 恶意扫描;)
#alert udp $HOME_NET 137 -> $EXTERNAL_NET any (msg:"发现对外部目标的多个NBTStat查询响应，可能会自动进行Windows网络枚举"; content:"|20 43 4b 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 00 00 21|"; depth:55; threshold: type threshold, track by_dst, count 10, seconds 60; reference:url,technet.microsoft.com/en-us/library/cc940106.aspx; reference:url,doc.emergingthreats.net/2009767; classtype:attempted-recon; sid:2009767; metadata:alarm_type 恶意扫描;)
#alert udp $HOME_NET 137 -> $EXTERNAL_NET any (msg:"发现对外部目标的多个NBTStat查询响应，可能的Windows网络枚举"; content:"|20 43 4b 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 00 00 21|"; depth:55; reference:url,technet.microsoft.com/en-us/library/cc940106.aspx; reference:url,doc.emergingthreats.net/2009768; classtype:attempted-recon; sid:2009768; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"发现专业搜索爬虫探测器"; flow:to_server,established; content:"PASS "; nocase; depth:5; content:"crawler"; nocase; within:30; pcre:"/^PASS\s+PRO(-|\s)*search\s+Crawler/smi"; reference:url,sourceforge.net/project/showfiles.php?group_id=149797; reference:url,doc.emergingthreats.net/2008179; classtype:not-suspicious; sid:2008179; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现敏感信息扫描"; content:"From|3A 20 22|sipvicious"; threshold: type limit, count 1, seconds 10, track by_src; reference:url,blog.sipvicious.org; reference:url,doc.emergingthreats.net/2008578; classtype:attempted-recon; sid:2008578; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"检测到扫描Sipvicious用户代理（sundayddr）"; content:"|0d 0a|User-Agent|3A| sundayddr"; threshold: type limit, count 1, seconds 60, track by_src; reference:url,honeynet.org.au/?q=sunday_scanner; reference:url,code.google.com/p/sipvicious/; reference:url,blog.sipvicious.org/; reference:url,doc.emergingthreats.net/2011766; classtype:attempted-recon; sid:2011766; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现Sipsak SIP扫描"; content:"sip|3a|sipsak@"; offset:90; reference:url,sipsak.org/; reference:url,doc.emergingthreats.net/2008598; classtype:attempted-recon; sid:2008598; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现Sivus VOIP漏洞扫描程序SIP扫描"; content:"SIVuS_VoIP_Scanner <sip|3a|SIVuS"; offset:130; threshold:type threshold, track by_src, count 3, seconds 10; reference:url,www.security-database.com/toolswatch/SiVus-VoIP-Security-Scanner-1-09.html; reference:url,www.vopsecurity.org/; reference:url,doc.emergingthreats.net/2008609; classtype:attempted-recon; sid:2008609; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现Sivus VOIP漏洞扫描程序SIP组件扫描"; content:"sip|3a|sivus-discovery@vopsecurity.org"; offset:110; reference:url,www.security-database.com/toolswatch/SiVus-VoIP-Security-Scanner-1-09.html; reference:url,www.vopsecurity.org/; reference:url,doc.emergingthreats.net/2008610; classtype:attempted-recon; sid:2008610; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"发现内部UPnP请求udp端口1900外部"; content:"MSEARCH * HTTP/1.1"; depth:18; content:"MAN|3a| ssdp|3a|"; nocase; distance:0; reference:url,www.upnp-hacks.org/upnp.html; reference:url,doc.emergingthreats.net/2008094; classtype:attempted-recon; sid:2008094; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现Smap VOIP设备扫描"; content:"<sip|3a|smap@"; offset:80; depth:40; reference:url,www.go2linux.org/smap-find-voip-enabled-devices; reference:url,doc.emergingthreats.net/2008526; classtype:attempted-recon; sid:2008526; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现Voiper工具包酷刑扫描"; content:"interesting-Method"; content:"sip|3a|1_unusual.URI"; content:"to-be!sure"; offset:20; depth:60; reference:url,sourceforge.net/projects/voiper; reference:url,doc.emergingthreats.net/2008568; classtype:attempted-recon; sid:2008568; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现Voiper模糊扫描"; content:"sip|3a|tester@"; content:"Via|3a| SIP/2.0"; offset:20; depth:60; threshold: type threshold, track by_dst, count 5, seconds 15; reference:url,sourceforge.net/projects/voiper; reference:url,doc.emergingthreats.net/2008577; classtype:attempted-recon; sid:2008577; metadata:alarm_type 恶意扫描;)
#alert http $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"发现异常快的400错误消息（错误请求），可能进行Web应用程序扫描"; flow:from_server,established; content:"HTTP/1.1 400"; depth:13; threshold: type threshold, track by_dst, count 30, seconds 60; reference:url,www.w3.org/Protocols/rfc2616/rfc2616-sec10.html; reference:url,support.microsoft.com/kb/247249; reference:url,doc.emergingthreats.net/2009884; classtype:attempted-recon; sid:2009884; metadata:alarm_type 恶意扫描;)
#alert http $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"发现异常快404错误消息（找不到页面），可能是Web应用程序扫描/目录猜测攻击"; flow:from_server,established; content:"HTTP/1.1 404"; depth:13; threshold: type threshold, track by_dst, count 30, seconds 60; reference:url,www.w3.org/Protocols/rfc2616/rfc2616-sec10.html; reference:url,en.wikipedia.org/wiki/HTTP_404; reference:url,doc.emergingthreats.net/2009885; classtype:attempted-recon; sid:2009885; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"发现尝试将ProxyReconBot POST方法发送到邮件"; flow:established,to_server; content:"POST "; depth:5; content:"|3A|25 HTTP/"; within:200; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2003870; classtype:misc-attack; sid:2003870; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现SIP擦除_注册/添加注册尝试"; content:"REGISTER "; depth:9; content:"User-Agent|3a| Hacker"; reference:url,www.hackingvoip.com/sec_tools.html; reference:url,doc.emergingthreats.net/2008640; classtype:attempted-recon; sid:2008640; metadata:alarm_type 恶意扫描;)
#alert http $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"发现异常快403错误消息，可能进行Web应用程序扫描"; flow:from_server,established; content:"HTTP/1.1 403"; depth:13; threshold: type threshold, track by_dst, count 35, seconds 60; reference:url,www.checkupdown.com/status/E403.html; reference:url,doc.emergingthreats.net/2009749; classtype:attempted-recon; sid:2009749; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,1024:2048] (msg:"发现DCERPC rpcmgmt ifids未经身份验证的绑定"; flow:established,to_server; content:"|05|"; content:"|80 bd a8 af 8a 7d c9 11 be f4 08 00 2b 10 29 89|"; distance:31; reference:url,www.symantec.com/avcenter/reference/Vista_Network_Attack_Surface_RTM.pdf; reference:url,www.blackhat.com/presentations/win-usa-04/bh-win-04-seki-up2.pdf; reference:url,seclists.org/fulldisclosure/2003/Aug/0432.html; reference:url,doc.emergingthreats.net/2009832; classtype:attempted-recon; sid:2009832; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"发现Acunetix版本6（免费版）扫描行为"; flow:to_server,established; content:"(Acunetix Web Vulnerability Scanner"; nocase; threshold: type limit, count 1, seconds 60, track by_src; reference:url,www.acunetix.com/; reference:url,doc.emergingthreats.net/2009646; classtype:attempted-recon; sid:2009646; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"发现使用RatProxy进行检测"; flow:established,to_server; content:"X-Ratproxy-Loop|3A| "; threshold: type limit, track by_src,count 1, seconds 60; classtype:attempted-recon; sid:2011975; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现Sipp SIP进行扫描"; content:"sip|3a|sipp@"; content:"Subject|3a| Performance Test"; offset:90; depth:90; threshold: type threshold, track by_dst, count 20, seconds 15; reference:url,sourceforge.net/projects/sipp/; reference:url,doc.emergingthreats.net/2008579; classtype:attempted-recon; sid:2008579; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现sipscan扫描"; content:"sip|3a|thisisthecanary@"; content:"sip|3a|test@"; offset:30; depth:70; reference:url,www.hackingvoip.com/sec_tools.html; reference:url,doc.emergingthreats.net/2008641; classtype:attempted-recon; sid:2008641; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现Sipvicious Sundayddr（sipsscuser）行为"; content:"From|3A 20 22|sipsscuser|22|"; threshold: type limit, count 1, seconds 60, track by_src; reference:url,code.google.com/p/sipvicious/; reference:url,blog.sipvicious.org/; reference:url,honeynet.org.au/?q=sunday_scanner; classtype:attempted-recon; sid:2012204; metadata:alarm_type 恶意扫描;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现SolarWinds IP扫描尝试"; icode:0; itype:8; content:"SolarWinds.Net"; nocase; classtype:network-scan; sid:2101918; metadata:alarm_type 恶意扫描;)
#alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 Broadscan蓝精灵扫描仪"; dsize:4; icmp_id:0; icmp_seq:0; itype:8; classtype:attempted-recon; sid:2100478; metadata:alarm_type 恶意扫描;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现ISS指纹"; itype:8; content:"ISSPNGRQ"; depth:32; reference:arachnids,158; classtype:attempted-recon; sid:2100465; metadata:alarm_type 恶意扫描;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现PING Cyber​​Kit 2.2 Windows"; itype:8; content:"|AA AA AA AA AA AA AA AA AA AA AA AA AA AA AA AA|"; depth:32; reference:arachnids,154; classtype:misc-activity; sid:2100483; metadata:alarm_type 恶意扫描;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Delphi-Piette Windows"; itype:8; content:"Pinging from Del"; depth:32; reference:arachnids,155; classtype:misc-activity; sid:2100372; metadata:alarm_type 恶意扫描;)
#alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 PING NMAP"; dsize:0; itype:8; reference:arachnids,162; classtype:attempted-recon; sid:2100469; metadata:alarm_type 恶意扫描;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Ping Sniffer Pro / NetXRay网络扫描"; itype:8; content:"Cinco Network, Inc."; depth:32; classtype:misc-activity; sid:2100484; metadata:alarm_type 恶意扫描;)
#alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现icmpenum v1.1.1"; dsize:0; icmp_id:666 ; icmp_seq:0; id:666; itype:8; reference:arachnids,450; classtype:attempted-recon; sid:2100471; metadata:alarm_type 恶意扫描;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现superscan echo"; dsize:8; itype:8; content:"|00 00 00 00 00 00 00 00|"; classtype:attempted-recon; sid:2100474; metadata:alarm_type 恶意扫描;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现webtrends scanner"; icode:0; itype:8; content:"|00 00 00 00|EEEEEEEEEEEE"; reference:arachnids,307; classtype:attempted-recon; sid:2100476; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"发现SSH版本映射尝试"; flow:to_server,established; content:"Version_Mapper"; nocase; classtype:network-scan; sid:2101638; metadata:alarm_type 恶意扫描;)
#alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Webtrends扫描仪UDP探针"; content:"|0A|help|0A|quite|0A|"; classtype:attempted-recon; sid:2100637; metadata:alarm_type 恶意扫描;)
alert ftp any any -> $HOME_NET any (msg:"检测到SCAN Nessus FTP扫描（ftp_anonymous.nasl）"; flow:to_server,established; content:"pass nessus@"; depth:12; nocase; reference:url,www.nessus.org/plugins/index.php?view=single&id=10079; reference:url,osvdb.org/show/osvdb/69; classtype:attempted-recon; sid:2013263; metadata:alarm_type 恶意扫描;)
alert ftp $EXTERNAL_NET any -> $HOME_NET any (msg:"检测到SCAN Nessus FTP扫描（ftp_writeable_directories.nasl）"; flow:to_server,established; content:"MKD"; nocase; depth:3; content:"Nessus"; nocase; reference:url,www.nessus.org/plugins/index.php?view=single&id=19782; reference:url,osvdb.org/show/osvdb/76; classtype:attempted-recon; sid:2013264; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现指纹版本查询"; flow:to_server,established; content:"version"; classtype:attempted-recon; sid:2101541; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现潜在的muieblackcat扫描仪双URI和HTTP库"; flow:established,to_server; content:"GET //"; depth:6; fast_pattern; content:"HTTP/1.1|0d 0a|Accept|3a| */*|0d 0a|Accept-Language|3a| en-us|0d 0a|Accept-Encoding|3a| gzip, deflate|0d 0a|Host|3a| "; http_header; content:"|0d 0a|Connection|3a| Close|0d 0a 0d 0a|"; http_header; distance:0; metadata: former_category SCAN; classtype:attempted-recon; sid:2013116; metadata:alarm_type 恶意扫描;)
#alert ip any any <> 127.0.0.0/8 any (msg:"发现环回流量";  reference:url,rr.sans.org/firewall/egress.php; classtype:bad-unknown; sid:2100528; metadata:alarm_type 恶意扫描;)
#alert ip any any -> any any (msg:"发现相同的SRC/DST"; sameip; reference:bugtraq,2666; reference:cve,1999-0016; reference:url,www.cert.org/advisories/CA-1997-28.html; classtype:bad-unknown; sid:2100527; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现指纹识别行为"; flow:to_server,established; content:"."; reference:arachnids,130; reference:cve,1999-0198; reference:nessus,10072; classtype:attempted-recon; sid:2100333; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现指纹/执行尝试"; flow:to_server,established; content:"/"; pcre:"/^\x2f/smi"; reference:cve,1999-0612; reference:cve,2000-0915; classtype:attempted-recon; sid:2103151; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现指纹识别行为"; flow:to_server,established; content:"0"; reference:arachnids,131; reference:arachnids,378; reference:cve,1999-0197; reference:nessus,10069; classtype:attempted-recon; sid:2100332; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现指纹帐户枚举尝试"; flow:to_server,established; content:"a b c d e f"; nocase; reference:nessus,10788; classtype:attempted-recon; sid:2100321; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现网络警察查询"; flow:to_server,established; content:"|0A|     "; depth:10; reference:arachnids,132; reference:cve,1999-0612; classtype:attempted-recon; sid:2100331; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现Cyber​​cop重定向"; dsize:11; flow:to_server,established; content:"@localhost|0A|"; reference:arachnids,11; classtype:attempted-recon; sid:2100329; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现指纹空请求"; flow:to_server,established; content:"|00|"; reference:arachnids,377; classtype:attempted-recon; sid:2100324; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现指纹探针0尝试"; flow:to_server,established; content:"0"; reference:arachnids,378; classtype:attempted-recon; sid:2100325; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现指纹重定向尝试"; flow:to_server,established; content:"@"; reference:arachnids,251; reference:cve,1999-0105; reference:nessus,10073; classtype:attempted-recon; sid:2100330; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现指纹根查询"; flow:to_server,established; content:"root"; reference:arachnids,376; classtype:attempted-recon; sid:2100323; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"发现指纹搜索查询"; flow:to_server,established; content:"search"; reference:arachnids,375; reference:cve,1999-0259; classtype:attempted-recon; sid:2100322; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"发现adm扫描"; flow:to_server,established; content:"PASS ddd@|0A|"; reference:arachnids,332; classtype:suspicious-login; sid:2100353; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 4569 (msg:"发现Enumiax星号间交换协议用户名扫描"; content:"|00 00|"; content:"|06 0D 06 01 30 13 02 07 08|"; distance:40; within:10; reference:url,sourceforge.net/projects/enumiax/; reference:url,doc.emergingthreats.net/2008606; classtype:attempted-recon; sid:2008606; metadata:alarm_type 恶意扫描;)
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"对Xprobe2 OS指纹扫描的SCAN端口无法访问的响应"; itype:3; dsize:>69; content:"securityfocus"; content:"securityfocus"; distance:50; within:15; reference:url,xprobe.sourceforge.net/; reference:url,doc.emergingthreats.net/2009298; classtype:attempted-recon; sid:2009298; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现可能检测到jBroFuzz Fuzzer"; flow:to_server,established; content:"Host|3a| localhost"; fast_pattern; http_header; content:"User-Agent|3a| Mozilla/5.0 (Windows|3b| U|3b| Windows NT 5.1|3b| en-GB|3b| rv|3b|1.8.1.1) Gecko/20061204 Firefox/2.0.0.1"; http_header; threshold: type threshold, track by_src, count 3, seconds 6; reference:url,www.owasp.org/index.php/Category%3aOWASP_JBroFuzz; reference:url,doc.emergingthreats.net/2009476; classtype:attempted-recon; sid:2009476; metadata:alarm_type 恶意扫描;)
#alert tcp [184.154.42.194,50.116.22.209,69.64.43.135,69.64.43.137,69.64.43.142,216.17.107.104,216.17.102.194,216.17.106.90,216.17.107.174,64.6.100.124,46.17.98.214] any -> $HOME_NET any (msg:"发现critical.io扫描"; threshold: type limit, track by_src, seconds 3600, count 1; reference:url,critical.io/; classtype:network-scan; sid:2014893; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"发现尝试HTExploit方法"; flow:established,to_server; dsize:>6; content:"POTATO "; depth:7; reference:url,www.mkit.com.ar/labs/htexploit/download.php; classtype:trojan-activity; sid:2015552; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现空指令"; flow:stateless; ack:0; flags:0; seq:0; reference:arachnids,4; classtype:attempted-recon; sid:2100623; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现XMAS"; flow:stateless; flags:SRAFPU,12; reference:arachnids,144; classtype:attempted-recon; sid:2100625; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现cybercop os PA12尝试"; flow:stateless; flags:PA12; content:"AAAAAAAAAAAAAAAA"; depth:16; reference:arachnids,149; classtype:attempted-recon; sid:2100626; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现cybercop os SFU12探头"; flow:stateless; ack:0; flags:SFU12; content:"AAAAAAAAAAAAAAAA"; depth:16; reference:arachnids,150; classtype:attempted-recon; sid:2100627; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP TCP"; ack:0; flags:A,12; flow:stateless; reference:arachnids,28; classtype:attempted-recon; sid:2100628; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP XMAS"; flow:stateless; flags:FPU,12; reference:arachnids,30; classtype:attempted-recon; sid:2101228; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP指纹尝试"; flags:SFPU; flow:stateless; reference:arachnids,05; classtype:attempted-recon; sid:2100629; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现scanpost.exe命令外壳尝试"; flow:to_server,established; content:"/sensepost.exe"; http_uri; nocase; reference:nessus,11003; classtype:web-application-activity; sid:2100989; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET 10101 -> $HOME_NET any (msg:"发现myscan"; flow:stateless; ack:0; flags:S; ttl:>220; reference:arachnids,439; classtype:attempted-recon; sid:2100613; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现SYN FIN"; flow:stateless; flags:SF,12; reference:arachnids,198; classtype:attempted-recon; sid:2100624; metadata:alarm_type 恶意扫描;)
#alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现rusers查询UDP"; content:"|00 01 86 A2|"; depth:4; offset:12; content:"|00 00 00 02|"; within:4; distance:4; content:"|00 00 00 00|"; depth:4; offset:4; reference:cve,1999-0626; classtype:attempted-recon; sid:2100612; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"发现ssh-research-scanner"; flow:to_server,established; content:"|00 00 00|`|00 00 00 00 00 00 00 00 01 00 00 00|"; classtype:attempted-recon; sid:2100617; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NetGear路由器默认密码登录尝试admin/password"; flow:to_server,established; content:"Authorization|3A|"; http_header; nocase; content:"YWRtaW46cGFzc3dvcmQ"; distance:0; http_header; pcre:"/^Authorization\x3a\s*Basic\s+YWRtaW46cGFzc3dvcmQ/Hi"; reference:nessus,11737; classtype:default-login-attempt; sid:2102230; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"发现Cyber​​cop OS探头"; flow:stateless; ack:0; flags:SFP; content:"AAAAAAAAAAAAAAAA"; depth:16; reference:arachnids,145; classtype:attempted-recon; sid:2101133; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"发现whisker HEAD/./"; flow:to_server,established; content:"HEAD/./"; reference:url,www.wiretrip.net/rfp/pages/whitepapers/whiskerids.html; classtype:attempted-recon; sid:2101139; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现网络警察扫描"; flow:to_server,established; content:"/cybercop"; http_uri; nocase; reference:arachnids,374; classtype:web-application-activity; sid:2101099; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"发现Cyber​​cop OS探头"; flow:stateless; dsize:0; flags:SF12; reference:arachnids,146; classtype:attempted-recon; sid:2100619; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现SCAN Sipvicious User-Agent（友好扫描仪）"; content:"|0d 0a|User-Agent|3A| friendly-scanner"; threshold: type limit, track by_src, count 5, seconds 120; reference:url,code.google.com/p/sipvicious/; reference:url,blog.sipvicious.org/; reference:url,doc.emergingthreats.net/2011716; classtype:attempted-recon; sid:2011716; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现可能的SQLMAP扫描"; flow:established,to_server; content:" AND "; http_uri; content:"AND ("; http_uri; pcre:"/\x20AND\x20[0-9]{6}\x3D[0-9]{4}/U"; detection_filter:track by_dst, count 4, seconds 20; reference:url,sqlmap.sourceforge.net; reference:url,www.darknet.org.uk/2011/04/sqlmap-0-9-released-automatic-blind-sql-injection-tool/; classtype:attempted-recon; sid:2012755; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"发现MYSQL MySQL远程FAST帐户密码破解"; flow:to_server,established; content:"|11|"; offset:3; depth:4; threshold:type both,track by_src,count 100,seconds 1; reference:url,www.securityfocus.com/archive/1/524927/30/0/threaded; classtype:protocol-command-decode; sid:2015986; metadata:alarm_type 暴力破解;)
#alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Nemesis v1.1 Echo"; dsize:20; icmp_id:0; icmp_seq:0; itype:8; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; reference:arachnids,449; classtype:attempted-recon; sid:2100467; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"通过许多多字节范围值扫描Apache mod_deflate DoS"; flow:established,to_server; content:"Range|3a|"; nocase; content:"bytes="; nocase; distance:0; isdataat:10,relative; content:","; within:11; isdataat:10,relative; content:","; within:11; isdataat:10,relative; content:","; within:11; isdataat:70,relative; content:!"|0d 0a|"; within:12; pcre:"/Range\x3a\s?bytes=[-0-9,\x20]{100}/iH"; reference:url,seclists.org/fulldisclosure/2011/Aug/175; classtype:attempted-dos; sid:2013473; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Arachni Web扫描"; flow:established,to_server; content:"/Arachni-"; http_uri; threshold: type limit, track by_src, seconds 60, count 1; reference:url,www.arachni-scanner.com/; classtype:attempted-recon; sid:2017142; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"发现HTTP GET方法无效的情况"; flow:established,to_server; content:"get "; depth:4; nocase; content:!"GET "; depth:4; reference:url,www.w3.org/Protocols/rfc2616/rfc2616-sec9.html; reference:url,doc.emergingthreats.net/2011031; classtype:bad-unknown; sid:2011031; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"发现HTTP POST无效方法案例"; flow:established,to_server; content:"post "; depth:5; nocase; content:!"POST "; depth:5; reference:url,www.w3.org/Protocols/rfc2616/rfc2616-sec9.html; reference:url,doc.emergingthreats.net/2011032; classtype:bad-unknown; sid:2011032; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"发现HTTP HEAD无效方法案例"; flow:established,to_server; content:"head "; depth:5; nocase; content:!"HEAD "; depth:5; reference:url,www.w3.org/Protocols/rfc2616/rfc2616-sec9.html; reference:url,doc.emergingthreats.net/2011033; classtype:bad-unknown; sid:2011033; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP -sS窗口1024"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:1024; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2009582; classtype:attempted-recon; sid:2009582; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP -sS窗口3072"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:3072; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2009583; classtype:attempted-recon; sid:2009583; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP -sS窗口4096"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:4096; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2009584; classtype:attempted-recon; sid:2009584; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"发现NMAP SIP版本检测选项扫描"; flow:established,to_server; content:"OPTIONS sip|3A|nm SIP/"; depth:19; classtype:attempted-recon; sid:2018317; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5060:5061 (msg:"发现 NMAP SIP版本检测脚本活动"; content:"Via|3A| SIP/2.0/TCP nm"; content:"From|3A| <sip|3A|nm@nm"; within:150; fast_pattern; classtype:attempted-recon; sid:2018318; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现NMAP -f -sV"; fragbits:!M; dsize:0; flags:S,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000545; classtype:attempted-recon; sid:2000545; metadata:alarm_type 恶意扫描;)
#alert tcp 188.95.234.6 any -> $HOME_NET [22,443] (msg:"运行扫描SCAN Non-Malicious SSH / SSL Scanner"; threshold: type limit, track by_src, seconds 60, count 1; reference:url,pki.net.in.tum.de/node/21; reference:url,isc.sans.edu/diary/SSH%2bscans%2bfrom%2b188.95.234.6/15532; classtype:network-scan; sid:2016763; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"发现SQL Ninja MSSQL版本扫描"; flow:to_server,established; content:"?param=a"; content:"if%20not%28substring%28%28select%20%40%40version"; distance:2; reference:url,sqlninja.sourceforge.net/index.html; reference:url,doc.emergingthreats.net/2009038; classtype:attempted-recon; sid:2009038; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Pangolin SQL注入工具"; flow:established,to_server; content:"pangolin"; http_user_agent; reference:url,www.lifedork.net/pangolin-best-sql-injection-tool.html; classtype:web-application-activity; sid:2010343; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"发现可能检测到的DavTest WebDav漏洞扫描程序初始检查"; flow:established,to_server; content:"PROPFIND "; depth:9; content:"D|3A|propfind xmlns|3A|D=|22|DAV|3A 22|><D|3A|allprop/></D|3A|propfind>"; distance:0; reference:url,www.darknet.org.uk/2010/04/davtest-webdav-vulerability-scanning-scanner-tool/; reference:url,code.google.com/p/davtest/; reference:url,doc.emergingthreats.net/2011088; classtype:attempted-recon; sid:2011088; metadata:alarm_type 恶意扫描;)
#alert tcp any any -> any any (msg:"发现格式错误的数据包SYN FIN"; flags:SF; classtype:bad-unknown; sid:2011367; metadata:alarm_type 恶意扫描;)
#alert tcp any any -> any any (msg:"发现格式错误的数据包SYN RST"; flags:SR; classtype:bad-unknown; sid:2011368; metadata:alarm_type 恶意扫描;)
alert tcp any any -> $HOME_NET 1720 (msg:"发现H.323扫描设备"; flow:established,to_server; content:"|40 04 00 63 00 69 00 73 00 63 00 6f|"; fast_pattern; offset:55; depth:12; threshold: type limit, track by_src, count 1, seconds 60; reference:url,videonationsltd.co.uk/2014/11/h-323-cisco-spam-calls/; classtype:network-scan; sid:2020853; metadata:alarm_type 恶意扫描;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现ICMP = XXXXXXXX可能要扫描的前体"; itype:8; icode:0; content:"=XXXXXXXX"; reference:url,doc.emergingthreats.net/2010686; classtype:network-scan; sid:2010686; metadata:alarm_type 恶意扫描;)
alert ssh $EXTERNAL_NET any -> $HOME_NET 22 (msg:"基于SCAN LibSSH的频繁SSH连接可能是暴力攻击"; flow:established,to_server; content:"SSH-"; content:"libssh"; within:20; threshold: type both, count 5, seconds 30, track by_src; reference:url,doc.emergingthreats.net/2006546; classtype:attempted-admin; sid:2006546; metadata:alarm_type 暴力破解;)
alert tcp $HOME_NET 21 -> $EXTERNAL_NET any (msg:"发现潜在的FTP暴力尝试响应"; flow:from_server,established; dsize:<100; content:"530 "; depth:4; pcre:"/530\s+(Login|User|Failed|Not)/smi"; threshold: type threshold, track by_dst, count 5, seconds 300; reference:url,doc.emergingthreats.net/2002383; classtype:unsuccessful-user; sid:2002383; metadata:alarm_type 恶意扫描;)
alert tcp any any -> $HOME_NET any (msg:"发现NMAP NSE Heartbleed请求"; flow:established,to_server; content:"|18 03|"; depth:2; byte_test:1,<,4,2; content:"|01|"; offset:5; depth:1; byte_test:2,>,2,3; byte_test:2,>,200,6; content:"|40 00|Nmap ssl-heartbleed"; fast_pattern:2,19; classtype:attempted-recon; sid:2021023; metadata:alarm_type 恶意扫描;)
alert tcp $HOME_NET any -> any any (msg:"发现 Nmap NSE Heartbleed反应"; flow:established,from_server; content:"|18 03|"; depth:2; byte_test:1,<,4,2; byte_test:2,>,200,3; content:"|40 00|Nmap ssl-heartbleed"; fast_pattern:2,19; classtype:attempted-recon; sid:2021024; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"发现HTTP选项无效的方法案例"; flow:established,to_server; content:"options"; http_method; nocase; content:!"OPTIONS"; http_method; reference:url,www.w3.org/Protocols/rfc2616/rfc2616-sec9.html; reference:url,doc.emergingthreats.net/2011034; classtype:bad-unknown; sid:2011034; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"发现潜在的SSH扫描"; flow:to_server; flags:S,12; threshold: type both, track by_src, count 5, seconds 120; reference:url,en.wikipedia.org/wiki/Brute_force_attack; reference:url,doc.emergingthreats.net/2001219; classtype:attempted-recon; sid:2001219; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5800:5820 (msg:"发现Potential VNC扫描5800-5820"; flow:to_server; flags:S,12; threshold: type both, track by_src, count 5, seconds 60; reference:url,doc.emergingthreats.net/2002910; classtype:attempted-recon; sid:2002910; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5900:5920 (msg:"发现Potential VNC扫描5900-5920"; flow:to_server; flags:S,12; threshold: type both, track by_src, count 5, seconds 60; reference:url,doc.emergingthreats.net/2002911; classtype:attempted-recon; sid:2002911; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 (msg:"发现快速POP3连接-可能的暴力攻击"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 30, seconds 120; reference:url,doc.emergingthreats.net/2002992; classtype:misc-activity; sid:2002992; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 995 (msg:"发现快速POP3S连接-可能的暴力攻击"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 30, seconds 120; reference:url,doc.emergingthreats.net/2002993; classtype:misc-activity; sid:2002993; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:"发现快速IMAP连接-可能的暴力攻击"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 30, seconds 60; reference:url,doc.emergingthreats.net/2002994; classtype:misc-activity; sid:2002994; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 993 (msg:"发现快速IMAPS连接-可能的暴力攻击"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 30, seconds 60; reference:url,doc.emergingthreats.net/2002995; classtype:misc-activity; sid:2002995; metadata:alarm_type 恶意扫描;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 22 (msg:"发现潜在的SSH扫描输出"; flow:to_server; flags:S,12; threshold: type threshold, track by_src, count 5, seconds 120; reference:url,en.wikipedia.org/wiki/Brute_force_attack; reference:url,doc.emergingthreats.net/2003068; classtype:attempted-recon; sid:2003068; metadata:alarm_type 恶意扫描;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"发现可能的WordPress xmlrpc.php BruteForce正在进行中-响应"; flow:established,from_server; flowbits:isset,ET.XMLRPC.PHP; file_data; content:"<name>faultCode</name>"; content:"<int>403</int>"; content:"<string>Incorrect username or password.</string>"; threshold:type both, track by_src, count 5, seconds 120; reference:url,isc.sans.edu/diary/+WordPress+brute+force+attack+via+wp.getUsersBlogs/18427; classtype:attempted-admin; sid:2018755; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3306 (msg:"发现MySQL恶意扫描"; flow:to_server; content:"|00 03|"; offset:3; depth:2; content:"select unhex("; fast_pattern; distance:0; content:"into dumpfile|20 27|"; distance:0; metadata: former_category CURRENT_EVENTS; reference:url,isc.sans.edu/diary/Quick+Analysis+of+a+Recent+MySQL+Exploit/20781; classtype:bad-unknown; sid:2022581; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"发现可能的SSL暴力攻击或网站抓取"; flow: established,to_server; flags: S; threshold: type threshold, track by_src, count 100, seconds 60; reference:url,doc.emergingthreats.net/2001553; classtype:attempted-dos; sid:2001553; metadata:alarm_type 恶意扫描;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET 23 (msg:"发现行为异常快速的入站Telnet连接，潜在扫描或暴力破解"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 30, seconds 60; reference:url,www.rapid7.com/nexpose-faq-answer2.htm; reference:url,doc.emergingthreats.net/2001904; classtype:misc-activity; sid:2001904; metadata:alarm_type 恶意扫描;)
#alert tcp $HOME_NET any -> $EXTERNAL_NET 3127 (msg:"发现行为异常端口3127流量，潜在扫描或后门"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 10 , seconds 60; reference:url,doc.emergingthreats.net/2002973; classtype:misc-activity; sid:2002973; metadata:alarm_type 恶意扫描;)
#alert tcp $HOME_NET any -> $EXTERNAL_NET 23 (msg:"发现行为异常快速的出站Telnet连接，潜在扫描或暴力破解"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 30, seconds 60; reference:url,www.rapid7.com/nexpose-faq-answer2.htm; reference:url,doc.emergingthreats.net/2008230; classtype:misc-activity; sid:2008230; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 6379 (msg:"发现Redis SSH密钥覆盖探测"; flow:to_server,established; content:"*"; depth:1; content:"config"; content:"set"; distance:0; content:"dir"; distance:0; content:"/.ssh"; distance:0; isdataat:!5,relative; reference:url,antirez.com/news/96; classtype:misc-attack; sid:2023510; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET !3389 (msg:"非标准端口上的扫描MS终端服务器流量"; flow:to_server,established; content:"|03 00 00|"; depth:3; content:"|e0 00 00 00 00 00|"; offset:5; depth:6; content:"Cookie|3a| mstshash="; fast_pattern; classtype:attempted-recon; sid:2023753; metadata:alarm_type 恶意扫描;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现ICMP Delphi可能要扫描的前体"; itype:8; icode:0; content:"Pinging from Delphi code written"; metadata: former_category SCAN; reference:url,www.koders.com/delphi/fid942A4EAF946B244BD3CD9BC83FEAAC35BA1F38AB.aspx; reference:url,doc.emergingthreats.net/2010681; classtype:misc-activity; sid:2010681; metadata:alarm_type 恶意扫描;)
alert tcp $HOME_NET 3306 -> $EXTERNAL_NET any (msg:"发现多个MySQL登录失败可能是暴力尝试"; flow:from_server,established; dsize:<251; byte_test:1,<,0xfb,0,little; content:"|ff 15 04 23 32 38 30 30 30|"; offset:4; threshold: type threshold, track by_src, count 5, seconds 120; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2010494; classtype:attempted-recon; sid:2010494; metadata:alarm_type 暴力破解;)
alert tcp $HOME_NET any -> any 445 (msg:"发现行为异常端口445流量潜在扫描或感染"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 70 , seconds 60; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2001569; classtype:misc-activity; sid:2001569; metadata:alarm_type 恶意扫描;)
alert tcp $HOME_NET any -> any 139 (msg:"发现行为异常端口139流量潜在扫描或感染"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 70 , seconds 60; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2001579; classtype:misc-activity; sid:2001579; metadata:alarm_type 恶意扫描;)
alert tcp $HOME_NET any -> any 137 (msg:"发现行为异常端口137流量潜在扫描或感染"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 70 , seconds 60; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2001580; classtype:misc-activity; sid:2001580; metadata:alarm_type 恶意扫描;)
alert tcp $HOME_NET any -> any 135 (msg:"发现行为异常端口135流量潜在扫描或感染"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 70 , seconds 60; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2001581; classtype:misc-activity; sid:2001581; metadata:alarm_type 恶意扫描;)
alert tcp $HOME_NET any -> any 1434 (msg:"发现行为异常端口1434流量潜在扫描或感染"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 40 , seconds 60; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2001582; classtype:misc-activity; sid:2001582; metadata:alarm_type 恶意扫描;)
alert tcp $HOME_NET any -> any 1433 (msg:"发现行为异常端口1433流量潜在扫描或感染"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 40 , seconds 60; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2001583; classtype:misc-activity; sid:2001583; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"发现行为异常快速的终端服务器流量潜在扫描或感染（入站）"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 20, seconds 360; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2001972; classtype:network-scan; sid:2001972; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现可能包含SQL注入的可疑用户代理"; flow:established,to_server; content:"SQL"; nocase; depth:200; http_user_agent; content:"Inject"; nocase; distance:0; http_user_agent; metadata: former_category HUNTING; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,doc.emergingthreats.net/2010087; classtype:attempted-recon; sid:2010087; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现可能包含Web扫描程序可疑用户代理"; flow:established,to_server; content:"web"; nocase; depth:200; http_user_agent; content:"scan"; nocase; distance:0; http_user_agent; metadata: former_category HUNTING; reference:url,doc.emergingthreats.net/2010088; classtype:attempted-recon; sid:2010088; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现包含安全扫描的可疑用户代理，可能进行扫描"; flow:established,to_server; content:"security"; nocase; http_user_agent; content:"scan"; nocase; distance:0; http_user_agent; metadata: former_category HUNTING; reference:url,doc.emergingthreats.net/2010089; classtype:attempted-recon; sid:2010089; metadata:alarm_type 恶意扫描;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现ICMP @hello请求可能要扫描的前体"; itype:8; icode:0; content:"@hello ???"; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2010641; classtype:misc-activity; sid:2010641; metadata:alarm_type 恶意扫描;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3389 (msg:"发现行为异常快速的终端服务器流量潜在扫描或感染（出站）"; flow:to_server; flags: S,12; threshold: type both, track by_src, count 20, seconds 360; metadata: former_category SCAN; reference:url,threatpost.com/en_us/blogs/new-worm-morto-using-rdp-infect-windows-pcs-082811; classtype:misc-activity; sid:2013479; metadata:alarm_type 恶意扫描;)
alert http $HOME_NET any -> any any (msg:"发现可能的Nmap用户代理已观察到"; flow:to_server,established; content:"|20|Nmap"; http_user_agent; fast_pattern; metadata: former_category SCAN; classtype:web-application-attack; sid:2024364; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现struts-pwn用户代理"; flow:established,to_server; content:"struts-pwn"; depth:10; http_user_agent; fast_pattern;metadata:affected_product Apache_Struts2, attack_target Web_Server, deployment Perimeter, signature_severity Critical; metadata: former_category SCAN; reference:url,github.com/mazen160/struts-pwn_CVE-2017-9805/blob/master/struts-pwn.py; reference:cve,2017-9805; reference:url,paladion.net/paladion-cyber-labs-discovers-a-new-ransomware/; classtype:attempted-user; sid:2024843; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现OpenVAS用户代理入站"; flow:established,to_server; content:"OpenVAS"; http_user_agent; reference:url,openvas.org; classtype:attempted-recon; sid:2012726; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现DirBuster Web App扫描"; flow:to_server,established; content:"DirBuster"; depth:9; http_user_agent; reference:url,owasp.org; reference:url,doc.emergingthreats.net/2008186; classtype:web-application-attack; sid:2008186; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Sqlmap SQL注入扫描"; flow:to_server,established; content:"sqlmap"; depth:6; http_user_agent; threshold: type limit, count 2, seconds 40, track by_src; reference:url,sqlmap.sourceforge.net; reference:url,doc.emergingthreats.net/2008538; classtype:attempted-recon; sid:2008538; metadata:alarm_type 恶意扫描;)
alert ssh $EXTERNAL_NET any -> $HOME_NET any (msg:"发现带有伪PUTTY版本的SSH BruteForce工具"; flow:established,to_server; ssh_proto; content:"PUTTY"; threshold: type limit, track by_src, count 1, seconds 30; metadata: former_category SCAN; classtype:network-scan; sid:2019876; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5432 (msg:"发现可疑入站到PostgreSQL端口5432"; flow:to_server; flags:S; threshold: type limit, count 5, seconds 60, track by_src; metadata: former_category HUNTING; reference:url,doc.emergingthreats.net/2010939; classtype:bad-unknown; sid:2010939; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 4333 (msg:"发现可疑入站到mSQL端口4333"; flow:to_server; flags:S; threshold: type limit, count 5, seconds 60, track by_src; metadata: former_category HUNTING; reference:url,doc.emergingthreats.net/2010938; classtype:bad-unknown; sid:2010938; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3306 (msg:"发现可疑入站到mySQL端口3306"; flow:to_server; flags:S; threshold: type limit, count 5, seconds 60, track by_src; metadata: former_category HUNTING; reference:url,doc.emergingthreats.net/2010937; classtype:bad-unknown; sid:2010937; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1521 (msg:"发现到Oracle SQL端口1521的可疑入站"; flow:to_server; flags:S; threshold: type limit, count 5, seconds 60, track by_src; metadata: former_category HUNTING; reference:url,doc.emergingthreats.net/2010936; classtype:bad-unknown; sid:2010936; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1433 (msg:"发现可疑入站到MSSQL端口1433"; flow:to_server; flags:S; threshold: type limit, count 5, seconds 60, track by_src; metadata: former_category HUNTING; reference:url,doc.emergingthreats.net/2010935; classtype:bad-unknown; sid:2010935; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现纽约大学互联网普查UA入站"; content:"NYU Internet Census"; http_user_agent; depth:19; metadata: former_category SCAN; reference:url,scan.lol; classtype:network-scan; sid:2025461; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现PHP攻击工具Morfeus F扫描"; flow:established,to_server; content:"Morfeus"; nocase; http_user_agent; depth:7; metadata: former_category WEB_SERVER; reference:url,www.webmasterworld.com/search_engine_spiders/3227720.htm; reference:url,doc.emergingthreats.net/2003466; classtype:web-application-attack; sid:2003466; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现通过会话ID猜测进行ntop-ng身份验证绕过"; flow:established,to_server; content:"/lua/network_load.lua"; http_uri; fast_pattern; content:"session="; http_cookie; content:"user="; http_cookie; threshold: type threshold, track by_dst, count 255, seconds 10; metadata: former_category SCAN; reference:cve,2018-12520; reference:url,exploit-db.com/exploits/44973/; classtype:attempted-recon; sid:2025780; metadata:alarm_type 恶意扫描;)
alert udp any any -> $HOME_NET 4070 (msg:"发现HID VertX和Edge门禁控制器发现"; dsize:<45; content:"discover|3b|013|3b|"; metadata: former_category SCAN; reference:url,exploit-db.com/exploits/44992/; classtype:attempted-recon; sid:2025822; metadata:alarm_type 恶意扫描;)
alert http any any -> $HOME_NET any (msg:"发现Geutebrueck报告员7.8.974.20信息披露"; flow:established,to_server; content:"GET"; http_method; content:"/statistics/gscsetup.xml"; http_uri; metadata: former_category SCAN; reference:cve,2018-15534; reference:url,exploit-db.com/exploits/45240/; classtype:attempted-recon; sid:2026008; metadata:alarm_type 恶意扫描;)
alert http any any -> $HOME_NET any (msg:"发现海康威视IP摄像机5.4.0信息泄露"; flow:established,to_server; content:"GET"; http_method; content:"/System/configurationFile?auth=YWRtaW46MTEK"; http_uri; metadata: former_category SCAN; reference:url,exploit-db.com/exploits/45231/; classtype:attempted-recon; sid:2026015; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现您好Peppa！扫描活动"; flow:established,to_server; content:"POST"; http_method; content:".php"; http_uri; content:"=die(|27|Hello, Peppa!|27|"; http_client_body; fast_pattern; metadata: former_category SCAN; reference:url,isc.sans.edu/diary/rss/23860; classtype:attempted-recon; sid:2026464; metadata:alarm_type 恶意扫描;)
alert smtp $EXTERNAL_NET any -> $HOME_NET any (msg:"发现StarDotStar HELO，怀疑是AUTH LOGIN僵尸网络"; flow:established,to_server; content:"HELO|20 2a 2e 2a 0d 0a|"; depth:11; metadata: former_category CURRENT_EVENTS; classtype:bad-unknown; sid:2026463; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"正在进行SCAN DirBuster扫描"; flow:established,to_server; content:"/thereIsNoWayThat-You-CanBeThere"; nocase; http_uri; threshold: type limit, track by_src,count 1, seconds 60; reference:url,www.owasp.org/index.php/Category%3aOWASP_DirBuster_Project; classtype:attempted-recon; sid:2011914; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Metasploit WMAP GET len 0并输入"; flow:established,to_server; content:"GET"; http_method; content:"|0d 0a|Content-Type|3A| text/plain|0d 0a|Content-Length|3A| 0|0d 0a|"; http_header; threshold: type limit, track by_src,count 1,seconds 60; classtype:attempted-recon; sid:2011974; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"来自未知扫描工具的Goatzapszu标头"; flow:established,to_server; content:"Goatzapszu|3a|"; nocase; http_header; classtype:attempted-recon; sid:2012077; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现 nessus 1.X 404探针"; flow:to_server,established; content:"/nessus_is_probing_you_"; http_uri; reference:arachnids,301; classtype:web-application-attack; sid:2101102; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现美杜莎用户代理"; flow: established,to_server; content:"User-Agent|3A| Teh Forest Lobster"; fast_pattern:10,20; nocase; http_header; threshold: type limit, track by_src,count 1, seconds 60; reference:url,www.foofus.net/~jmk/medusa/medusa.html; classtype:attempted-recon; sid:2011887; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现DotDotPwn用户代理"; flow:established,to_server; content:"User-Agent|3A| DotDotPwn"; nocase; http_header; threshold:type limit, track by_src,count 1, seconds 60; reference:url,dotdotpwn.sectester.net; classtype:attempted-recon; sid:2011915; metadata:alarm_type 恶意扫描;)
alert tcp $HOME_NET any -> $HOME_NET 2555 (msg:"发现内部到内部UPnP请求tcp端口2555"; flow:established,to_server; content:"GET "; depth:4; content:"/upnp/"; nocase; pcre:"/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{16}\//Ri"; reference:url,www.upnp-hacks.org/upnp.html; reference:url,doc.emergingthreats.net/2008092; classtype:attempted-recon; sid:2008092; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 2555 (msg:"发现到内部UPnP请求外部TCP端口2555"; flow:established,to_server; content:"GET "; depth:4; content:"/upnp/"; nocase; pcre:"/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{16}\//Ri"; reference:url,www.upnp-hacks.org/upnp.html; reference:url,doc.emergingthreats.net/2008093; classtype:attempted-recon; sid:2008093; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"带命令的DEBUG方法请求"; flow:established,to_server; content:"DEBUG "; depth:6; content:"|0d 0a|Command|3a| "; distance:0; reference:url,doc.emergingthreats.net/2008312; classtype:attempted-recon; sid:2008312; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现可能检测到快速跟踪工具Spidering User-Agent"; flow:established,to_server; content:"|0d 0a|User-Agent|3A| pymills-spider/"; reference:url,www.offensive-security.com/metasploit-unleashed/Fast-Track-Modes; reference:url,doc.emergingthreats.net/2011721; classtype:attempted-recon; sid:2011721; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SQLBrute SQL扫描"; flow:to_server,established; content:"AND not exists (select * from master..sysdatabases)"; offset:60; depth:60; reference:url,www.justinclarke.com/archives/2006/03/sqlbrute.html; reference:url,www.darknet.org.uk/2007/06/sqlbrute-sql-injection-brute-force-tool/; reference:url,doc.emergingthreats.net/2009477; classtype:attempted-recon; sid:2009477; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现SQLNinja MSSQL用户扫描"; content:"?param=a"; flow:to_server,established; content:"if%20ascii%28substring%28%28select%20system%5Fuser"; distance:2; threshold: type threshold, track by_src, count 20, seconds 10; reference:url,sqlninja.sourceforge.net/index.html; reference:url,doc.emergingthreats.net/2009040; classtype:attempted-recon; sid:2009040; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现 SQLNinja MSSQL数据库用户权限扫描"; flow:to_server,established; content:"?param=a"; content:"if%20is%5Fsrvrolemember%28%27sysadmin"; distance:2; reference:url,sqlninja.sourceforge.net/index.html; reference:url,doc.emergingthreats.net/2009041; classtype:attempted-recon; sid:2009041; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现SQLNinja MSSQL身份验证模式扫描"; flow:to_server,established; content:"?param=a"; content:"if%20not%28%28select%20serverproperty%28%27IsIntegratedSecurityOnly"; distance:2; reference:url,sqlninja.sourceforge.net/index.html; reference:url,doc.emergingthreats.net/2009042; classtype:attempted-recon; sid:2009042; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现SQLNinja尝试使用sp_configure重新创建xp_cmdshell"; flow:to_server,established; content:"?param=a"; content:"exec%20master%2E%2Esp%5Fconfigure%20%27show%20advanced%20options"; distance:2; reference:url,sqlninja.sourceforge.net/index.html; reference:url,doc.emergingthreats.net/2009043; classtype:attempted-admin; sid:2009043; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现SQLNinja尝试创建xp_cmdshell会话"; flow:to_server,established; content:"?param=a"; content:"exec%20master%2E%2Exp%5Fcmdshell%20%27cmd%20%2FC%20%25TEMP"; distance:2; reference:url,sqlninja.sourceforge.net/index.html; reference:url,doc.emergingthreats.net/2009044; classtype:attempted-admin; sid:2009044; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Stompy Web应用程序会话扫描"; flow:to_server,established; content:"Session Stomper"; offset:100; depth:25; reference:url,www.darknet.org.uk/2007/03/stompy-the-web-application-session-analyzer-tool/; reference:url,doc.emergingthreats.net/2008605; classtype:attempted-recon; sid:2008605; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现 w3af进行中的阿根廷要求方法"; flow:to_server,established; content:"ARGENTINA "; depth:10; reference:url,w3af.sourceforge.net; reference:url,doc.emergingthreats.net/2011027; classtype:attempted-recon; sid:2011027; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现WhatWeb Web应用程序指纹扫描仪已检测到默认用户代理"; flow:established,to_server; content:"|0d 0a|User-Agent|3A| WhatWeb/"; reference:url,www.morningstarsecurity.com/research/whatweb; reference:url,doc.emergingthreats.net/2010960; classtype:attempted-recon; sid:2010960; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Wapiti Web服务器漏洞扫描"; flow:to_server,established; content:"GET /"; depth:5; content:"?http|3A|//www.google."; within:100; nocase; content:"|0d 0a|User-Agent|3A 20|Python-httplib2"; distance:0; reference:url,wapiti.sourceforge.net/; reference:url,doc.emergingthreats.net/2008417; classtype:attempted-recon; sid:2008417; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到Inspathx路径披露扫描程序用户代理"; flow:established,to_server; content:"User-Agent|3A| inspath [path disclosure finder"; http_header; threshold:type limit, count 1, seconds 30, track by_src; reference:url,code.google.com/p/inspathx/; reference:url,www.darknet.org.uk/2010/09/inspathx-tool-for-finding-path-disclosure-vulnerabilities/; classtype:attempted-recon; sid:2011808; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Inspathx路径披露扫描"; flow:established,to_server; content:"GET"; http_method; content:"varhttp|3A|/"; http_uri; nocase; content:"wwwhttp|3A|/"; http_uri; nocase; content:"htmlhttp|3A|/"; http_uri; nocase; threshold:type limit, count 1, seconds 30, track by_src; reference:url,code.google.com/p/inspathx/; reference:url,www.darknet.org.uk/2010/09/inspathx-tool-for-finding-path-disclosure-vulnerabilities/; classtype:attempted-recon; sid:2011809; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现WebHack控制中心用户代理入站（WHCC /）"; flow:to_server,established; content:"User-Agent|3a| "; nocase; content:"WHCC"; fast_pattern; nocase; distance:0; within:50; pcre:"/User-Agent\:[^\n]+WHCC/i"; reference:url,www.governmentsecurity.org/forum/index.php?showtopic=5112&pid=28561&mode=threaded&start=; reference:url,doc.emergingthreats.net/2003924; classtype:trojan-activity; sid:2003924; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Netsparker默认用户代理"; flow:to_server,established; content:" Netsparker)"; http_user_agent; threshold:type limit,track by_src,count 1,seconds 60; reference:url,www.mavitunasecurity.com/communityedition/; classtype:attempted-recon; sid:2011029; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到Skipfish Web应用程序扫描"; flow:established,to_server; content:"Mozilla/5.0 SF"; http_user_agent; threshold:type limit, count 10, seconds 60, track by_src; reference:url,isc.sans.org/diary.html?storyid=8467; reference:url,code.google.com/p/skipfish/; reference:url,doc.emergingthreats.net/2010953; classtype:attempted-recon; sid:2010953; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现bsqlbf暴力SQL注入"; flow:established,to_server; content:"bsqlbf"; http_user_agent; nocase; reference:url,code.google.com/p/bsqlbf-v2/; reference:url,doc.emergingthreats.net/2008362; classtype:web-application-activity; sid:2008362; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现SQLNinja MSSQL XPCmdShell扫描"; flow:to_server,established; content:"?param=a"; content:"exec%20master%2E%2Exp%5Fcmdshell"; distance:2; reference:url,sqlninja.sourceforge.net/index.html; classtype:attempted-recon; sid:2009039; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SCAN WebShag Web应用程序扫描"; flow:to_server,established; content:"webshag"; http_user_agent; reference:url,www.scrt.ch/pages_en/outils.html; classtype:attempted-recon; sid:2009158; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"标头中存在HZZP扫描"; flow:to_server,established; content:"GET"; http_method; content:"C|3a|/WINDOWS/system32/calc.exe"; http_header; content:"|0d 0a|"; within:9; http_header; pcre:"/^.+\x3a\s(test.)?C\:\/WINDOWS\/system32\/calc\.exe(.test)?\r$/Hm"; reference:url,www.krakowlabs.com/dev.html; reference:url,doc.emergingthreats.net/2011028; classtype:attempted-recon; sid:2011028; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现到邮件的ProxyReconBot CONNECT方法"; flow:established,to_server; content:"CONNECT "; depth:8; content:"|3A|25 HTTP/"; within:200; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2003869; classtype:misc-attack; sid:2003869; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SCAN Acunetix版本6抓取/扫描"; flow:to_server,established; content:"/acunetix-wvs-test-for-some-inexistent-file"; http_uri; threshold: type threshold, track by_dst, count 2, seconds 5; reference:url,www.acunetix.com/; reference:url,doc.emergingthreats.net/2008571; classtype:attempted-recon; sid:2008571; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"正在进行SCAN Netsparker扫描"; flow:to_server,established; content:"/Netsparker-"; http_uri; threshold:type limit,track by_src,count 1,seconds 60; reference:url,www.mavitunasecurity.com/communityedition/; reference:url,doc.emergingthreats.net/2011030; classtype:attempted-recon; sid:2011030; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Httprecon Web服务器指纹扫描"; flow:to_server,established; content:"GET"; http_method; content:"/etc/passwd?format="; http_uri; content:"><script>alert('xss')"; http_uri; content:"traversal="; http_uri; reference:url,www.computec.ch/projekte/httprecon/; reference:url,doc.emergingthreats.net/2008627; classtype:attempted-recon; sid:2008627; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Wikto扫描"; flow:to_server,established; content:"GET"; http_method; content:"/.adSensePostNotThereNoNobook"; http_uri; reference:url,www.sensepost.com/research/wikto/WiktoDoc1-51.htm; reference:url,doc.emergingthreats.net/2008617; classtype:attempted-recon; sid:2008617; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Wikto后端数据挖掘器扫描"; flow:to_server,established; content:"GET"; http_method; content:"/actSensePostNotThereNoNotive"; http_uri; reference:url,www.sensepost.com/research/wikto/WiktoDoc1-51.htm; reference:url,doc.emergingthreats.net/2008629; classtype:attempted-recon; sid:2008629; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SCAN Asp-Audit Web扫描"; flow:to_server,established; content:"GET"; http_method; content:"STYLE=x|3a|e/**/xpression(alert('asp-audit'))>"; http_uri; reference:url,www.hacker-soft.net/Soft/Soft_2895.htm; reference:url,wiki.remote-exploit.org/backtrack/wiki/asp-audit; reference:url,doc.emergingthreats.net/2009479; classtype:attempted-recon; sid:2009479; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 HP Enterprise VAN SDN控制器"; flow:established,to_server; content:"/sdn/ui/app/rs/hpws/config"; http_uri; endswith; content:"X-Auth-Token|3a| AuroraSdnToken"; http_header; fast_pattern; metadata: former_category SCAN; reference:url,exploit-db.com/exploits/44951/; classtype:attempted-recon; sid:2025760; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现WSFuzzer Web应用程序模糊"; flow:to_server,established; content:"/ServiceDefinition"; http_uri; fast_pattern; content:"Python-urllib/"; depth:14; http_user_agent; reference:url,www.owasp.org/index.php/Category%3aOWASP_WSFuzzer_Project; reference:url,doc.emergingthreats.net/2008628; classtype:attempted-recon; sid:2008628; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Positive Technologies XSpider安全扫描仪用户代理（PTX）"; flow:to_server,established; content:"PTX|0d 0a|"; http_header; fast_pattern; pcre:"/^User-Agent\x3a[^\n]+PTX\r$/Hm"; reference:url,www.securitylab.ru/forum/forum16/topic26800/; classtype:attempted-recon; sid:2013779; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现w3af用户代理"; flow:established,to_server; content:"w3af.sf.net"; http_header; fast_pattern; pcre:"/^User-Agent\x3a[^\r\n]+?w3af\.sf\.net/Hmi"; classtype:attempted-recon; sid:2015484; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET [137,138,139,445] (msg:"发现Nessus Netbios扫描"; content:"n|00|e|00|s|00|s|00|u|00|s"; fast_pattern; reference:url,www.tenable.com/products/nessus/nessus-product-overview; classtype:attempted-recon; sid:2015754; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"通过sftp-config.json扫描SFTP / FTP密码"; flow:to_server,established; content:"/sftp-config.json"; fast_pattern; http_uri; reference:url,blog.sucuri.net/2012/11/psa-sftpftp-password-exposure-via-sftp-config-json.html; classtype:attempted-recon; sid:2015940; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现SipCLI VOIP扫描-TCP"; flow:established,to_server; content:"|0D 0A|User-Agent|3A 20|sipcli/"; fast_pattern; threshold: type limit, count 1, seconds 60, track by_src; reference:url,www.yasinkaplan.com/SipCli/; classtype:attempted-recon; sid:2017161; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5060 (msg:"发现SipCLI VOIP扫描"; content:"|0D 0A|User-Agent|3A 20|sipcli/"; fast_pattern; threshold: type limit, count 1, seconds 60, track by_src; reference:url,www.yasinkaplan.com/SipCli/; classtype:attempted-recon; sid:2017162; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现FOCA uri"; flow:established,to_server; content:"GET"; http_method; content:"/*F0C4~1*/foca.aspx?aspxerrorpath=/"; http_uri; fast_pattern; content:!"Referer|3a 20|"; http_header; content:!"Accept|3a 20|"; http_header; content:!"Connection|3a 20|"; http_header; reference:url,blog.bannasties.com/2013/08/vulnerability-scans/; classtype:attempted-recon; sid:2017950; metadata:alarm_type 恶意扫描;)
alert udp $EXTERNAL_NET 10000: -> $HOME_NET 10000: (msg:"发现NMAP OS检测探针"; dsize:300; content:"CCCCCCCCCCCCCCCCCCCC"; fast_pattern; content:"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"; depth:255; content:"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"; within:45; classtype:attempted-recon; sid:2018489; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现可能的WordPress xmlrpc.php wp.getUsersBlogs Flowbit Set"; flow:established,to_server; content:"/xmlrpc.php"; http_uri; nocase; fast_pattern; flowbits:set,ET.XMLRPC.PHP; flowbits:noalert; reference:url,isc.sans.edu/diary/+WordPress+brute+force+attack+via+wp.getUsersBlogs/18427; classtype:attempted-admin; sid:2018754; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SCAN Grendel-Scan Web应用程序安全扫描"; flow:to_server,established; content:"GET"; http_method; content:"/random"; nocase; http_uri; fast_pattern; pcre:"/\x2Frandom\w+?\x2E(?:c(?:f[cm]|gi)|ht(?:ml?|r)|(?:ws|x)dl|a(?:sp|xd)|p(?:hp3|l)|bat|swf|vbs|do)/Ui"; threshold: type threshold, track by_dst, count 20, seconds 40; reference:url,www.grendel-scan.com; reference:url,doc.emergingthreats.net/2009481; classtype:attempted-recon; sid:2009481; metadata:alarm_type 恶意扫描;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"发现 Xenu Link侦查扫描仪出站"; flow:to_server,established; content:"GET"; http_method; content:"Xenu Link Sleuth"; http_user_agent; fast_pattern; classtype:attempted-recon; sid:2021058; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 COMMIX命令注入扫描尝试"; flow:to_server,established; content:"|55 73 65 72 2d 41 67 65 6e 74 3a 20 63 6f 6d 6d 69 78|"; fast_pattern; http_header; threshold: type limit, count 1, seconds 60, track by_src; reference:url,github.com/stasinopoulos/commix/blob/master/README.md; classtype:web-application-activity; sid:2022243; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3306 (msg:"发现MySQL恶意扫描"; flow:to_server; content:"|00 03|"; offset:3; depth:2; content:"GRANT ALTER, ALTER ROUTINE"; distance:0; nocase; within:30; content:"TO root@% WITH"; fast_pattern; metadata: former_category CURRENT_EVENTS; reference:url,isc.sans.edu/diary/Quick+Analysis+of+a+Recent+MySQL+Exploit/20781; classtype:bad-unknown; sid:2022579; metadata:alarm_type 恶意扫描;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3306 (msg:"发现MySQL恶意扫描"; flow:to_server; content:"|00 03|"; offset:3; depth:2; content:"set global log_bin_trust_function_creators=1"; fast_pattern; metadata: former_category CURRENT_EVENTS; reference:url,isc.sans.edu/diary/Quick+Analysis+of+a+Recent+MySQL+Exploit/20781; classtype:bad-unknown; sid:2022580; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 Acunetix扫描正在进行中，http_uri中的acunetix_wvs_security_test"; flow:established,to_server; content:"acunetix_wvs_security_test"; http_uri; fast_pattern; threshold: type limit, count 1, seconds 60, track by_src; reference:url,www.acunetix.com/; classtype:web-application-attack; sid:2023687; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 Acunetix正在扫描http_uri中的acunetix变量"; flow:established,to_server; content:"|24|acunetix"; http_uri; fast_pattern; threshold: type limit, count 1, seconds 60, track by_src; reference:url,www.acunetix.com/; classtype:web-application-attack; sid:2023688; metadata:alarm_type 恶意扫描;)
alert http any any -> $HTTP_SERVERS any (msg:"正在进行SCAN DominoHunter安全扫描"; flow:established,to_server; content:"DominoHunter"; nocase; http_user_agent; depth:12; reference:url,packetstormsecurity.org/files/31653/DominoHunter-0.92.zip.html; classtype:web-application-attack; sid:2013171; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SCAN Toata扫描仪用户代理"; flow:to_server,established; content:"Toata dragostea "; http_user_agent; depth:16; threshold: type limit, count 1, seconds 60, track by_src; reference:url,isc.sans.org/diary.html?storyid=5599; reference:url,doc.emergingthreats.net/2009159; classtype:attempted-recon; sid:2009159; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现自动注入工具用户代理（AutoGetColumn）"; flow:established,to_server; content:"AutoGetColumn"; http_user_agent; depth:13; reference:url,doc.emergingthreats.net/2009154; classtype:attempted-recon; sid:2009154; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Grendel Web扫描-检测到默认用户代理"; flow:to_server,established; content:"Mozilla/5.0 (compatible|3b 20|Grendel-Scan"; nocase; http_user_agent; depth:37; fast_pattern; content:"http|3a|//www.grendel-scan.com"; http_header; nocase; threshold: type limit, track by_dst, count 1, seconds 60; reference:url,www.grendel-scan.com; reference:url,doc.emergingthreats.net/2009480; classtype:attempted-recon; sid:2009480; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现JCE Joomla扫描仪"; flow:established,to_server; content:"BOT/0.1 (BOT for JCE)"; http_user_agent; depth:21; classtype:web-application-attack; sid:2016032; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Tomcat Web应用程序管理器扫描"; flow:established,to_server; content:"GET"; http_method; content:"/manager/html"; nocase; fast_pattern; http_uri; content:"Mozilla/3.0 (compatible|3b 20|Indy Library)"; http_user_agent; depth:38; isdataat:!1,relative; content:"Authorization|3a 20|Basic"; http_header; content:!"Proxy-Authorization|3a 20|Basic"; nocase; http_header; reference:url,doc.emergingthreats.net/2010019; classtype:attempted-recon; sid:2010019; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现可疑用户代理-最小获取-可能的漏洞扫描"; flow:established,to_server; content:"get-minimal"; http_user_agent; depth:11; metadata: former_category HUNTING; reference:url,doc.emergingthreats.net/2003634; classtype:attempted-admin; sid:2003634; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现w3af用户代理"; flow: established,to_server; content:"w3af.sourceforge.net"; http_user_agent; depth:20; reference:url,w3af.sourceforge.net; reference:url,doc.emergingthreats.net/2007757; classtype:attempted-recon; sid:2007757; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现DavTest WebDav漏洞扫描程序检测到默认用户代理"; flow:established,to_server; content:"DAV.pm/v"; depth:8; http_user_agent; reference:url,www.darknet.org.uk/2010/04/davtest-webdav-vulerability-scanning-scanner-tool/; reference:url,code.google.com/p/davtest/; reference:url,doc.emergingthreats.net/2011089; classtype:attempted-recon; sid:2011089; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SCAN Grabber.py Web扫描"; flow:to_server,established; content:"Grabber"; depth:7; http_user_agent; reference:url,rgaucher.info/beta/grabber/; reference:url,doc.emergingthreats.net/2009483; classtype:attempted-recon; sid:2009483; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Mini MySqlatOr SQL注入扫描"; flow:to_server,established; content:"prog.CustomCrawler"; depth:18; http_user_agent; reference:url,www.scrt.ch/pages_en/minimysqlator.html; reference:url,doc.emergingthreats.net/2008729; classtype:attempted-recon; sid:2008729; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SCAN SQL Power Injector SQL注入用户代理"; flow:to_server,established; content:"SQL Power Injector"; depth:18; http_user_agent; reference:url,www.sqlpowerinjector.com/index.htm; reference:url,en.wikipedia.org/wiki/Sql_injection; reference:url,doc.emergingthreats.net/2009769; classtype:attempted-recon; sid:2009769; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现 Open-Proxy ScannerBot（webcollage-UA）"; flow:established,to_server; content:"webcollage/"; depth:11; nocase; http_user_agent; reference:url, stateofsecurity.com/?p=526; reference:url,www.botsvsbrowsers.com/details/214715/index.html; reference:url,doc.emergingthreats.net/2010768; classtype:bad-unknown; sid:2010768; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Hmap Web服务器指纹扫描"; flow:to_server,established; urilen:1; content:"GET"; http_method; content:"4.75 [en] (Windows NT 5.0"; http_user_agent; http_protocol; content:"HTTP/1.0"; reference:url,www.ujeni.murkyroc.com/hmap/; reference:url,doc.emergingthreats.net/2008537; classtype:attempted-recon; sid:2008537; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|DEMONS"; http_header; fast_pattern; pcre:"/^DEMONS(?:(?:\/|\s)[0-9]\.0)?$/Vi"; metadata: former_category MALWARE; classtype:attempted-admin; sid:2029015; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|Hakai"; http_header; fast_pattern; pcre:"/^Hakai(?:(?:\/|\s)[0-9]\.0)?$/Vi"; metadata: former_category MALWARE; classtype:attempted-admin; sid:2029016; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|Messiah"; http_header; fast_pattern; pcre:"/^Messiah(?:(?:\/|\s)[0-9]\.0)?$/Vi"; metadata: former_category MALWARE; classtype:attempted-admin; sid:2029017; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|Liquor"; http_header; fast_pattern; pcre:"/^Liquor(?:(?:\/|\s)[0-9]\.0)?$/Vi"; metadata: former_category MALWARE; classtype:attempted-admin; sid:2029018; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|B4ckdoor|0d 0a|"; http_header; metadata: former_category MALWARE; classtype:attempted-admin; sid:2029019; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|Nija"; http_header; fast_pattern; pcre:"/^Nija(?:(?:\/|\s)[0-9]\.0)?$/Vi"; metadata: former_category MALWARE; classtype:attempted-admin; sid:2029020; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|Gemini"; http_header; fast_pattern; pcre:"/^Gemini(?:(?:\/|\s)[0-9]\.0)?$/Vi"; metadata: former_category MALWARE; classtype:attempted-admin; sid:2029021; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|Kayla"; http_header; fast_pattern; pcre:"/^Kayla(?:(?:\/|\s)[0-9]\.0)?$/Vi"; metadata: former_category MALWARE; classtype:attempted-admin; sid:2029023; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|Sector"; http_header; fast_pattern; pcre:"/^Sector(?:(?:\/|\s)[0-9]\.0)?$/Vi"; metadata: former_category MALWARE; classtype:attempted-admin; sid:2029024; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|OSIRIS"; http_header; fast_pattern; pcre:"/^OSIRIS(?:(?:\/|\s)[0-9]\.0)?$/Vi"; metadata: former_category MALWARE; classtype:attempted-admin; sid:2029026; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Zmap用户代理（入站）"; flow:established,to_server; content:"Mozilla/5.0 zgrab/0.x"; http_user_agent; depth:21; isdataat:!1,relative; metadata: former_category SCAN; classtype:network-scan; sid:2029054; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 Watchfire AppScan Web App漏洞扫描程序"; flow:established,to_server; http.uri; content:"/appscan_fingerprint/mac_address"; nocase; reference:url,www.watchfire.com/products/appscan/default.aspx; reference:url,doc.emergingthreats.net/2008311; classtype:attempted-recon; sid:2008311; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现Dark Nexus IoT变体用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|dark_NeXus"; http_header; fast_pattern; classtype:attempted-admin; sid:2029208; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现番茄路由器默认凭据（admin：admin）"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"/admin-scripts.asp"; nocase; http.header; content:"Authorization|3a 20|Basic|20|YWRtaW46YWRtaW4="; fast_pattern; metadata: former_category SCAN; reference:url,unit42.paloaltonetworks.com/muhstik-botnet-attacks-tomato-routers-to-harvest-new-iot-devices/; classtype:attempted-admin; sid:2029317; metadata:alarm_type 弱口令;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 Tomato Router默认凭据（root：admin）"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"/admin-scripts.asp"; endswith; nocase; http.header; content:"Authorization|3a 20|Basic|20|cm9vdDphZG1pbg=="; fast_pattern; metadata: former_category SCAN; reference:url,unit42.paloaltonetworks.com/muhstik-botnet-attacks-tomato-routers-to-harvest-new-iot-devices/; classtype:attempted-admin; sid:2029318; metadata:alarm_type 弱口令;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Apache mod_proxy反向代理暴露"; flow:established,to_server; http_request_line; content:"GET @"; depth:5; reference:url,www.contextis.com/research/blog/reverseproxybypass/; reference:url,mail-archives.apache.org/mod_mbox/httpd-announce/201110.mbox/%3C20111005141541.GA7696@redhat.com%3E; classtype:attempted-recon; sid:2013791; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"从外部来源扫描Tomcat上传"; flow:to_server,established; flowbits:isset,ET.Tomcat.login.attempt; content:"POST"; http_method; content:"/manager/html/upload"; http_uri; nocase; reference:url,tomcat.apache.org; reference:url,doc.emergingthreats.net/2009220; classtype:successful-admin; sid:2009220; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|Hello, World"; http_header; nocase; fast_pattern; pcre:"/^Hello, World(?:(?:\/|\s)[0-9]\.0)?$/Vi"; metadata: former_category SCAN; classtype:attempted-admin; sid:2029022; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"观察到SCAN ELF / Mirai用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|Ankit|0d 0a|"; nocase; fast_pattern; metadata: former_category SCAN; classtype:attempted-admin; sid:2029473; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Tomcat admin-admin登录凭据"; flow:to_server,established; content:"/manager/html"; nocase; http_uri; content:"|0d 0a|Authorization|3a 20|Basic|20|YWRtaW46YWRtaW4=|0d 0a|"; fast_pattern; http_header; flowbits:set,ET.Tomcat.login.attempt; reference:url,tomcat.apache.org; reference:url,doc.emergingthreats.net/2009217; classtype:attempted-admin; sid:2009217; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现abdullkarem Wordpress PHP扫描"; flow:established,to_server; content:"GET"; http_method; content:".php?"; nocase; http_uri; content:"&php"; nocase; http_uri; distance:0; content:"&wphp"; nocase; http_uri; distance:0; content:"&abdullkarem="; nocase; http_uri; fast_pattern; distance:0; http_protocol; content:"HTTP/1.0"; depth:8; isdataat:!1,relative; http_header_names; content:"|0d 0a|Host|0d 0a|"; depth:8; classtype:web-application-attack; sid:2021949; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 Polaris僵尸网络用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|polaris botnet"; fast_pattern; classtype:attempted-admin; sid:2029577; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Apache mod_proxy反向代理暴露"; flow:established,to_server; content:"|3a|@"; http_uri; http_request_line; content:"GET|20 3a|@"; depth:6; reference:url,www.contextis.com/research/blog/reverseproxybypass/; reference:url,mail-archives.apache.org/mod_mbox/httpd-announce/201110.mbox/%3C20111005141541.GA7696@redhat.com%3E; classtype:attempted-recon; sid:2013792; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"使用特定的HTTP标头顺序将libwww-perl扫描到//，而无需libwww-perl User-Agent"; flow:established,to_server; content:"TE|3a 20|deflate,gzip|3b|q=0.3|0d 0a|Connection|3a 20|TE, close|0d 0a|Host|3a 20|"; http_header; depth:53; content:"User-Agent|3a 20|"; within:100; http_header; content:!"libwww-perl/"; http_user_agent; http_header_names; content:"|0d 0a|TE|0d 0a|Host|0d 0a|User-Agent|0d 0a 0d 0a|"; depth:26; isdataat:!1,relative; http_request_line; content:"GET //"; fast_pattern; depth:6; threshold:type threshold, track by_dst, count 10, seconds 20; classtype:attempted-recon; sid:2013416; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现Polaris僵尸网络用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|polaris|0d 0a|"; fast_pattern; metadata: former_category SCAN; classtype:attempted-admin; sid:2029645; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现Mirai Variant用户代理（入站）"; flow:established,to_server; content:"User-Agent|3a 20|APEP"; http_header; fast_pattern; metadata: former_category MALWARE; classtype:attempted-admin; sid:2029025; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|DVRBOT"; fast_pattern; metadata: former_category SCAN; classtype:attempted-admin; sid:2029759; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|iamdelta"; fast_pattern; classtype:attempted-admin; sid:2029763; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现Mirai Variant用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|NoIr_x.86/"; fast_pattern; classtype:attempted-admin; sid:2029769; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|Hello/"; fast_pattern; classtype:attempted-admin; sid:2029792; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|XTC|0d 0a|"; fast_pattern; classtype:attempted-admin; sid:2029790; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|XTC BOTNET|0d 0a|"; fast_pattern; classtype:attempted-admin; sid:2029808; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|Kratos"; fast_pattern; classtype:attempted-admin; sid:2029929; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Havij SQL注入工具用户代理入站"; flow:established,to_server; http.header; content:"|29 20|Havij|0d 0a|Connection|3a 20|"; reference:url,itsecteam.com/en/projects/project1.htm; classtype:web-application-attack; sid:2012606; metadata:alarm_type 恶意扫描;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"发现Havij SQL注入工具用户代理出站"; flow:established,to_server; http.header; content:"|29 20|Havij|0d 0a|Connection|3a 20|"; reference:url,itsecteam.com/en/projects/project1.htm; classtype:web-application-attack; sid:2011924; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现可能的SQLMAP扫描"; flow:established,to_server; http.uri; content:"UNION ALL SELECT NULL, NULL, NULL, NULL"; content:"-- AND"; detection_filter:track by_dst, count 4, seconds 20; reference:url,sqlmap.sourceforge.net; reference:url,www.darknet.org.uk/2011/04/sqlmap-0-9-released-automatic-blind-sql-injection-tool/; classtype:attempted-recon; sid:2012754; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Kingcope KillApache.pl Apache mod_deflate DoS尝试"; flow:established,to_server; http.header; content:"Range|3a|bytes=0-,5-0,5-1,5-2,5-3,5-4,5-5,5-6,5-7,5-8,5-9,5-10,5-11,5-12,5-13,5-14"; reference:url,seclists.org/fulldisclosure/2011/Aug/175; classtype:attempted-dos; sid:2013472; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现NMAP SQL蜘蛛扫描"; flow:established,to_server; http.method; content:"GET"; http.uri; content:" OR sqlspider"; reference:url,nmap.org/nsedoc/scripts/sql-injection.html; classtype:web-application-attack; sid:2013778; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"检测到SCAN Paros代理扫描仪"; flow:to_server,established; http.user_agent; content:"Paros/"; startswith; reference:url,www.parosproxy.org; reference:url,doc.emergingthreats.net/2008187; classtype:attempted-recon; sid:2008187; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现SQLix SQL注入向量扫描"; flow:established,to_server; http.header; content:"GET"; content:"myVAR=1234"; content:"Windows 98"; distance:36; within:120; reference:url,www.owasp.org/index.php/Category%3aOWASP_SQLiX_Project; reference:url,doc.emergingthreats.net/2008654; classtype:attempted-recon; sid:2008654; metadata:alarm_type 恶意扫描;)
#alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现 Gootkit扫描仪用户代理入站"; flow:established,to_server; http.header; content:"Gootkit auto-rooter scanner"; metadata: former_category SCAN; classtype:web-application-attack; sid:2014022; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 Hydra用户代理"; flow: established,to_server; threshold: type limit, track by_src,count 1, seconds 60; http.header; content:"User-Agent|3a 20|Mozilla/4.0 (Hydra)"; nocase; fast_pattern; reference:url,freeworld.thc.org/thc-hydra; classtype:attempted-recon; sid:2011497; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现McAfee / Foundstone扫描仪Web扫描"; flow:established,to_server; threshold: type both, count 2, seconds 120, track by_src; http.header; content:"User-Agent|3a 20|Mozilla/5.0 (Windows|3b 20|Windows NT 6.1|3b 20|en-US)|0d 0a|"; fast_pattern; content:"|0d 0a|Accept-Encoding|3a 20|text|0d 0a|"; reference:url,www.mcafee.com/us/products/vulnerability-manager.aspx; classtype:attempted-recon; sid:2013492; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现 Tomcat Auth暴力尝试"; flow:to_server,established; threshold: type threshold, track by_src, count 5, seconds 30; http.header; content:"Authorization|3a| Basic bWFuYWdlcjp"; fast_pattern; reference:url,doc.emergingthreats.net/2008455; classtype:web-application-attack; sid:2008455; metadata:alarm_type 暴力破解;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Tomcat身份验证暴力尝试（tomcat）"; flow:to_server,established; threshold: type threshold, track by_src, count 5, seconds 30; http.header; content:"Authorization|3a| Basic dG9tY2F0"; fast_pattern; reference:url,doc.emergingthreats.net/2008454; classtype:web-application-attack; sid:2008454; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Tomcat身份验证暴力尝试（admin）"; flow:to_server,established; threshold: type threshold, track by_src, count 5, seconds 30; http.header; content:"Authorization|3a| Basic YWRtaW46"; fast_pattern; reference:url,doc.emergingthreats.net/2008453; classtype:web-application-attack; sid:2008453; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现 nessus 2.x 404探针"; flow:to_server,established; http.uri; content:"/NessusTest"; nocase; reference:nessus,10386; classtype:attempted-recon; sid:2102585; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现 Vega Web应用程序扫描"; flow:established,to_server; threshold: type limit, track by_src, count 5, seconds 40; http.user_agent; content:"Vega/"; reference:url,www.subgraph.com/products.html; reference:url,www.darknet.org.uk/2011/07/vega-open-source-cross-platform-web-application-security-assessment-platform/; classtype:attempted-recon; sid:2013249; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 ZmEu扫描仪用户代理入站"; flow:established,to_server; http.header; content:"User-Agent|3a 20|ZmEu|0d 0a|"; classtype:trojan-activity; sid:2012936; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Tomcat管理员空白登录凭据"; flow:to_server,established; flowbits:set,ET.Tomcat.login.attempt; http.uri; content:"/manager/html"; nocase; http.header; content:"|0d 0a|Authorization|3a| Basic YWRtaW46|0d 0a|"; reference:url,tomcat.apache.org; reference:url,doc.emergingthreats.net/2009218; classtype:attempted-admin; sid:2009218; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SCAN Absinthe SQL注入工具HTTP标头"; flow:established,to_server; http.header; content:"User-Agent|3a 20|Absinthe"; nocase; reference:url,0x90.org/releases/absinthe; reference:url,doc.emergingthreats.net/2009555; classtype:attempted-recon; sid:2009555; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 Nessus用户代理"; flow: established,to_server; threshold: type limit, track by_src,count 1, seconds 60; http.user_agent; content:"Nessus"; nocase; depth:40; reference:url,www.nessus.org; reference:url,doc.emergingthreats.net/2002664; classtype:attempted-recon; sid:2002664; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"检测到SCAN Nmap脚本引擎用户代理（Nmap脚本引擎）"; flow:to_server,established; http.user_agent; content:"Mozilla/5.0 (compatible|3b| Nmap Scripting Engine"; nocase; depth:46; reference:url,doc.emergingthreats.net/2009358; classtype:web-application-attack; sid:2009358; metadata:alarm_type 恶意扫描;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"发现Brutus扫描出站"; flow:established,to_server; http.user_agent; content:"Brutus/AET"; classtype:attempted-recon; sid:2015702; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现ZmEu漏洞扫描程序"; flow:established,to_server; threshold: type limit, track by_src, seconds 180, count 1; http.user_agent; content:"Made by ZmEu"; depth:12; metadata: former_category SCAN; reference:url,doc.emergingthreats.net/2010715; classtype:web-application-attack; sid:2010715; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现可疑用户代理入站（bot）"; flow:to_server,established; threshold: type limit, count 3, seconds 300, track by_src; http.header; content:"User-Agent|3a 20|bot/"; nocase; metadata: former_category HUNTING; reference:url,doc.emergingthreats.net/bin/view/Main/2008228; classtype:trojan-activity; sid:2008228; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 FHScan核心用户代理检测"; flow:to_server,established; http.user_agent; content:"FHScan Core 1."; reference:url,www.tarasco.org/security/FHScan_Fast_HTTP_Vulnerability_Scanner/index.html; classtype:attempted-recon; sid:2014541; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"使用PHPMyAdmin扫描看到的URI开头的带有HTML标签的SCAN GET"; flow:established,to_server; http.request_line; content:"GET <title>"; startswith; classtype:web-application-attack; sid:2016222; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Cisco Torch IOS HTTP扫描"; flow:to_server,established; http.user_agent; content:"Cisco-torch"; reference:url,www.hackingexposedcisco.com/?link=tools; reference:url,www.securiteam.com/tools/5EP0F1FEUA.html; reference:url,doc.emergingthreats.net/2008415; classtype:attempted-recon; sid:2008415; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"检测到SCAN核心项目扫描Bot UA"; flow:established,to_server; http.user_agent; content:"core-project/1.0"; classtype:web-application-activity; sid:2008529; metadata:alarm_type 恶意扫描;)
alert http $HOME_NET any -> any any (msg:"发现网络检测到待发Masscan"; flow:established,to_server; http.user_agent; content:"masscan/"; depth:8; reference:url,blog.erratasec.com/2013/10/that-dlink-bug-masscan.html; reference:url,blog.erratasec.com/2013/09/masscan-entire-internet-in-3-minutes.html; classtype:network-scan; sid:2017615; metadata:alarm_type 恶意扫描;)
alert http any any -> $HOME_NET any (msg:"发现网络检测到传入Masscan"; flow:established,to_server; http.user_agent; content:"masscan/"; depth:8; reference:url,blog.erratasec.com/2013/10/that-dlink-bug-masscan.html; reference:url,blog.erratasec.com/2013/09/masscan-entire-internet-in-3-minutes.html; classtype:network-scan; sid:2017616; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现Httprint Web服务器指纹扫描"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/antidisestablishmentarianism"; reference:url,www.net-square.com/httprint/; reference:url,www.net-square.com/httprint/httprint_paper.html; reference:url,doc.emergingthreats.net/2008416; classtype:attempted-recon; sid:2008416; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 Nikto Web App扫描正在进行中"; flow:to_server,established; threshold: type both, count 5, seconds 60, track by_src; http.user_agent; content:"(Nikto"; reference:url,www.cirt.net/code/nikto.shtml; reference:url,doc.emergingthreats.net/2002677; classtype:web-application-attack; sid:2002677; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|flow|0d 0a|"; fast_pattern; classtype:attempted-admin; sid:2030048; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现IBM NSA用户代理"; flow:established,to_server; threshold: type limit, track by_src,count 1, seconds 60; http.user_agent; content:"Network-Services-Auditor"; reference:url,ftp.inf.utfsm.cl/pub/Docs/IBM/Tivoli/pdfs/sg246021.pdf; reference:url,doc.emergingthreats.net/2003171; classtype:attempted-recon; sid:2003171; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Internet扫描项目HTTP扫描"; flow:established,to_server; http.user_agent; content:"research-scanner/"; startswith; http.host; content:"internetscanningproject.org"; reference:url,www.internetscanningproject.org; classtype:attempted-recon; sid:2018782; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 Chroot-apache0day未知Web扫描程序用户代理"; flow:established,to_server; http.user_agent; content:"chroot-apach0day"; nocase; depth:16; reference:url,isc.sans.edu/forums/diary/Interesting+HTTP+User+Agent+chroot-apach0day+/18453; classtype:attempted-recon; sid:2018800; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 JAWS Web服务器未经身份验证的Shell命令执行"; flow:established,to_server; http.method; content:"GET"; http.uri.raw; content:"/shell?cd+/tmp|3b|rm+-rf+*|3b|wget+"; depth:29; fast_pattern; reference:md5,fea9e4132fc9d30bda5eb6b1d9d0b9b9; classtype:web-application-attack; sid:2030093; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"检测到SCAN Nmap脚本引擎用户代理（Nmap NSE）"; flow:to_server,established; http.user_agent; content:"Nmap NSE"; reference:url,doc.emergingthreats.net/2009359; classtype:web-application-attack; sid:2009359; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"检测到SCAN Pavuk用户代理-用于离线分析的网站镜像工具"; flow:established,to_server; http.user_agent; content:"pavuk"; nocase; reference:url,pavuk.sourceforge.net/about.html; reference:url,doc.emergingthreats.net/2009827; classtype:attempted-recon; sid:2009827; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现WITOOL SQL注入扫描"; flow:to_server,established; threshold: type threshold, track by_dst, count 2, seconds 30; http.uri.raw; content:"union+select"; content:"select+user"; http.header; content:"User-Agent|3a 20|Mozilla/4.0 (compatible|3b 20|MSIE 6.0|3b 20|Windows NT 5.0|3b 20|MyIE2"; fast_pattern; reference:url,witool.sourceforge.net/; reference:url,doc.emergingthreats.net/2009833; classtype:attempted-recon; sid:2009833; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SCAN默认Mysqloit用户代理-Mysql Injection Takover工具"; flow:established,to_server; http.user_agent; content:"Mysqloit"; reference:url,code.google.com/p/mysqloit/; classtype:attempted-recon; sid:2009882; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现检测到可能的Mysqloit操作系统指纹/ SQL注入测试扫描"; flow:established,to_server; http.uri; content:"+UNION+select+'BENCHMARK(10000000,SHA1(1))"; reference:url,code.google.com/p/mysqloit/; reference:url,doc.emergingthreats.net/2009883; classtype:attempted-recon; sid:2009883; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现SQL注入尝试（代理uil2pn）"; flow:to_server,established; http.user_agent; content:"uil2pn"; reference:url,www.prevx.com/filenames/89385984947861762-X1/UIL2PN.EXE.html; reference:url,doc.emergingthreats.net/2010215; classtype:web-application-attack; sid:2010215; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SCAN Springenwerk XSS扫描仪用户代理"; flow:to_server,established; threshold: type limit, count 1, seconds 60, track by_src; http.user_agent; content:"Springenwerk"; reference:url,springenwerk.org/; reference:url,doc.emergingthreats.net/2010508; classtype:attempted-recon; sid:2010508; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"检测到SCAN Skipfish Web应用程序扫描（2）"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".old"; http.header; content:"Range|3A| bytes=0-199999"; http.user_agent; content:"Mozilla/5.0 SF/"; reference:url,isc.sans.org/diary.html?storyid=8467; reference:url,code.google.com/p/skipfish/; reference:url,doc.emergingthreats.net/2010956; classtype:attempted-recon; sid:2010956; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"侦测到SCAN crimscanner User-Agent"; flow:established,to_server; http.method; content:"GET"; http.user_agent; content:"crimscanner/"; nocase; reference:url,doc.emergingthreats.net/2010954; classtype:network-scan; sid:2010954; metadata:alarm_type 恶意扫描;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"发现w3af扫描远程文件包含检索"; flow:established,to_server; http.uri; content:"/w3af/remoteFileInclude.html"; nocase; http.host; content:"w3af.sourceforge.net"; startswith; reference:url,w3af.sourceforge.net; classtype:web-application-activity; sid:2011389; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现可能的WafWoof Web应用程序防火墙检测扫描"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/<invalid>hello.html"; reference:url,code.google.com/p/waffit/; reference:url,doc.emergingthreats.net/2011720; classtype:attempted-recon; sid:2011720; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现内部虚拟连接用户代理入站"; flow:established,to_server; http.user_agent; content:"(internal dummy connection)"; classtype:trojan-activity; sid:2012937; metadata:alarm_type 恶意扫描;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"发现Nikto扫描远程文件包含检索"; flow:established,to_server; http.uri; content:"/rfiinc.txt"; http.host; content:"cirt.net"; bsize:8; reference:url,cirt.net/nikto2; classtype:web-application-activity; sid:2011390; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现简单的Slowloris Flooder"; flow:established,to_server; threshold:type limit, track by_src, count 1, seconds 300; http.method; content:"POST"; http.header; content:"Content-length|3a 20|5235|0d 0a|"; fast_pattern; http.header_names; content:!"User-Agent|0d 0a|"; reference:url,www.imperva.com/docs/HII_Denial_of_Service_Attacks-Trends_Techniques_and_Technologies.pdf; classtype:web-application-attack; sid:2016033; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现 Acunetix接受HTTP标头检测到正在进行的扫描"; flow:established,to_server; threshold: type limit, count 1, seconds 60, track by_src; http.header; content:"Accept|3a 20|acunetix"; reference:url,www.acunetix.com/; classtype:attempted-recon; sid:2019963; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|danutzbaiatfinutz"; fast_pattern; classtype:attempted-admin; sid:2030198; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现Arachni扫描仪Web扫描"; flow:established,to_server; threshold: type limit, track by_src, count 1, seconds 300; http.user_agent; content:"Arachni/"; pcre:"/Arachni\/v?\d\.\d\.\d$/i"; reference:url,arachni-scanner.com; reference:url,github.com/Zapotek/arachni; classtype:attempted-recon; sid:2014869; metadata:alarm_type 恶意扫描;)
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"发现 Zmap用户代理（出站）"; flow:established,to_server; http.user_agent; content:"Mozilla/5.0 zgrab/0.x"; fast_pattern; bsize:21; metadata: former_category SCAN; classtype:network-scan; sid:2030345; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"发现可能存在漏洞的JBoss的扫描"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/invoker/"; depth:9; content:"servlet/"; http.request_body; content:"org.jboss.invocation.MarshalledValue"; http.content_type; content:"application/x-java-serialized-object|3b|"; endswith; reference:url,blog.imperva.com/2015/12/zero-day-attack-strikes-again-java-zero-day-vulnerability-cve-2015-4852-tracked-by-imperva.html; classtype:web-application-attack; sid:2022240; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现发现可疑UA（Callstranger漏洞检查器）"; flow:established,to_server; http.user_agent; content:"Callstranger Vulnerability Checker"; bsize:34; metadata: former_category SCAN; reference:url,github.com/yunuscadirci/CallStranger; classtype:attempted-recon; sid:2030271; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"发现UPnP订阅入站-可能的呼叫陌生人扫描（CVE-2020-12695）"; flow:established,to_server; http.method; content:"SUBSCRIBE"; nocase; http.header; content:"CALLBACK|3a 20|"; fast_pattern; content:"NT|3a 20|"; metadata: former_category SCAN; reference:cve,2020-12695; reference:url,kb.cert.org/vuls/id/339275; classtype:attempted-recon; sid:2030272; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|Sa0aS"; fast_pattern; classtype:attempted-admin; sid:2030273; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|Hello, pee"; fast_pattern; classtype:attempted-admin; sid:2030373; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|Meth/"; fast_pattern; metadata: former_category SCAN; classtype:attempted-admin; sid:2030375; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> any any (msg:"发现 ELF / Mirai变体用户代理（入站）"; flow:established,to_server; http.header; content:"User-Agent|3a 20|Masayki"; fast_pattern; classtype:attempted-admin; sid:2030470; metadata:alarm_type 恶意扫描;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB_SERVER PHP大型次普通双精度浮点数PHP DoS入站"; flow:established,to_server; content:"2.2250738585072011e-308"; nocase; reference:url,bugs.php.net/bug.php?id=53632; classtype:attempted-dos; sid:2012151; metadata:alarm_type DDos;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER HTTP 414请求URI太大"; flow:from_server,established; content:"HTTP/1.1 414 Request-URI Too Large"; depth:35; nocase; classtype:web-application-attack; sid:2012708; metadata:alarm_type DDos;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER Muieblackcat扫描仪"; flow:established,to_server; content:"GET /muieblackcat HTTP/1.1"; depth:26; classtype:attempted-recon; sid:2013115; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER .htpasswd访问"; flow:to_server,established; content:".htpasswd"; nocase; classtype:web-application-attack; sid:2101071; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER损害Wordpress安装服务的恶意JS"; flow:established,to_client; file_data; content:"var wow"; fast_pattern; content:"Date"; distance:0; within:200; pcre:"/var wow\s*=\s*\x22[^\x22\n]+?\x22\x3b[^\x3b\n]*?Date[^\x3b\n]*?\x3b/"; reference:url,blog.unmaskparasites.com/2012/07/11/whats-in-your-wp-head/; classtype:trojan-activity; sid:2015481; metadata:alarm_type Webshell;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-通用-基于c99shell的标头"; flow:established,to_client; file_data; content:"<span>Uname<br>User<br>Php<br>Hdd<br>Cwd</span>"; classtype:attempted-user; sid:2015918; metadata:alarm_type Webshell;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-通用-基于c99shell的带有分号的标头"; flow:established,to_client; file_data; content:"<span>Uname|3a|<br>User|3a|<br>Php|3a|<br>Hdd|3a|<br>Cwd|3a|</span>"; classtype:attempted-user; sid:2015919; metadata:alarm_type Webshell;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-未知-自杀"; flow:established,to_client; file_data; content:"<a href=|22|?x=selfremove|22|>[Self-Kill]</a>"; classtype:web-application-activity; sid:2015925; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-JSP RAT"; flow:established,to_client; file_data; content:"<table id=\"filetable\" class=\"filelist\" cellspacing=\"1px\" cellpadding=\"0px\">"; classtype:attempted-user; sid:2016151; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-JSP文件管理"; flow:established,to_client; file_data; content:"<h2>(L)aunch external program</h2>"; classtype:attempted-user; sid:2016152; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-Symlink_Sa"; flow:established,to_client; file_data; content:"<title>Symlink_Sa"; classtype:bad-unknown; sid:2016244; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-通用-基于c99shell的标头"; flow:established,to_client; file_data; content:"<b>Software|3a|"; content:"<b>uname -a|3a|"; content:"<b>uid="; classtype:bad-unknown; sid:2016245; metadata:alarm_type Webshell;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-zecmd-表单"; flow:established,to_client; file_data; content:"<FORM METHOD=|22|GET|22| NAME=|22|comments|22| ACTION=|22 22|>"; classtype:attempted-user; sid:2016501; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-MySQL接口-数据库列表"; flow:established,to_client; file_data; content:"<h1>Databases List</h1>"; classtype:bad-unknown; sid:2016574; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-罗马尼亚Webshel​​l"; flow:established,to_client; file_data; content:"Incarca fisier|3a|"; content:"Exeuta comada|3a|"; classtype:bad-unknown; sid:2016577; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $HOME_NET any (msg:"WEB_SERVER WebShell-简单-标题"; flow:established,to_client; file_data; content:"- Simple Shell</title>"; classtype:bad-unknown; sid:2016679; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-JSPCMD-表格"; flow:established,to_client; file_data; content:"<FORM METHOD=\"GET\" NAME=\"comments\" ACTION=\"\">"; classtype:bad-unknown; sid:2016684; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-MySQL界面-验证提示"; flow:established,to_client; file_data; content:"bG9nb25fc3VibWl0"; classtype:bad-unknown; sid:2016689; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-PHPShell-评论"; flow:established,to_client; file_data; content:"<!-- PHPShell "; classtype:attempted-user; sid:2016760; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-GODSpy-GOD黑客"; flow:established,to_client; file_data; content:"GOD Hacker"; classtype:trojan-activity; sid:2017083; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-GODSpy-验证提示"; flow:established,to_client; file_data; content:"name=|22|haz|22| value=|22|pasa|22|>"; classtype:trojan-activity; sid:2017087; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-Pouya-Pouya_Server Shell"; flow:established,to_client; file_data; content:"Pouya_Server Shell"; classtype:trojan-activity; sid:2017089; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-GODSpy-GODSpy标题"; flow:established,to_client; file_data; content:"GODSpy</title>"; classtype:trojan-activity; sid:2017084; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER SQLi-SELECT和sysobject"; flow:established,to_server; content:"SELECT"; nocase; content:"sysobjects"; distance:0; nocase; classtype:attempted-admin; sid:2017330; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ATTACKER SQLi-选择和模式列"; flow:established,to_server; content:"SELECT"; nocase; content:"information_schema.columns"; distance:0; nocase; classtype:attempted-user; sid:2017337; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-ASPyder-文件浏览器-界面"; flow:established,to_client; file_data; content:"document.myform.txtpath.value"; classtype:trojan-activity; sid:2017390; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-ASPyder-验证提示"; flow:established,to_client; file_data; content:"<INPUT type=password name=code >"; classtype:trojan-activity; sid:2017391; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-ASPyder-文件上传-响应"; flow:established,to_client; file_data; content:"<title>ASPYDrvsInfo</title>"; classtype:trojan-activity; sid:2017394; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER GIF中嵌入的PHP WebShell（出站）"; flow:established,to_client; file_data; content:"GIF89"; within:5; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017604; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER PHP WebShell嵌入JPG中（OUTBOUND）"; flow:established,to_client; file_data; content:"JFIF|00|"; distance:6; within:5; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017605; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER PHP WebShell嵌入PNG中（出站）"; flow:established,to_client; file_data; content:"PNG|0D 0A 1A 0A|"; distance:1; within:7; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017606; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER GIF中嵌入的PHP WebShell（INBOUND）"; flow:established,from_server; file_data; content:"GIF89"; within:5; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017607; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER嵌入JPG的PHP WebShell（INBOUND）"; flow:established,from_server; file_data; content:"JFIF|00|"; distance:6; within:5; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017608; metadata:alarm_type Webshell;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP WebShell嵌入PNG中（INBOUND）"; flow:established,from_server; file_data; content:"PNG|0D 0A 1A 0A|"; distance:1; within:7; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017609; metadata:alarm_type Webshell;)
alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER Perl / Mambo.WebShell Spreader IRC扫描消息"; flow:established,to_server; content:"PRIVMSG|20|"; content:"Scanning"; fast_pattern; within:50; content:"for open ports."; within:40; classtype:trojan-activity; sid:2017828; metadata:alarm_type Webshell;)
alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER Perl / Mambo.WebShell Spreader IRC打开端口消息"; flow:established,to_server; content:"PRIVMSG|20|"; content:"Open port(s)|3A| "; fast_pattern; within:50; classtype:trojan-activity; sid:2017829; metadata:alarm_type Webshell;)
alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER Perl / Mambo.WebShell Spreader IRC没有打开端口消息"; flow:established,to_server; content:"PRIVMSG|20|"; content:"No open ports found"; fast_pattern; within:50; classtype:trojan-activity; sid:2017830; metadata:alarm_type Webshell;)
alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER Mambo.PerlBot传播器IRC DDOS攻击消息"; flow:established,to_server; content:"PRIVMSG|20|"; content:"Attacking"; within:50; fast_pattern; classtype:trojan-activity; sid:2017831; metadata:alarm_type DDos;)
alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER Mambo.PerlBot传播器IRC DDOS攻击完成消息"; flow:established,to_server; content:"PRIVMSG|20|"; content:"Attack"; fast_pattern; within:50; content:"done"; within:8; classtype:trojan-activity; sid:2017832; metadata:alarm_type DDos;)
alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER Mambo.PerlBot Spreader IRC DDOS PerlBot版本消息"; flow:established,to_server; content:"PRIVMSG|20|"; content:"perlb0t ver"; within:50; classtype:trojan-activity; sid:2017833; metadata:alarm_type DDos;)
alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER Mambo.PerlBot传播器IRC DDOS Mambo扫描消息"; flow:established,to_server; content:"PRIVMSG|20|"; content:"Scanning for unpatched mambo for"; within:80; classtype:trojan-activity; sid:2017834; metadata:alarm_type DDos;)
alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER Mambo.PerlBot传播器IRC DDOS利用消息"; flow:established,to_server; content:"PRIVMSG|20|"; content:"Exploited"; within:50; content:"boxes in"; within:30; classtype:trojan-activity; sid:2017835; metadata:alarm_type DDos;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER ATTACKER WebShell-PHP违规者-标题"; flow:established,to_client; file_data; content:"<title>PHP Shell offender</title>"; nocase; classtype:web-application-attack; sid:2017951; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER Oracle Reports解析查询返回的Creds CVE-2012-3153"; flow:established,to_client; file_data; content:"Result Reports Server Command"; content:"userid="; distance:0; content:"/"; distance:0; content:"@"; distance:0; reference:url,netinfiltration.com; classtype:web-application-attack; sid:2018093; metadata:alarm_type 漏洞利用;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WEBSHELL CFM Shell访问"; flow:established,from_server; file_data; content:"<title>CFM shell"; nocase; reference:url,blog.spiderlabs.com/2014/03/coldfusion-admin-compromise-analysis-cve-2010-2861.html; classtype:successful-admin; sid:2018290; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell ASPXShell-标题"; flow:established,to_client; file_data; content:"<title>"; content:"ASPX Shell"; fast_pattern; nocase;  content:"</title>"; distance:0; classtype:trojan-activity; sid:2017183; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WEBSHELL K-Shell / ZHC Shell 1.0 / Aspx Shell后门NetCat_Listener"; flow:established,from_server; file_data; content:"Silentz's Tricks:"; content:"action=cmd2"; content:"Start NC"; reference:url,www.fidelissecurity.com/webfm_send/377; reference:url,pastebin.com/XAG1Hnfd; classtype:web-application-attack; sid:2018369; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER ATTACKER WebShell-Zehir4.asp-内容"; flow:established,from_server; file_data; content:"<title>zehir3--> powered by zehir"; content:"Sistem Bilgileri"; content:"color=red>Local Adres</td"; content:"zehirhacker"; reference:url,pastebin.com/m44e60e60; reference:url,www.fidelissecurity.com/webfm_send/377; classtype:web-application-attack; sid:2018371; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER SQL注入尝试（Agent NV32ts）"; flow:to_server,established; content:"User-Agent|3a| NV32ts"; reference:url,doc.emergingthreats.net/2009029; classtype:web-application-attack; sid:2009029; metadata:alarm_type SQL注入;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER RFI扫描仪成功（Fx29ID）"; flow:established,from_server; content:"FeeLCoMzFeeLCoMz"; reference:url,doc.emergingthreats.net/2010463; reference:url,opinion.josepino.com/php/howto_website_hack1; classtype:successful-user; sid:2010463; metadata:alarm_type 恶意扫描;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER DD-WRT信息公开成功"; flowbits:isset,et.ddwrt.infodis; flow:established,from_server; content:"lan_mac|3A 3A|"; content:"wlan_mac|3A 3A|"; distance:0; content:"lan_ip|3A 3A|"; distance:0; content:"mem_info|3A 3A|"; distance:0; reference:url,www.exploit-db.com/exploits/15842/; classtype:successful-recon-limited; sid:2012117; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2013-0156带有！ruby的Ruby On Rails XML YAML标记"; flow:established,to_server; content:" type"; nocase; fast_pattern; content:"yaml"; distance:0; nocase; content:"!ruby"; nocase; distance:0; pcre:"/<(?P<tname>[^\s]+)[^>]*?\stype\s*=\s*(?P<q>[\x22\x27])yaml(?P=q)((?!<\/(?P=tname)).+?)!ruby/si"; reference:url,groups.google.com/forum/?hl=en&fromgroups=#!topic/rubyonrails-security/61bkgvnSGTQ; classtype:web-application-attack; sid:2016204; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用1中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|{|20|"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019244; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用2"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|{%20"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019245; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用3"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|%7b|20|"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019246; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用4"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|%7b%20"; nocase; fast_pattern; within:13; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019247; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用5"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20{|20|"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019248; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用6"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20{%20"; nocase; fast_pattern; within:13; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019249; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用7"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20%7b|20|"; nocase; fast_pattern; within:13; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019250; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用8"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20%7b%20"; nocase; fast_pattern; within:15; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019251; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用9中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|{|20|"; nocase; fast_pattern; within:6; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019252; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用10中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|{%20"; nocase; fast_pattern; within:8; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019253; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用11中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|%7b|20|"; nocase; fast_pattern; within:8; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019254; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用12中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|%7b%20"; nocase; fast_pattern; within:10; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019255; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用13中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20{|20|"; nocase; fast_pattern; within:8; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019256; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用14"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20{%20"; nocase; fast_pattern; within:10; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019257; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用15中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20%7b|20|"; nocase; fast_pattern; within:10; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019258; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用16中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20%7b%20"; nocase; fast_pattern; within:12; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019259; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用17"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|{|20|"; nocase; fast_pattern; within:7; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019260; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用18中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|{%20"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019261; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用19中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|%7b|20|"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019262; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用20中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|%7b%20"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019263; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用21中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20{|20|"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019264; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用22中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20{%20"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019265; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用23中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20%7b|20|"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019266; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用24中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20%7b%20"; nocase; fast_pattern; within:13; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019267; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用26"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()|20|%7b|20|"; nocase; fast_pattern; within:7; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019269; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用27"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()|20|%7b%20"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019270; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用28中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()%20{|20|"; nocase; fast_pattern; within:7; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019271; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用29中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()%20%7b|20|"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019272; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP URLENCODE通用30"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()%20%7b%20"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019273; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271 HTTP URLENCODE通用25中的尝试"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()|20|{%20"; nocase; fast_pattern; within:7; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019268; metadata:alarm_type 漏洞利用;)
alert tcp $HOME_NET !21:23 -> $EXTERNAL_NET any (msg:"WEB_SERVER失眠外壳出站CMD标语"; flow:to_server,established; content:"Shell enroute......."; depth:20; content:"Microsoft Windows "; content:"Copyright |28|c|29| 20"; distance:0; content:"Microsoft Corp"; distance:0; reference:url,www.insomniasec.com/releases; classtype:trojan-activity; sid:2019900; metadata:alarm_type Webshell;)
alert http any any -> any any (msg:"WEB_SERVER ATTACKER WebShell-1337w0rm-登陆页面"; flow:established,to_client; file_data; content:"cPanel Cracker"; classtype:trojan-activity; sid:2020096; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ATTACKER WebShell-Weevely-下载"; flow:established,to_client; file_data; content:"<?php|0A|$"; content:"="; distance:4; within:2; content:" str_replace("; distance:0; classtype:trojan-activity; sid:2020555; metadata:alarm_type Webshell;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [9200,9292] (msg:"WEB_SERVER可能的CVE-2015-1427弹性搜索沙箱转义远程代码执行尝试"; flow:established,to_server; content:"POST /"; depth:6; content:"search"; distance:0; content:"script_fields"; distance:0; nocase; content:".class.forName"; nocase; distance:0; content:"java.lang.Runtime"; nocase; distance:0; reference:url,jordan-wright.github.io/blog/2015/03/08/elasticsearch-rce-vulnerability-cve-2015-1427; classtype:attempted-admin; sid:2020648; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER DFind w00tw00t GET-请求"; flow:established,to_server; content:"GET"; nocase; http_method; content:"/w00tw00t."; nocase; http_uri; depth:10; reference:url,doc.emergingthreats.net/2010794; classtype:attempted-recon; sid:2010794; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER AnonGhost PHP Web外壳"; flow:from_server,established; file_data; content:"base64_decode("; content:"Bbm9uR2hvc3Qg"; fast_pattern; classtype:trojan-activity; sid:2023143; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Apache Struts OGNL表达式注入"; flow:to_server,established; content:"|24 7b|"; http_uri; content:"|25 7b|"; distance:0; http_uri; content:"|7d|"; distance:0; http_uri; pcre:"/\${\s*?%{/U"; reference:cve,2013-2135; reference:bugtraq,60345; reference:url,cwiki.apache.org/confluence/display/WW/S2-015; classtype:web-application-attack; sid:2023535; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER SQL注入选择睡眠时间延迟"; flow:established,to_server; content:"SELECT"; http_uri; nocase; content:"SLEEP|28|"; http_uri; nocase; distance:0; pcre:"/\bSELECT.*?\bSLEEP\x28/Ui"; reference:url,pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet; classtype:web-application-attack; sid:2016935; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的加密Webshel​​l下载"; flow:established,to_client; file_data; content:"eval"; content:"mcrypt_decrypt"; distance:0; within:30; reference:url,blog.sucuri.net/2013/10/backdoor-evasion-using-encrypted-content.html; classtype:bad-unknown; sid:2017640; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Weevely检测到PHP后门（使用了pcntl_exec（）函数）"; flow:to_server,established; content:"JGFyZ3MgPSBh"; http_header; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013943; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER检测到Weevely PHP后门（使用了python_eval（）函数）"; flow:to_server,established; content:"QHB5dGhvbl9l"; http_header; metadata: former_category WEB_SERVER; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013942; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Microsoft IIS远程执行代码（CVE-2017-7269）"; flow:to_server,established; content:"If|3a 20 3c|"; http_header; pcre:"/^If\x3a\x20\x3c[^\r\n>]+?(?:[\x7f-\xff])/Hmi"; metadata: former_category WEB_SERVER; reference:url,github.com/edwardz246003/IIS_exploit/blob/master/exploit.py; classtype:attempted-user; sid:2024107; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER Bot搜索RFI扫描（ByroeNet /类似Casper的行星）"; flow:established,to_server; content:"plaNETWORK Bot"; nocase; http_user_agent; metadata: former_category WEB_SERVER; reference:url,eromang.zataz.com/2010/07/13/byroenet-casper-bot-search-e107-rce-scanner/; reference:url,doc.emergingthreats.net/2011243; classtype:web-application-attack; sid:2011243; metadata:alarm_type 恶意扫描;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER UA WordPress可能的DDOS-攻击"; flow:established,to_server; content:"Wordpress/"; http_user_agent; depth:10; metadata: former_category WEB_SERVER; reference:url,thehackernews.com/2013/09/thousands-of-wordpress-blogs.html; reference:url,pastebin.com/NP64hTQr; classtype:bad-unknown; sid:2017528; metadata:alarm_type DDos;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER Options出血（CVE-2017-9798）"; flow:from_server; content:"Allow|3a 20|"; http_header; pcre:"/^[^\n]+(?:[^ -~\x0d\x0a]|,\x20*,)/HR"; metadata: former_category WEB_SERVER; reference:cve,CVE-2017-9798; classtype:misc-activity; sid:2024760; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER 401TRG通用Webshel​​l请求-体内带有wget的POST"; flow:established,to_server; content:"wget"; nocase; http_client_body; content:"http"; nocase; http_client_body; within:11; threshold:type limit, track by_src, seconds 3600, count 1; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2024930; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER可能的HTTP 403 XSS尝试（本地源）"; flow:from_server,established; content:"403"; http_stat_code; file_data; content:"<script"; nocase; depth:512; content:!"location.replace|28 22|https|3a 2f 2f|block.opendns.com"; distance:0; reference:url,doc.emergingthreats.net/2010515; classtype:web-application-attack; sid:2010515; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER SELECT USER SQL注入尝试"; flow:established,to_server; content:"SELECT"; nocase; http_uri; content:"USER"; nocase; http_uri; pcre:"/SELECT[^a-z]+USER/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,doc.emergingthreats.net/2010963; classtype:web-application-attack; sid:2010963; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER脚本标记可能跨站点脚本尝试"; flow:to_server,established; content:"</script>"; nocase; http_uri; metadata: former_category WEB_SERVER; reference:url,ha.ckers.org/xss.html; reference:url,doc.emergingthreats.net/2009714; classtype:web-application-attack; sid:2009714; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER用户代理（入站）中可能的SQLi尝试"; flow:established,to_server; content:"select"; nocase; distance:0; fast_pattern; http_user_agent; content:"from"; nocase; http_user_agent; within:20; reference:url,blog.cloudflare.com/the-sleepy-user-agent/; classtype:trojan-activity; sid:2022816; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能尝试使用SELECT VERSION在URI中获取SQL Server版本"; flow:established,to_server; content:"SELECT"; nocase; http_uri; content:"VERSION"; nocase; distance:1; http_uri; reference:url,support.microsoft.com/kb/321185; reference:url,doc.emergingthreats.net/2011037; classtype:web-application-attack; sid:2011037; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Microsoft Internet信息服务（IIS）.asp文件扩展名解析文件上传安全性绕过尝试（asp）"; flow:established,to_server; content:".asp|3B 2E|"; nocase; http_uri; reference:url,www.securityfocus.com/bid/37460/info; reference:url,doc.emergingthreats.net/2010592; reference:url,www.securityfocus.com/bid/37460/info; reference:url,soroush.secproject.com/downloadable/iis-semicolon-report.pdf; reference:cve,2009-4444; classtype:web-application-attack; sid:2010592; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP Easteregg信息公开（phpinfo）"; flow:to_server,established; content:"?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000"; http_uri; reference:url,osvdb.org/12184; reference:url,www.0php.com/php_easter_egg.php; reference:url,seclists.org/nmap-dev/2010/q2/569; reference:url,doc.emergingthreats.net/2011141; classtype:attempted-recon; sid:2011141; metadata:alarm_type 信息泄露;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"Uri中的WEB_SERVER / system32 /-可能的受保护目录访问尝试"; flow:established,to_server; content:"/system32/"; nocase; http_uri; reference:url,doc.emergingthreats.net/2009362; classtype:attempted-recon; sid:2009362; metadata:alarm_type 未授权访问;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-通用-具有HTML表单的GIF标头"; flow:established,to_client; file_data; content:"GIF89a"; within:6; content:"<form "; nocase; fast_pattern; within:150; content:!"_VIEWSTATE"; classtype:trojan-activity; sid:2017134; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Weevely检测到PHP后门（使用了passthru（）函数）M1"; flow:to_server,established; content:"QHBhc3N0aHJ1KC"; http_header;  metadata: former_category WEB_SERVER; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013938; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Weevely检测到PHP后门（使用了passthru（）函数）M2"; flow:to_server,established; content:"BwYXNzdGhydSgn"; http_header; metadata: former_category WEB_SERVER; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2025593; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Weevely检测到PHP后门（使用了passthru（）函数）M3"; flow:to_server,established; content:"AcGFzc3RocnUoJ"; http_header; metadata: former_category WEB_SERVER; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2025594; metadata:alarm_type 木马病毒;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER JSP.SJavaWebManage WebShell Pass 20-09-2018 1"; flow:established,from_server; file_data; content:"|3c 25 40|page"; depth:7; content:"String|20|PASS|20|=|20 22|09a0aa1091460d23e5a68550826b359b|22|"; distance:0; fast_pattern; metadata: former_category WEB_SERVER; reference:md5,91eaca79943c972cb2ca7ee0e462922c; classtype:trojan-activity; sid:2026337; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER JSP.SJavaWebManage WebShell Pass 20-09-2018 2"; flow:established,from_server; file_data; content:"|3c 25 40|page"; depth:7; content:"String|20|PASS|20|=|20 22|098f6bcd4621d373cade4e832627b4f6|22|"; distance:0; fast_pattern; metadata: former_category WEB_SERVER; reference:md5,91eaca79943c972cb2ca7ee0e462922c; classtype:trojan-activity; sid:2026338; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER JSP.SJavaWebManage WebShell访问"; flow:established,from_server; file_data; content:"|3c 25 40|page"; depth:7; content:"|22|os.name|22|"; distance:0; content:"|22|/bin/sh|22|"; distance:0; content:"getRuntime|28 29|.exec|28|"; fast_pattern; metadata: former_category WEB_SERVER; reference:md5,91eaca79943c972cb2ca7ee0e462922c; classtype:trojan-activity; sid:2026336; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER在Drupal攻击中可能使用的基于Cookie的BackDoor"; flow:established,to_server; content:"preg_replace"; http_cookie; nocase; metadata: former_category WEB_SERVER; reference:url,www.kahusecurity.com/posts/drupal_7_sql_injection_info.html; classtype:attempted-user; sid:2019627; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER惠普智能管理Java反序列化RCE尝试"; flow:established,to_server; content:"POST"; http_method; content:"/login.jsf"; http_uri; content:"java.util.HashMap"; http_client_body; content:"javax.management.openmbean.TabularDataSupport"; http_client_body; metadata: former_category WEB_SERVER; reference:cve,2017-12557; reference:url,www.exploit-db.com/exploits/45952; classtype:web-application-attack; sid:2026719; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER jQuery文件上传尝试"; flow:established,to_server; content:"POST"; http_method; content:"/php/"; http_uri; content:"name=|22|files|22 3b|"; http_client_body; content:"<?php"; nocase; http_client_body; metadata: former_category WEB_SERVER; reference:url,github.com/lcashdol/Exploits/tree/master/CVE-2018-9206; reference:cve,2018-9206; classtype:web-application-attack; sid:2026552; metadata:alarm_type 漏洞利用;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER观察到中国砍刀WebShell的出站"; flow:established,from_server; content:"200"; http_stat_code; file_data; content:"<%@|20|Page|20|Language=|22|Jscript|22|%><eval|28|Request.Item|5b|"; fast_pattern; content:"|22 29 3b|%>"; distance:0; within:50; metadata: former_category WEB_SERVER; classtype:trojan-activity; sid:2027341; metadata:alarm_type 木马病毒;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER观察到中国砍刀WebShell的出站"; flow:established,from_server; content:"200"; http_stat_code; file_data; content:"|3c 25 40 20|Page|20|Language=|22|Jscript|22 25 3e 3c 25|eval|28|"; fast_pattern; content:"FromBase64String"; distance:0; nocase; content:"|25 3e|"; distance:0; metadata: former_category WEB_SERVER; classtype:trojan-activity; sid:2027393; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER ThinkPHP RCE开发尝试"; flow:established,to_server; content:"GET"; http_method; content:"/index"; http_uri; content:"/invokefunction&function=call_user_func_array"; http_uri; distance:0; fast_pattern; metadata: former_category WEB_SERVER; reference:url,www.exploit-db.com/exploits/45978; classtype:attempted-admin; sid:2026731; metadata:alarm_type 漏洞利用;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER BlackSquid JSP Webshel​​l出站"; flow:established,from_server; content:"200"; http_stat_code; file_data; content:"<|25 25|java.io.InputStream|20|"; depth:25; content:"Runtime.getRunetime|28 29|.exec|28|request"; distance:0; within:50; content:".getInputStream|28 29 3b|int|20|"; distance:0; fast_pattern; metadata: former_category WEB_SERVER; reference:url,blog.trendmicro.com/trendlabs-security-intelligence/blacksquid-slithers-into-servers-and-drives-with-8-notorious-exploits-to-drop-xmrig-miner/; classtype:attempted-admin; sid:2027433; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER观察到的FxCodeShell Web Shell密码"; flow:established,to_server; content:"FxxkMyLie1836710Aa"; http_client_body; metadata: former_category WEB_SERVER; classtype:trojan-activity; sid:2027514; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的Cisco Subscriber Edge Services Manager跨站点脚本/ HTML注入尝试"; flow:to_server,established; content:"/servlet/JavascriptProbe"; http_uri; nocase; content:"documentElement=true"; http_uri; nocase; content:"regexp=true"; nocase; http_uri; content:"frames=true"; http_uri; reference:url,www.securityfocus.com/bid/34454/info; reference:url,doc.emergingthreats.net/2010622; classtype:web-application-attack; sid:2010622; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的SQL注入尝试UNION SELECT"; flow:established,to_server; content:"UNION"; http_uri; nocase; content:"SELECT"; http_uri; nocase; pcre:"/UNION.+SELECT/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,doc.emergingthreats.net/2006446; classtype:web-application-attack; sid:2006446; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell通用-POST正文中的* .tar.gz"; flow:established,to_server; content:"POST"; http_method; content:".tar.gz"; nocase; http_client_body; classtype:bad-unknown; sid:2016992; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER Tomcat空字节目录列出尝试"; flow:to_server,established; content:"|00|.jsp"; http_uri; reference:bugtraq,2518; reference:bugtraq,6721; reference:cve,2003-0042; classtype:web-application-attack; sid:2102061; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的DD-WRT元字符注入命令执行尝试"; flow:to_server,established; content:"/cgi-bin/|3B|"; http_uri; nocase; pcre:"/\x2Fcgi\x2Dbin\x2F\x3B.+[a-z]/Ui"; reference:url,isc.sans.org/diary.html?storyid=6853; reference:url,www.theregister.co.uk/2009/07/21/critical_ddwrt_router_vuln/; reference:url,doc.emergingthreats.net/2009678; reference:url,www.dd-wrt.com/phpBB2/viewtopic.php?t=55173; reference:bid,35742; reference:cve,2009-2765; classtype:attempted-admin; sid:2009678; metadata:alarm_type Webshell;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777 (msg:"WEB_SERVER Oracle Secure Enterprise Search 10.1.8搜索脚本XSS尝试"; flow:to_server,established; content:"GET "; depth:4; content:"/search/query/search"; nocase; content:"search_p_groups="; nocase; content:"script"; nocase; pcre:"/<?(java|vb)?script>?/i"; reference:url,dsecrg.com/pages/vul/show.php?id=125; reference:url,doc.emergingthreats.net/2009643; classtype:web-application-attack; sid:2009643; metadata:alarm_type XSS;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7011 (msg:"WEB_SERVER Oracle BEA Weblogic Server 10.3 searchQuery XSS尝试"; flow:to_server,established; content:"GET "; depth:4; content:"/consolehelp/console-help.portal"; nocase; content:"searchQuery="; nocase; content:"script"; nocase; pcre:"/<?(java|vb)?script>?.*<.+\/script>?/i"; reference:url,dsecrg.com/pages/vul/show.php?id=131; reference:url,doc.emergingthreats.net/2009644; classtype:web-application-attack; sid:2009644; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER Bot搜索RFI扫描（ByroeNet / Casper-like sun4u）"; flow:established,to_server; content:"|0D 0A|User-Agent|3a| Mozilla/4.76 [ru] (X11|3b| U|3b| SunOS 5.7 sun4u)"; nocase; reference:url,eromang.zataz.com/2010/07/13/byroenet-casper-bot-search-e107-rce-scanner/; reference:url,doc.emergingthreats.net/2011244; classtype:web-application-attack; sid:2011244; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER机器人搜索RFI扫描（类似CasMa的MaMa Cyber​​ / ebes）"; flow:established,to_server; content:"|0D 0A|User-Agent|3a| MaMa "; nocase; reference:url,eromang.zataz.com/2010/07/13/byroenet-casper-bot-search-e107-rce-scanner/; reference:url,doc.emergingthreats.net/2011286; classtype:web-application-attack; sid:2011286; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的切诺基Web服务器GET AUX请求拒绝服务尝试"; flow:established,to_server; content:"GET |2F|AUX HTTP|2F|1|2E|"; nocase; depth:16; reference:url,securitytracker.com/alerts/2009/Oct/1023095.html; reference:url,www.securityfocus.com/bid/36814/info; reference:url,www.securityfocus.com/archive/1/507456; reference:url,doc.emergingthreats.net/2010229; classtype:attempted-dos; sid:2010229; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的Cisco ASA设备无客户端SSL VPN HTML重写安全性绕过尝试/跨站点脚本尝试"; flow:to_client,established; content:"CSCO_WebVPN"; nocase; content:"csco_wrap_js"; within:100; nocase; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=18442; reference:url,www.securityfocus.com/archive/1/504516; reference:url,www.securityfocus.com/bid/35476; reference:cve,2009-1201; reference:cve,2009-1202; reference:url,doc.emergingthreats.net/2010730; classtype:web-application-attack; sid:2010730; metadata:alarm_type XSS;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET 1024: (msg:"WEB_SERVER可能的HTTP 405 XSS尝试（本地源）"; flow:from_server,established; content:"HTTP/1.1 405 Method Not Allowed|0d 0a|"; depth:33; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010519; classtype:web-application-attack; sid:2010519; metadata:alarm_type XSS;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET 1024: (msg:"WEB_SERVER可能的HTTP 406 XSS尝试（本地源）"; flow:from_server,established; content:"HTTP/1.1 406 Not Acceptable|0d 0a|"; depth:29; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010521; classtype:web-application-attack; sid:2010521; metadata:alarm_type XSS;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET 1024: (msg:"WEB_SERVER可能的HTTP 500 XSS尝试（内部源）"; flow:from_server,established; content:"HTTP/1.1 500 Internal Server Error|0d 0a|"; depth:36; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010524; classtype:web-application-attack; sid:2010524; metadata:alarm_type XSS;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET 1024: (msg:"WEB_SERVER可能的HTTP 503 XSS尝试（内部源）"; flow:from_server,established; content:"HTTP/1.1 503 Service Unavailable|0d 0a|"; depth:34; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010526; classtype:web-application-attack; sid:2010526; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER SQL sp_password尝试"; flow:to_server,established; content:"sp_password"; nocase; reference:url,doc.emergingthreats.net/2000105; classtype:attempted-user; sid:2000105; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER SQL sp_delete_alert尝试"; flow:to_server,established; content:"sp_delete_alert"; nocase; reference:url,doc.emergingthreats.net/2000106; classtype:attempted-user; sid:2000106; metadata:alarm_type SQL注入;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER MSSQL Server OLEDB ASP错误"; flow: established,from_server; content:"Microsoft OLE DB Provider for SQL Server error"; reference:url,www.wiretrip.net/rfp/p/doc.asp/i2/d42.htm; reference:url,doc.emergingthreats.net/2001768; classtype:web-application-activity; sid:2001768; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Gootkit网站感染从控制服务器接收FTP凭据"; flowbits:isset,ET.GOOTKIT; flow:established,from_server; content:"<acc><login>"; nocase; content:"</login><pass>"; nocase; distance:0; content:"</pass><serv>"; nocase; distance:0; content:"</serv><port>21</port>"; nocase; distance:0; reference:url,www.m86security.com/labs/i/GootKit--Automated-Website-Infection,trace.1368~.asp; reference:url,doc.emergingthreats.net/2011287; classtype:web-application-attack; sid:2011287; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER本地网站被Gootkit感染"; flow:established,from_server; content:"Gootkit iframer component"; nocase; reference:url,www.m86security.com/labs/i/GootKit--Automated-Website-Infection,trace.1368~.asp; reference:url,doc.emergingthreats.net/2011285; classtype:web-application-attack; sid:2011289; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能恶意请求/ proc / self / environ"; flow:established,to_server; content:"/proc/self/environ"; http_uri; nocase; classtype:web-application-attack; sid:2012230; metadata:alarm_type 为授权访问;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"不带t（时间）参数的WEB_SERVER ScriptResource.axd访问-可能的ASP填充-Oracle漏洞利用"; flow:established,to_server; content:"GET"; http_method; content:"ScriptResource.axd"; http_uri; nocase; content:!"&t="; http_uri; nocase; content:!"&amp|3b|t="; http_uri; nocase; detection_filter:track by_src,count 15,seconds 2; reference:url,netifera.com/research/; reference:url,www.microsoft.com/technet/security/advisory/2416728.mspx; classtype:web-application-attack; sid:2011806; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ColdFusion路径遍历（语言环境3/5）"; flow:to_server,established; content:"POST"; http_method; content:"/CFIDE/administrator/entman/index.cfm"; nocase; http_uri; content:"locale=../../"; nocase; reference:url,h30507.www3.hp.com/t5/Following-the-White-Rabbit-A/Adobe-ColdFusion-s-Directory-Traversal-Disaster/ba-p/81964; reference:url,www.gnucitizen.org/blog/coldfusion-directory-traversal-faq-cve-2010-2861/; reference:cve,CVE-2010-2861; reference:url,www.exploit-db.com/exploits/14641/; classtype:web-application-attack; sid:2011360; metadata:alarm_type 目录遍历;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER可能成功的瞻博网络NetScreen ScreenOS固件版本披露尝试"; flow:established,from_server; content:"Juniper Networks, Inc"; content:"Version|3A|"; within:100; content:"ScreenOS"; distance:0; reference:url,securitytracker.com/alerts/2009/Apr/1022123.html; reference:url,www.securityfocus.com/bid/34710; reference:url,seclists.org/bugtraq/2009/Apr/242; reference:url,www.procheckup.com/vulnerability_manager/vulnerabilities/pr09-05; reference:url,doc.emergingthreats.net/2010162; classtype:attempted-recon; sid:2010162; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的SQL注入尝试UPDATE SET"; flow:established,to_server; content:"UPDATE"; nocase; http_uri; content:"SET"; nocase; distance:0; http_uri; pcre:"/\WUPDATE\s+[A-Za-z0-9$_].*?\WSET\s+[A-Za-z0-9$_].*?\x3d/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,doc.emergingthreats.net/2006447; classtype:web-application-attack; sid:2006447; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WP Mobile Detector中的WEB_SERVER任意文件上传漏洞"; flow:from_client,established; content:"/wp-content/plugins/wp-mobile-detector/"; http_uri; content:"resize.php?src=http"; http_uri; fast_pattern; reference:url,pluginvulnerabilities.com/2016/05/31/aribitrary-file-upload-vulnerability-in-wp-mobile-detector/; classtype:attempted-user; sid:2022860; metadata:alarm_type 漏洞利用;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER来自控制服务器的FTP凭据的Gootkit网站感染请求"; flow:established,to_server; content:"GET"; http_method; content:"/ftp"; nocase; http_uri; content:"User-Agent|3A| Mozilla/4.0 (compatible|3B| Win32|3B| WinHttp.WinHttpRequest"; nocase; http_header; content:!"www.trendmicro.com"; http_header; flowbits:set,ET.GOOTKIT; reference:url,www.m86security.com/labs/i/GootKit--Automated-Website-Infection,trace.1368~.asp; reference:url,doc.emergingthreats.net/2011286; classtype:web-application-attack; sid:2011290; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER 3Com智能管理中心跨站点脚本尝试"; flow:established,to_server; content:"/imc/login.jsf"; http_uri; nocase; content:"loginForm"; http_uri; nocase; content:"javax.faces.ViewState="; http_uri; nocase; pcre:"/ViewState\x3D.+(script|alert|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange)/Ui"; reference:url,securitytracker.com/alerts/2010/May/1024022.html; reference:url,support.3com.com/documents/netmgr/imc/3Com_IMC_readme_plat_3.30-SP2.html; reference:url,www.procheckup.com/vulnerability_manager/vulnerabilities/pr10-02; reference:url,doc.emergingthreats.net/2011145; classtype:web-application-attack; sid:2011145; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的梭子鱼IM防火墙smtp_test.cgi跨站点脚本尝试"; flow:established,to_server; content:"|2F|cgi|2D|mod|2F|smtp|5F|test|2E|cgi"; http_uri; nocase; content:"email|3D|"; http_uri; nocase; content:"hostname|3D|"; http_uri; nocase; content:"default|5F|domain|3D|"; http_uri; nocase; pcre:"/(script|img|src|alert|onmouse|onkey|onload|ondragdrop|onblur|onfocus|onclick)/Ui"; reference:url,www.securityfocus.com/bid/37248/info; reference:url,doc.emergingthreats.net/2010462; classtype:web-application-attack; sid:2010462; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER Onmouseover =-可能跨站点脚本尝试"; flow:to_server,established; content:"onmouseover="; http_uri; nocase; reference:url,www.w3schools.com/jsref/jsref_onmouseover.asp; reference:url,doc.emergingthreats.net/2009715; classtype:web-application-attack; sid:2009715; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER思科BBSM强制门户AccesCodeStart.asp跨站点脚本尝试"; flow:established,to_server; content:"|2F|ekgnkm|2F|AccessCodeStart|2E|asp"; http_uri; nocase; pcre:"/(script|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange)/Ui"; reference:url,www.securityfocus.com/bid/29191/info; reference:cve,2008-2165; reference:url,doc.emergingthreats.net/2010460; classtype:attempted-user; sid:2010460; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER cmd.exe-可能的命令执行尝试"; flow:to_server,established; content:"/cmd.exe"; http_uri; nocase; reference:url,doc.emergingthreats.net/2009361; classtype:attempted-recon; sid:2009361; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER HP LaserJet打印机跨站点脚本尝试"; flow:established,to_server; content:"/support_param.html/config"; http_uri; nocase; content:"Admin_Name=&Admin_Phone="; http_uri; nocase; content:"Product_URL="; http_uri; nocase; pcre:"/(script|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange).+Apply\x3DApply/Ui"; reference:url,dsecrg.com/pages/vul/show.php?id=148; reference:cve,2009-2684; reference:url,doc.emergingthreats.net/2010919; classtype:web-application-attack; sid:2010919; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Microsoft Internet信息服务（IIS）.aspx文件扩展名解析文件上传安全性绕过尝试（aspx）"; flow:established,to_server; content:".aspx|3B 2E|"; http_uri; nocase; reference:url,www.securityfocus.com/bid/37460/info; reference:url,doc.emergingthreats.net/2010593; reference:url,www.securityfocus.com/bid/37460/info; reference:url,soroush.secproject.com/downloadable/iis-semicolon-report.pdf; reference:cve,2009-4444; classtype:web-application-attack; sid:2010593; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER尝试通过URI访问MSSQL xp_cmdshell存储过程"; flow:established,to_server; content:"EXEC"; http_uri; nocase; content:"xp_cmdshell"; http_uri; nocase; reference:url,msdn.microsoft.com/en-us/library/ms175046.aspx; reference:url,www.databasejournal.com/features/mssql/article.php/3372131/Using-xpcmdshell.htm; reference:url,doc.emergingthreats.net/2009815; classtype:web-application-attack; sid:2009815; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER尝试通过URI访问MSSQL xp_servicecontrol存储过程"; flow:established,to_server; content:"EXEC"; http_uri; nocase; content:"xp_servicecontrol"; http_uri; nocase; pcre:"/(start|stop|continue|pause|querystate)/Ui"; reference:url,www.sqlusa.com/bestpractices2005/administration/xpservicecontrol/; reference:url,doc.emergingthreats.net/2009816; classtype:web-application-attack; sid:2009816; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER尝试通过URI访问MSSQL sp_adduser存储过程以创建新的数据库用户"; flow:established,to_server; content:"EXEC"; http_uri; nocase; content:"sp_adduser"; http_uri; nocase; reference:url,technet.microsoft.com/en-us/library/ms181422.aspx; reference:url,doc.emergingthreats.net/2009817; classtype:web-application-attack; sid:2009817; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER尝试通过URI访问MSSQL xp_regread / xp_regwrite / xp_regdeletevalue / xp_regdeletekey存储过程以修改注册表"; flow:established,to_server; content:"EXEC"; http_uri; nocase; content:"xp_reg"; http_uri; nocase; pcre:"/xp_reg(read|write|delete)/Ui"; reference:url,www.mssqlcity.com/Articles/Undoc/UndocExtSP.htm; reference:url,www.sql-server-performance.com/articles/dev/extended_stored_procedures_p1.aspx; reference:url,doc.emergingthreats.net/2009818; classtype:web-application-attack; sid:2009818; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER尝试通过URI访问MSSQL xp_fileexist存储过程以在磁盘上定位文件"; flow:established,to_server; content:"EXEC"; http_uri; nocase; content:"xp_fileexist"; http_uri; nocase; reference:url,www.mssqlcity.com/Articles/Undoc/UndocExtSP.htm; reference:url,www.dugger-it.com/articles/xp_fileexist.asp; reference:url,www.sql-server-performance.com/articles/dev/extended_stored_procedures_p1.aspx; reference:url,doc.emergingthreats.net/2009819; classtype:web-application-attack; sid:2009819; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER尝试通过URI访问MSSQL xp_enumerrorlogs存储过程以查看错误日志"; flow:established,to_server; content:"EXEC"; http_uri; nocase; content:"xp_enumerrorlogs"; http_uri; nocase; reference:url,www.mssqlcity.com/Articles/Undoc/UndocExtSP.htm; reference:url,www.sql-server-performance.com/articles/dev/extended_stored_procedures_p1.aspx; reference:url,doc.emergingthreats.net/2009820; classtype:web-application-attack; sid:2009820; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER尝试通过URI访问MSSQL xp_readerrorlogs存储过程以查看错误日志"; flow:established,to_server; content:"EXEC"; http_uri; nocase; content:"xp_readerrorlogs"; http_uri; nocase; reference:url,www.sql-server-performance.com/articles/dev/extended_stored_procedures_p1.aspx; reference:url,www.sqlteam.com/article/using-xp_readerrorlog-in-sql-server-2005; reference:url,doc.emergingthreats.net/2009822; classtype:web-application-attack; sid:2009822; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER尝试通过URI访问MSSQL xp_enumdsn / xp_enumgroups / xp_ntsec_enumdomains存储过程"; flow:established,to_server; content:"EXEC"; http_uri; nocase; content:"xp_"; http_uri; nocase; content:"_enum"; http_uri; nocase; pcre:"/(xp_enumdsn|xp_enumgroups|xp_ntsec_enumdomains)/Ui"; reference:url,www.mssqlcity.com/Articles/Undoc/UndocExtSP.htm; reference:url,ferruh.mavituna.com/sql-injection-cheatsheet-oku/; reference:url,msdn.microsoft.com/en-us/library/ms173792.aspx; reference:url,doc.emergingthreats.net/2009823; classtype:web-application-attack; sid:2009823; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP Easteregg信息披露（php徽标）"; flow:to_server,established; content:"?=PHPE9568F34-D428-11d2-A769-00AA001ACF42"; http_uri; reference:url,osvdb.org/12184; reference:url,www.0php.com/php_easter_egg.php; reference:url,seclists.org/nmap-dev/2010/q2/569; reference:url,doc.emergingthreats.net/2011142; classtype:attempted-recon; sid:2011142; metadata:alarm_type 信息泄露;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP Easteregg信息公开（zend徽标）"; flow:to_server,established; content:"?=PHPE9568F35-D428-11d2-A769-00AA001ACF42"; http_uri; reference:url,osvdb.org/12184; reference:url,www.0php.com/php_easter_egg.php; reference:url,seclists.org/nmap-dev/2010/q2/569; reference:url,doc.emergingthreats.net/2011143; classtype:attempted-recon; sid:2011143; metadata:alarm_type 信息泄露;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP Easteregg信息披露（有趣的徽标）"; flow:to_server,established; content:"?=PHPE9568F36-D428-11d2-A769-00AA001ACF42"; http_uri; reference:url,osvdb.org/12184; reference:url,www.0php.com/php_easter_egg.php; reference:url,seclists.org/nmap-dev/2010/q2/569; reference:url,doc.emergingthreats.net/2011144; classtype:attempted-recon; sid:2011144; metadata:alarm_type 信息泄露;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP通用远程文件包含尝试（HTTPS）"; flow:to_server,established; content:".php"; http_uri; nocase; content:"=https|3a|/"; http_uri; nocase; pcre:"/\x2Ephp\x3F.{0,300}\x3Dhttps\x3A\x2F[^\x3F\x26]+\x3F/Ui"; reference:url,doc.emergingthreats.net/2009152; classtype:web-application-attack; sid:2009152; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP通用远程文件包含尝试（FTP）"; flow:to_server,established; content:".php"; http_uri; nocase; content:"=ftp|3a|/"; http_uri; nocase; pcre:"/\x2Ephp\x3F.{0,300}\x3Dftp\x3A\x2F[^\x3F\x26]+\x3F/Ui"; reference:url,doc.emergingthreats.net/2009153; classtype:web-application-attack; sid:2009153; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP通用远程文件包含尝试（FTPS）"; flow:to_server,established; content:".php"; http_uri; nocase; content:"=ftps\:/"; http_uri; nocase; pcre:"/\x2Ephp\x3F.{0,300}\x3Dftp\x3A\x2F[^\x3F\x26]+\x3F/Ui"; reference:url,doc.emergingthreats.net/2009155; classtype:web-application-attack; sid:2009155; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的SQL注入尝试从删除"; flow:established,to_server; content:"DELETE"; http_uri; nocase; content:"FROM"; http_uri; nocase; pcre:"/DELETE.+FROM/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,doc.emergingthreats.net/2006443; classtype:web-application-attack; sid:2006443; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的SQL注入尝试INSERT INTO"; flow:established,to_server; content:"INSERT"; http_uri; nocase; content:"INTO"; http_uri; nocase; pcre:"/INSERT.+INTO/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,doc.emergingthreats.net/2006444; classtype:web-application-attack; sid:2006444; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的SQL注入（varchar）"; flow:established,to_server; content:"varchar("; http_uri; nocase; reference:url,doc.emergingthreats.net/2008175; classtype:attempted-admin; sid:2008175; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的SQL注入（exec）"; flow:established,to_server; content:"exec("; http_uri; nocase; reference:url,doc.emergingthreats.net/2008176; classtype:attempted-admin; sid:2008176; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER与Danmec相关的可能的SQL注入尝试（声明）"; flow:established,to_server; content:"DECLARE "; http_uri; nocase; content:"CHAR("; http_uri; nocase; content:"CAST("; http_uri; nocase; reference:url,doc.emergingthreats.net/2008467; classtype:attempted-admin; sid:2008467; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的ALTER SQL注入尝试"; flow:to_server,established; content:"ALTER"; http_uri; nocase; pcre:"/ALTER\ +(database|procedure|table|column)/Ui"; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,www.w3schools.com/SQl/sql_alter.asp; reference:url,doc.emergingthreats.net/2010084; classtype:web-application-attack; sid:2010084; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的DROP SQL注入尝试"; flow:to_server,established; content:"DROP"; http_uri; nocase; pcre:"/DROP\ +(database|procedure|table|column)/Ui"; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,www.w3schools.com/SQl/sql_drop.asp; reference:url,doc.emergingthreats.net/2010085; classtype:web-application-attack; sid:2010085; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER URI中可能的CREATE SQL注入尝试"; flow:to_server,established; content:"CREATE"; http_uri; nocase; pcre:"/CREATE\ +(database|procedure|table|column|directory)/Ui"; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,www.w3schools.com/Sql/sql_create_db.asp; reference:url,doc.emergingthreats.net/2010086; classtype:web-application-attack; sid:2010086; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER在URI中显示变量SQL注入尝试"; flow:established,to_server; content:"SHOW"; http_uri; nocase; content:"VARIABLES"; http_uri; nocase; pcre:"/SHOW.+VARIABLES/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,dev.mysql.com/doc/refman/5.1/en/server-system-variables.html; reference:url,doc.emergingthreats.net/2010965; classtype:web-application-attack; sid:2010965; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER SHOW CURDATE / CURTIME SQL注入尝试"; flow:established,to_server; content:"SHOW"; http_uri; nocase; content:"CUR"; http_uri; nocase; pcre:"/SHOW.+CUR(DATE|TIME)/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_curdate; reference:url,dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_curtime; reference:url,doc.emergingthreats.net/2010966; classtype:web-application-attack; sid:2010966; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER SHOW TABLES SQL注入尝试"; flow:established,to_server; content:"SHOW"; http_uri; nocase; content:"TABLES"; http_uri; nocase; pcre:"/SHOW.+TABLES/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,dev.mysql.com/doc/refman/4.1/en/show-tables.html; reference:url,doc.emergingthreats.net/2010967; classtype:web-application-attack; sid:2010967; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的INSERT VALUES SQL注入尝试"; flow:established,to_server; content:"INSERT"; http_uri; nocase; content:"VALUES"; http_uri; nocase; pcre:"/INSERT.+VALUES/Ui"; reference:url,ferruh.mavituna.com/sql-injection-cheatsheet-oku/; reference:url,en.wikipedia.org/wiki/Insert_(SQL); reference:url,doc.emergingthreats.net/2011039; classtype:web-application-attack; sid:2011039; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER MYSQL Benchmark命令消耗服务器资源"; flow:established,to_server; content:"BENCHMARK("; http_uri; nocase; content:")"; http_uri; pcre:"/BENCHMARK\x28[0-9].+\x29/Ui"; reference:url,dev.mysql.com/doc/refman/5.1/en/information-functions.html#function_benchmark; reference:url,doc.emergingthreats.net/2011041; classtype:web-application-attack; sid:2011041; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER MYSQL SELECT CONCAT SQL注入尝试"; flow:established,to_server; content:"SELECT"; http_uri; nocase; content:"CONCAT"; http_uri; nocase; pcre:"/SELECT.+CONCAT/Ui"; reference:url,ferruh.mavituna.com/sql-injection-cheatsheet-oku/; reference:url,www.webdevelopersnotes.com/tutorials/sql/a_little_more_on_the_mysql_select_statement.php3; reference:url,doc.emergingthreats.net/2011042; classtype:web-application-attack; sid:2011042; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能通过REVERSE函数混淆了SQL注入"; flow:established,to_server; content:"REVERSE"; http_uri; nocase; pcre:"/[^\w]REVERSE[^\w]?\(/Ui"; reference:url,snosoft.blogspot.com/2010/05/reversenoitcejni-lqs-dnilb-bank-hacking.html; reference:url,doc.emergingthreats.net/2011122; classtype:web-application-attack; sid:2011122; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Microsoft SharePoint Server 2007 _layouts / help.aspx跨站点脚本尝试"; flow:established,to_server; content:"/_layouts/help.aspx"; http_uri; nocase; content:"cid0="; http_uri; nocase; pcre:"/cid0\x3d.+(script|alert|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange)/Ui"; reference:url,www.htbridge.ch/advisory/xss_in_microsoft_sharepoint_server_2007.html; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=20415; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-039.mspx; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=20610; reference:cve,2010-0817; reference:url,doc.emergingthreats.net/2011073; classtype:web-application-attack; sid:2011073; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的3Com OfficeConnect路由器默认用户帐户远程命令执行尝试"; flow:established,to_server; content:"/utility.cgi?testType="; http_uri; nocase; content:"IP="; http_uri; nocase; content:"|7C 7C|"; http_uri; pcre:"/\x7C\x7C.+[a-z]/Ui"; reference:url,securitytracker.com/alerts/2009/Oct/1023051.html; reference:url,www.securityfocus.com/archive/1/507263; reference:url,www.securityfocus.com/bid/36722/info; reference:url,doc.emergingthreats.net/2010159; classtype:attempted-admin; sid:2010159; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER SELECT INSTR可能与ORACLE相关的盲SQL注入尝试"; flow:established,to_server; content:"SELECT"; http_uri; nocase; content:"INSTR"; http_uri; nocase; pcre:"/SELECT.+INSTR/Ui"; metadata: former_category WEB_SERVER; reference:url,www.psoug.org/reference/substr_instr.html; reference:url,www.easywebtech.com/artical/Oracle_INSTR.html; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,msdn.microsoft.com/en-us/library/ms161953.aspx; reference:url,doc.emergingthreats.net/2010284; classtype:web-application-attack; sid:2010284; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER SELECT SUBSTR / ING可能的盲SQL注入尝试"; flow:established,to_server; content:"SELECT"; http_uri; nocase; content:"SUBSTR"; http_uri; nocase; pcre:"/SELECT.+SUBSTR/Ui"; metadata: former_category WEB_SERVER; reference:url,www.1keydata.com/sql/sql-substring.html; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,msdn.microsoft.com/en-us/library/ms161953.aspx; reference:url,doc.emergingthreats.net/2010285; classtype:web-application-attack; sid:2010285; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的Cisco PIX / ASA HTTP Web接口HTTP响应拆分尝试"; flow:established,to_server; content:"GET"; http_method; content:"|0D 0A|Location|3A|"; http_uri; nocase; reference:url,www.secureworks.com/ctu/advisories/SWRX-2010-001/; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=20737; reference:cve,2008-7257; reference:url,doc.emergingthreats.net/2011763; classtype:web-application-attack; sid:2011763; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER URI中有波浪-潜在的.php〜源泄漏漏洞"; flow:established,to_server; content:"GET"; http_method; nocase; content:".php~"; http_uri; nocase; metadata: former_category WEB_SERVER; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009955; classtype:web-application-attack; sid:2009955; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"URI中的WEB_SERVER波浪号-潜在的.pl源公开漏洞"; flow:established,to_server; content:"GET"; http_method; nocase; content:".pl~"; http_uri; nocase; metadata: former_category WEB_SERVER; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009949; classtype:web-application-attack; sid:2009949; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER URI可能出现.inc源泄漏漏洞"; flow:established,to_server; content:"GET"; http_method; nocase; content:".inc~"; http_uri; nocase; metadata: former_category WEB_SERVER; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009950; classtype:web-application-attack; sid:2009950; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"URI中的WEB_SERVER波浪号-潜在的.conf源公开漏洞"; flow:established,to_server; content:"GET"; http_method; nocase; content:".conf~"; http_uri; nocase; metadata: former_category WEB_SERVER; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009951; classtype:web-application-attack; sid:2009951; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能出现URI潜在的.asp源公开漏洞"; flow:established,to_server; content:"GET"; http_method; nocase; content:".asp~"; http_uri; nocase; metadata: former_category WEB_SERVER; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009952; classtype:web-application-attack; sid:2009952; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER URI中有波浪号-潜在的.aspx源泄漏漏洞"; flow:established,to_server; content:"GET"; http_method; nocase; content:".aspx~"; http_uri; nocase; metadata: former_category WEB_SERVER; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009953; classtype:web-application-attack; sid:2009953; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER潮汐中URI-潜在的.cgi源泄漏漏洞"; flow:established,to_server; content:"GET"; http_method; nocase; content:".cgi~"; http_uri; nocase; metadata: former_category WEB_SERVER; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2010820; classtype:web-application-attack; sid:2010820; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER豪尔赫扫描"; flow:established,to_server; content:"HEAD"; http_method; content:"Mozilla/5.0 Jorgee"; depth:18; endswith; http_user_agent; fast_pattern; threshold: type limit, track by_dst, count 3, seconds 60; metadata: former_category WEB_SERVER; reference:url,www.skepticism.us/2015/05/new-malware-user-agent-value-jorgee/; classtype:trojan-activity; sid:2024265; metadata:alarm_type 木马病毒;)
alert http any any -> any 10000 (msg:"WEB_SERVER Webmin RCE CVE-2019-15107"; flow:to_server,established; content:"POST"; http_method; content:"/password_change.cgi"; depth:20; fast_pattern; endswith; content:"|7c|"; http_client_body; metadata: former_category WEB_SPECIFIC_APPS; reference:url,blog.firosolutions.com/exploits/webmin/; reference:cve,2019-15107; classtype:attempted-admin; sid:2027896; metadata:alarm_type 漏洞利用;)
alert dns $HTTP_SERVERS any -> any any (msg:"可疑e5b57288.com域的WEB_SERVER DNS查询-Anuna Checkin-损坏的PHP网站"; dns_query; content:"e5b57288.com"; depth:12; fast_pattern; endswith; nocase; metadata: former_category WEB_SERVER; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:trojan-activity; sid:2023229; metadata:alarm_type 木马病毒;)
alert dns $HTTP_SERVERS any -> any any (msg:"WEB_SERVER可疑33db9538.com域的DNS查询-Anuna Checkin-损坏的PHP网站"; dns_query; content:"33db9538.com"; depth:12; fast_pattern; endswith; nocase; metadata: former_category WEB_SERVER; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:trojan-activity; sid:2023227; metadata:alarm_type 木马病毒;)
alert dns $HTTP_SERVERS any -> any any (msg:"WEB_SERVER可疑9507c4e8.com域的DNS查询-Anuna Checkin-损坏的PHP网站"; dns_query; content:"9507c4e8.com"; depth:12; fast_pattern; endswith; nocase; metadata: former_category WEB_SERVER; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:trojan-activity; sid:2023228; metadata:alarm_type 木马病毒;)
alert dns $HTTP_SERVERS any -> any any (msg:"可疑54dfa1cb.com域的WEB_SERVER DNS查询-Anuna Checkin-损坏的PHP网站"; dns_query; content:"54dfa1cb.com"; depth:12; fast_pattern; endswith; nocase; metadata: former_category WEB_SERVER; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:trojan-activity; sid:2023230; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER带有通配符的IIS 8.3文件名（可能的文件/ Dir Bruteforce）"; flow:established,to_server; content:"~1"; http_uri; fast_pattern; pcre:"/([\*\?]~1|~1\.?[\*\?]|\/~1\/)/U"; reference:url,soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf; classtype:network-scan; sid:2015023; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER损坏的WordPress服务器提取恶意JS"; flow:established,to_server; content:"/net/?u="; http_uri; fast_pattern; content:"Host|3a 20|net"; http_header; content:"net.net"; http_header; distance:2; within:7; content:"User-Agent|3a 20|Mozilla/4.0 (compatible|3b 20|MSIE 8.0|3b 20|Windows NT 6.0)"; http_header; pcre:"/^Host\x3a\snet[0-4]{2}net\.net\r?\n$/Hmi"; reference:url,blog.unmaskparasites.com/2012/07/11/whats-in-your-wp-head/; classtype:trojan-activity; sid:2015480; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"URI中的WEB_SERVER可能的Oracle SQL注入utl_inaddr调用"; flow:established,to_server; content:"utl_inaddr.get_host"; nocase; http_uri; fast_pattern; classtype:attempted-admin; sid:2015749; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER WebShell-未知-.php？x = img＆img ="; flow:established,to_server; content:".php?x=img&img="; http_uri; fast_pattern; classtype:web-application-activity; sid:2015926; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"UA中的WEB_SERVER PHP标签"; flow:established,to_server; content:"<?php"; http_user_agent; nocase; fast_pattern; reference:url,blog.spiderlabs.com/2013/02/honeypot-alert-user-agent-field-php-injection-attacks.html; classtype:bad-unknown; sid:2016415; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"UA中的WEB_SERVER base64_decode"; flow:established,to_server; content:"base64_decode("; http_user_agent; nocase; fast_pattern; reference:url,blog.spiderlabs.com/2013/02/honeypot-alert-user-agent-field-php-injection-attacks.html; classtype:bad-unknown; sid:2016416; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER HTTP POST中可能的Perl Shell"; flow:established,to_server; content:"POST"; nocase; http_method; content:"#!/usr/bin/perl"; nocase; http_client_body; fast_pattern; reference:url,isc.sans.edu/diary.html?storyid=9478; classtype:web-application-attack; sid:2016641; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER HTTP POST中可能的Perl Shell"; flow:established,to_server; content:"POST"; nocase; http_method; content:"#!/bin/sh"; nocase; http_client_body; fast_pattern; reference:url,isc.sans.edu/diary.html?storyid=9478; classtype:web-application-attack; sid:2016642; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"HTTP POST中的WEB_SERVER PHP标记"; flow:established,to_server; content:"POST"; nocase; http_method; content:"<?php"; nocase; http_client_body; fast_pattern; reference:url,isc.sans.edu/diary.html?storyid=9478; classtype:web-application-attack; sid:2011768; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 200响应中的WEB_SERVER SQL错误（SQL语法错误）"; flow:from_server,established; content:"200"; http_stat_code; file_data; content:"error in your SQL syntax"; fast_pattern; classtype:bad-unknown; sid:2016672; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Apache Struts可能的xwork禁用方法执行"; flow:established,to_server; content:"xwork"; http_uri; nocase; content:"MethodAccessor"; http_uri; nocase; content:"denyMethodExecution"; http_uri; nocase; fast_pattern; reference:url,struts.apache.org/development/2.x/docs/s2-013.html; classtype:attempted-admin; sid:2016920; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的NGINX溢出CVE-2013-2028特定于漏洞利用"; flow:established,to_server; content:"chunked"; http_header; nocase; fast_pattern; pcre:"/Transfer-Encoding\x3a[^\r\n]*?chunked/Hi"; pcre:"/^[\r\n\s]*?[^\r\n]+HTTP\/1\.\d[^\r\n]*?\r?\n((?!(\r?\n\r?\n)).)*?Transfer-Encoding\x3a[^\r\n]*?Chunked((?!(\r?\n\r?\n)).)*?\r?\n\r?\n[\r\n\s]*?(f{6}[8-9a-f][0-9a-f]|[a-f0-9]{9})/si"; reference:url,www.vnsecurity.net/2013/05/analysis-of-nginx-cve-2013-2028/; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/nginx_chunked_size.rb; classtype:attempted-admin; sid:2016918; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"使用LOAD_FILE尝试WEB_SERVER SQL注入本地文件访问"; flow:established,to_server; content:"LOAD_FILE("; http_uri; nocase; fast_pattern; reference:url,dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_load-file; reference:url,pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet; classtype:web-application-attack; sid:2016936; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"uri中的WEB_SERVER allow_url_include PHP配置选项"; flow:established,to_server; content:"allow_url_include"; http_uri; fast_pattern; pcre:"/\ballow_url_include\s*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:2016977; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"uri中的WEB_SERVER safe_mode PHP配置选项"; flow:established,to_server; content:"safe_mode"; http_uri; fast_pattern; pcre:"/\bsafe_mode\s*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:2016978; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"uri中的WEB_SERVER open_basedir PHP配置选项"; flow:established,to_server; content:"open_basedir"; http_uri; fast_pattern; pcre:"/\bopen_basedir\s*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:2016981; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"uri中的WEB_SERVER auto_prepend_file PHP配置选项"; flow:established,to_server; content:"auto_prepend_file"; http_uri; fast_pattern; pcre:"/\bauto_prepend_file\s*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:2016982; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"uri中的WEB_SERVER suhosin.simulation PHP配置选项"; flow:established,to_server; content:"suhosin.simulation"; http_uri; fast_pattern; pcre:"/\bsuhosin\.simulation\s*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:2016979; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"uri中的WEB_SERVER disable_functions PHP配置选项"; flow:established,to_server; content:"disable_functions"; http_uri; fast_pattern; pcre:"/\bdisable_functions[\s\+]*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:2016980; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的SQLi xp_cmdshell POST正文"; flow:established,to_server; content:"xp_cmdshell"; nocase; http_client_body; fast_pattern; classtype:bad-unknown; sid:2017010; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-Pouya-URI-action ="; flow:established,to_server; content:".asp?action="; http_uri; nocase; fast_pattern; pcre:"/\.asp\?action=(?:txt(?:edit|view)|upload|info|del)(&|$)/Ui"; classtype:trojan-activity; sid:2017091; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER CRLF注入-URL中的换行符"; flow:established,to_server; content:"|0D 0A|"; fast_pattern; http_uri; pcre:"/[\n\r](?:content-(type|length)|set-cookie|location)\x3a/Ui"; reference:url,www.owasp.org/index.php/CRLF_Injection; classtype:web-application-attack; sid:2017143; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER动态操作中可能的Apache Struts OGNL"; flow:established,to_server; content:"/${"; http_uri; fast_pattern; pcre:"/\/\$\{[^\}\x2c]+?=/U"; reference:cve,2013-2135; reference:bugtraq,60345; reference:url,cwiki.apache.org/confluence/display/WW/S2-015; classtype:attempted-user; sid:2017277; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Joomla上传文件过滤器绕过"; flow:established,to_server; content:"option=com_media"; http_uri; nocase; fast_pattern; content:"Filedata[]"; http_client_body; nocase; pcre:"/filename[\r\n\s]*?=[\r\n\s]*?[\x22\x27]?[^\r\n\x22\x27\x3b]+?\.[\r\n\x3b\x22\x27]/Pi"; classtype:attempted-user; sid:2017327; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Coldfusion 9 Auth Bypass CVE-2013-0632"; flow:to_server; content:"POST"; http_method; content:"/adminapi/administrator.cfc?"; http_uri; nocase; content:"method"; http_uri; nocase; content:"login"; http_uri; nocase; content:"rdsPasswordAllowed"; nocase; http_client_body; fast_pattern; pcre:"/rdsPasswordAllowed[\r\n\s]*?=[\r\n\s]*?(true|1)/Pi"; reference:url,www.exploit-db.com/exploits/27755/; reference:cve,2013-0632; classtype:attempted-user; sid:2017366; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell base64_decode的通用评估"; flow:established,from_server; file_data; content:"base64_decode"; nocase; fast_pattern; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?base64_decode/Rsi"; classtype:trojan-activity; sid:2017399; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell gzinflate的通用评估"; flow:established,from_server; file_data; content:"gzinflate"; nocase; fast_pattern; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?gzinflate/Rsi"; classtype:trojan-activity; sid:2017400; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell str_rot13的通用评估"; flow:established,from_server; file_data; content:"str_rot13"; nocase; fast_pattern; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?str_rot13/Rsi"; classtype:trojan-activity; sid:2017401; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell gzuncompress的通用评估"; flow:established,from_server; file_data; content:"gzuncompress"; nocase; fast_pattern; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?gzuncompress/Rsi"; classtype:trojan-activity; sid:2017402; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell convert_uudecode的通用评估"; flow:established,from_server; file_data; content:"convert_uudecode"; nocase; fast_pattern; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?convert_uudecode/Rsi"; classtype:trojan-activity; sid:2017403; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP服务器URI中的SuperGlobal"; flow:established,to_server; content:"_SERVER["; fast_pattern; http_uri; pcre:"/[&\?]_SERVER\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017436; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER PHP GET SuperGlobal"; flow:established,to_server; content:"_GET["; fast_pattern; http_uri; pcre:"/[&\?]_GET\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017437; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER PHP POST SuperGlobal"; flow:established,to_server; content:"_POST["; fast_pattern; http_uri; pcre:"/[&\?]_POST\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017438; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER PHP COOKIE SuperGlobal"; flow:established,to_server; content:"_COOKIE["; fast_pattern; http_uri; pcre:"/[&\?]_COOKIE\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017439; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER PHP SESSION SuperGlobal"; flow:established,to_server; content:"_SESSION["; fast_pattern; http_uri; pcre:"/[&\?]_SESSION\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017440; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP在URI中请求SuperGlobal"; flow:established,to_server; content:"_REQUEST["; fast_pattern; http_uri; pcre:"/[&\?]_REQUEST\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017441; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER PHP ENV SuperGlobal"; flow:established,to_server; content:"_ENV["; fast_pattern; http_uri; pcre:"/[&\?]_ENV\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017442; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP服务器POST中的SuperGlobal"; flow:established,to_server; content:"_SERVER["; fast_pattern; http_client_body; pcre:"/(?:[&\?\r\n]|^)_SERVER\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017443; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"POST中的WEB_SERVER PHP GET SuperGlobal"; flow:established,to_server; content:"_GET["; fast_pattern; http_client_body; pcre:"/(?:[&\?\r\n]|^)_GET\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017444; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP POST POST中的SuperGlobal"; flow:established,to_server; content:"_POST["; fast_pattern; http_client_body; pcre:"/(?:[&\?\r\n]|^)_POST\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017445; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"POST中的WEB_SERVER PHP COOKIE SuperGlobal"; flow:established,to_server; content:"_COOKIE["; fast_pattern; http_client_body; pcre:"/[&\?]_COOKIE\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017446; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"POST中的WEB_SERVER PHP SESSION SuperGlobal"; flow:established,to_server; content:"_SESSION["; fast_pattern; http_client_body; pcre:"/[&\?]_SESSION\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017447; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP在POST中请求SuperGlobal"; flow:established,to_server; content:"_REQUEST["; fast_pattern; http_client_body; pcre:"/[&\?]_REQUEST\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017448; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"POST中的WEB_SERVER PHP ENV SuperGlobal"; flow:established,to_server; content:"_ENV["; fast_pattern; http_client_body; pcre:"/[&\?]_ENV\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:2017449; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WEBSHELL pwn.jsp外壳"; flow:established,to_server; content:"/pwn.jsp?"; http_uri; nocase; fast_pattern; content:"cmd="; http_uri; nocase; reference:url,nickhumphreyit.blogspot.co.il/2013/10/jboss-42-hacked-by-pwnjsp.html; reference:url,blog.imperva.com/2013/11/threat-advisory-a-jboss-as-exploit-web-shell-code-injection.html; classtype:attempted-admin; sid:2017734; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER IIS ISN BackDoor命令GetLog"; flow:established,to_server; content:"isn_getlog"; http_uri; nocase; fast_pattern; pcre:"/[?&]isn_getlog/Ui"; reference:url,blog.spiderlabs.com/2013/12/the-curious-case-of-the-malicious-iis-module.html; classtype:trojan-activity; sid:2017820; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Coldfusion cfcexplorer目录遍历"; flow:established,to_server; content:"/cfcexplorer.cfc"; nocase; http_uri; fast_pattern; content:"path="; nocase; pcre:"/^[^&]*?(?:%(?:25)?2e(?:%(?:(?:25)?2e(?:%(?:25)?5c|\/|\\)|2e(?:25)?%(?:25)?2f)|\.(?:%(?:25)?(?:2f|5c)|\/|\\))|\.(?:%(?:25)?2e(?:%(?:25)?(?:2f|5c)|\/|\\)|\.(?:%(?:25)?(?:2f|5c)|\/|\\)))/Ri"; reference:url,blog.spiderlabs.com/2013/12/the-curious-case-of-the-malicious-iis-module-prologue-method-of-entry-analysis.html; classtype:attempted-user; sid:2017875; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Apache Solr任意XSLT包含攻击"; flow:to_server,established; content:"../../"; fast_pattern; content:"&wt=xslt"; nocase; content:"&tr="; reference:cve,CVE-2013-6397; reference:url,www.agarri.fr/kom/archives/2013/11/27/compromising_an_unreachable_solr_server_with_cve-2013-6397/index.html; classtype:attempted-user; sid:2017882; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER POST BODY中可能的XXE SYSTEM ENTITY。"; flow:established,to_server; content:"DOCTYPE"; http_client_body; nocase; fast_pattern; content:"SYSTEM"; nocase; http_client_body; content:"ENTITY"; nocase; pcre:"/^\s+?[^\s\>]+?\s+?SYSTEM\s/Ri"; classtype:trojan-activity; sid:2018056; metadata:alarm_type XXE;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Apache Tomcat边界溢出DOS /文件上载尝试"; flow:established,to_server; content:"POST"; http_method; content:"multipart/form-data"; http_header; fast_pattern; content:"Content-Type|3a|"; nocase; pcre:"/^[^\r\n]*?boundary\s*?=\s*?[^\r\n]/Ri"; isdataat:4091,relative; content:!"|0A|"; within:4091; reference:url,blog.spiderlabs.com/2014/02/cve-2014-0050-exploit-with-boundaries-loops-without-boundaries.html; reference:cve,2014-0050; classtype:web-application-attack; sid:2018113; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"来自非本地网络的WEB_SERVER log4jAdmin访问（可以修改日志记录级别）"; flow:established,to_server; content:"/log4jAdmin.jsp"; http_uri; fast_pattern; reference:url, gist.github.com/iamkristian/943918; classtype:web-application-activity; sid:2018202; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"来自非本地网络页面主体的WEB_SERVER log4jAdmin访问（可以修改日志记录级别）"; flow:established,from_server; file_data; content:"<title>Log4J Administration</title>"; fast_pattern; content:"Change Log Level To"; reference:url, gist.github.com/iamkristian/943918; classtype:web-application-activity; sid:2018203; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ATTACKER WebShell-Zehir4.asp"; flow:established,to_server; content:".asp?mevla=1"; http_uri; nocase; fast_pattern; reference:url,pastebin.com/m44e60e60; reference:url,www.fidelissecurity.com/webfm_send/377; classtype:web-application-attack; sid:2018370; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER c99 Shell后门变量覆盖URI"; flow:to_server,established; content:"c99shcook["; nocase; http_uri; fast_pattern; pcre:"/[&?]c99shcook\[/Ui"; reference:url,thehackerblog.com/every-c99-php-shell-is-backdoored-aka-free-shells/; classtype:trojan-activity; sid:2018601; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER c99 Shell后门Var覆盖Cookie"; flow:to_server,established; content:"c99shcook"; nocase; fast_pattern; pcre:"/c99shcook/Ci"; reference:url,thehackerblog.com/every-c99-php-shell-is-backdoored-aka-free-shells/; classtype:trojan-activity; sid:2018602; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER c99 Shell后门Var覆盖客户端主体"; flow:to_server,established; content:"c99shcook["; nocase; fast_pattern; http_client_body; pcre:"/(?:^|&)c99shcook\[/Pi"; reference:url,thehackerblog.com/every-c99-php-shell-is-backdoored-aka-free-shells/; classtype:trojan-activity; sid:2018603; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER对/ proc / self / fd /的恶意请求"; flow:established,to_server; content:"/proc/self/fd/"; nocase; http_uri; fast_pattern; classtype:web-application-attack; sid:2019110; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER HTTP POST base64_decode的通用评估"; flow:established,to_server; content:"base64_decode"; nocase; http_client_body; fast_pattern; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?base64_decode/Rsi"; classtype:trojan-activity; sid:2019182; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHPMyAdmin BackDoor访问"; flow:established,to_server; content:"POST"; http_method; content:"/server_sync.php?"; fast_pattern; http_uri; content:"c="; http_uri; pcre:"/\/server_sync.php\?(?:.+?&)?c=/Ui"; reference:url,www.phpmyadmin.net/home_page/security/PMASA-2012-5.php; classtype:attempted-admin; sid:2015737; metadata:alarm_type 木马病毒;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER客户端主体2中可能的CVE-2014-6271尝试"; flow:established,to_server; content:"|25|28|25|29|25|20|25|7b|25|20"; http_client_body; fast_pattern; pcre:"/(:?(:?\x5e|%5e)|(:?[=?&]|\x25(:?3d|3f|26)))\s*?(:?%28|\x28)(:?%29|\x29)(:?%20|\x20)(:?%7b|\x7b)(:?%20|\x20)/Pi"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019234; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER CVE-2014-6271 HTTP标头行连续逃避LF中的尝试"; flow:to_server,established; content:"|28 29 0a 20 7b|"; fast_pattern; reference:url,www.invisiblethreat.ca/2014/09/cve-2014-6271/; classtype:attempted-admin; sid:2019291; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER CVE-2014-6271 HTTP标头行连续逃避CRLF中的尝试"; flow:to_server,established; content:"|28 29 0d 0a 20 7b|"; fast_pattern; reference:url,www.invisiblethreat.ca/2014/09/cve-2014-6271/; classtype:attempted-admin; sid:2019292; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER CURL命令在HTTP标头中指定输出"; flow:established,to_server; content:"curl "; fast_pattern; http_header; pcre:"/(?!^User-Agent\x3a)\bcurl\s[^\r\n]*?-(?:[Oo]|-(?:remote-name|output))[^\r\n]+(?:\x3b|&&)/Hm"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019308; metadata:alarm_type Webshell;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER WGET命令在HTTP标头中指定输出"; flow:established,to_server; content:"wget "; fast_pattern; http_header; pcre:"/(?!^User-Agent\x3a)\bwget\s[^\r\n]+(?:\x3b|&&)/Hm"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019309; metadata:alarm_type Webshell;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER lwp-download命令在HTTP标头中指定输出"; flow:established,to_server; content:"lwp-download "; fast_pattern; http_header; pcre:"/(?!^User-Agent\x3a)\blwp-download\s[^\r\n]+(?:\x3b|&&)/Hm"; metadata: former_category WEB_SERVER; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019310; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能通过管道bash shell传递到dev udp入站到WebServer"; flow:established,to_server; content:"/dev/udp/"; fast_pattern; classtype:bad-unknown; sid:2019314; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能通过管道bash shell传递到dev tcp入站到WebServer"; flow:established,to_server; content:"/dev/tcp/"; fast_pattern; classtype:bad-unknown; sid:2019285; metadata:alarm_type Webshell;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试URI"; flow:established,to_server; content:"|28 29 20 7b|"; http_uri; fast_pattern; pcre:"/[=?&\x2f]\s*?\x28\x29\x20\x7b/U"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019231; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER标题中可能的CVE-2014-6271尝试"; flow:established,to_server; content:"|28 29 20 7b|"; http_header; fast_pattern; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019232; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER客户端主体中可能的CVE-2014-6271尝试"; flow:established,to_server; content:"|28 29 20 7b|"; http_client_body; fast_pattern; pcre:"/(?:^|[=?&])\s*?\x28\x29\x20\x7b/P";  reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019233; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER客户端主体3中可能的CVE-2014-6271尝试"; flow:established,to_server; content:"()|25|20|25|7b"; http_client_body; fast_pattern; pcre:"/(:?(?:\x5e|%5e)|([=?&]|\x25(?:3d|3f|26)))\s*?\(\)(?:%20|\x20)(?:%7b|\x7b)/Pi"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019241; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER MongoDB否定参数服务器端JavaScript注入尝试"; flow:established,to_server; content:"[$ne]"; http_uri; fast_pattern; reference:url,blog.imperva.com/2014/10/nosql-ssji-authentication-bypass.html; reference:url,docs.mongodb.org/manual/reference/operator/query/ne/; classtype:web-application-attack; sid:2019460; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER通用PHP远程文件包括"; flow:to_server,established; content:"POST"; http_method; content:"allow_url_include"; http_uri; content:"safe_mode"; http_uri; content:"php|3a 2f 2f|input"; http_raw_uri; content:"<?php"; fast_pattern; http_client_body; content:"chmod 777"; http_client_body; classtype:attempted-user; sid:2019957; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Heimdallbot攻击工具入站"; flow:established,to_server; content:"Heimdallbot"; http_header; nocase; fast_pattern; pcre:"/^User-Agent\x3a[^\r\n]*?Heimdallbot/Hmi"; threshold: type limit, count 1, seconds 60, track by_src; classtype:web-application-attack; sid:2020323; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER IIS ISN BackDoor命令删除日志"; flow:established,to_server; content:"isn_logdel"; http_uri; nocase; fast_pattern; pcre:"/[?&]isn_logdel/Ui"; reference:url,blog.spiderlabs.com/2013/12/the-curious-case-of-the-malicious-iis-module.html; classtype:trojan-activity; sid:2017821; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER IIS ISN BackDoor命令获取日志路径"; flow:established,to_server; content:"isn_logpath"; http_uri; nocase; fast_pattern; pcre:"/[?&]isn_logpath/Ui"; reference:url,blog.spiderlabs.com/2013/12/the-curious-case-of-the-malicious-iis-module.html; classtype:trojan-activity; sid:2017822; metadata:alarm_type Webshell;)
alert tcp any any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB_SERVER可能的CVE-2014-6271尝试"; flow:established,to_server; content:" HTTP/1."; pcre:"/^[^\r\n]*?HTTP\/1(?:(?!\r?\n\r?\n)[\x20-\x7e\s]){1,500}\n[\x20-\x7e]{1,100}\x3a[\x20-\x7e]{0,500}\x28\x29\x20\x7b/s"; content:"|28 29 20 7b|"; fast_pattern; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2022028; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WEBSHELL Linux / Torte上传了"; flow:established,to_server; content:"POST"; http_method; content:"JGVudiA9ICJYRFZTTl9TRVNTSU9OX0NPT0tJR"; http_client_body; fast_pattern; content:"eval(base64_decode($_REQUEST["; http_client_body; reference:url,blog.malwaremustdie.org/2016/01/mmd-0050-2016-incident-report-elf.html; classtype:attempted-admin; sid:2022359; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WEBSHELL JSP /后门外壳访问"; flow:established,to_server; content:".war?cmd="; http_uri; fast_pattern; content:"&winurl="; http_uri; content:"&linurl="; http_uri; pcre:"/\.war\?cmd=[a-zA-Z0-9+/=]+&winurl=[a-zA-Z0-9+/=]*&linurl=[a-zA-Z0-9+/=]*/U"; reference:url,blog.malwaremustdie.org/2016/01/mmd-0049-2016-case-of-java-trojan.html; classtype:successful-admin; sid:2022348; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ImageMagick CVE-2016-3718 SSRF入站（MVG +填充+ URL）"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern; content:"fill"; http_client_body; content:"url("; http_client_body; distance:0; nocase; pcre:"/^\s*https?\x3a\/\//RPi"; classtype:web-application-attack; sid:2022791; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ImageMagick CVE-2016-3715入站文件删除（短暂：+ mvg）"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern; content:"ephemeral"; http_client_body; nocase; pcre:"/^\s*\x3a\s*[./]/RPi"; classtype:web-application-attack; sid:2022792; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ImageMagick CVE-2016-3716入站移动文件（MSL：+ MVG）"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern; content:"msl"; http_client_body; nocase; pcre:"/^\s*\x3a\s*[./]/RPi"; classtype:web-application-attack; sid:2022793; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ImageMagick CVE-2016-3717本地文件读取入站（标签：+ mvg）"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern; content:"label"; http_client_body; nocase; pcre:"/^\s*\x3a\s*\x40/RPi"; classtype:web-application-attack; sid:2022794; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ImageMagick CVE-2016-3714入站（MVG）"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern; pcre:"/https\x3a.+(?<!\x5c)(:[\x22\x27]|\\x2[27])\s*?[\x3b&\x7c><].*?(:[\x22\x27]|\\x2[27])/Psi"; classtype:web-application-attack; sid:2022789; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ImageMagick CVE-2016-3714入站（SVG）"; flow:established,to_server; content:"<svg "; http_client_body; nocase; fast_pattern; content:"xlink"; http_client_body; nocase; pcre:"/xlink\s*?\x3a\s*?href\s*?=\s*?(:[\x22\x27]|\\x2[27])https.+?&quot\s*?\x3b(?:\x7c|&(?:[gl]t|amp)\s*?\x3b)/Psi"; classtype:web-application-attack; sid:2022790; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER具有引荐来源网址匹配DoS工具的异常快速HTTP请求"; flow:to_server,established; content:"Referer|3a 20|"; http_header; content:"/slowhttptest/"; http_header; fast_pattern; pcre:"/Referer\x3a\x20[^\r\n]*\/slowhttptest\//Hi"; threshold: type both, track by_src, count 15, seconds 30; reference:url,community.qualys.com/blogs/securitylabs/2012/01/05/slow-read; classtype:web-application-activity; sid:2014103; metadata:alarm_type DDos;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2016-5118利用MVG尝试M1"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern; content:"|20 27 7c|"; http_client_body; nocase; reference:url,seclists.org/oss-sec/2016/q2/432; reference:cve,2016-5118; classtype:trojan-activity; sid:2022848; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2016-5118利用MVG尝试M2"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern; content:"|20 22 7c|"; http_client_body; nocase; reference:url,seclists.org/oss-sec/2016/q2/432; reference:cve,2016-5118; classtype:trojan-activity; sid:2022849; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Apache连续体任意命令执行"; flow:to_server,established; content:"POST"; http_method; content:"/saveInstallation.action"; http_uri; fast_pattern; content:"&installation.varValue="; http_client_body; content:"|25|60"; http_client_body; classtype:attempted-user; sid:2022912; metadata:alarm_type 漏洞利用;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER对* .33db9538.com域的HTTP请求-Anuna Checkin-损坏的PHP网站"; flow:to_server,established; content:"33db9538.com"; http_header; fast_pattern; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:bad-unknown; sid:2023231; metadata:alarm_type 恶意链接;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"对* .9507c4e8.com域的WEB_SERVER HTTP请求-Anuna Checkin-损坏的PHP网站"; flow:to_server,established; content:"9507c4e8.com"; http_header; fast_pattern; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:bad-unknown; sid:2023232; metadata:alarm_type 恶意链接;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"对* .e5b57288.com域的WEB_SERVER HTTP请求-Anuna Checkin-损坏的PHP网站"; flow:to_server,established; content:"e5b57288.com"; http_header; fast_pattern; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:bad-unknown; sid:2023233; metadata:alarm_type 恶意链接;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER对* .54dfa1cb.com域的HTTP请求-Anuna Checkin-损坏的PHP网站"; flow:to_server,established; content:"54dfa1cb.com"; http_header; fast_pattern; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-111911-4342-99&tabid=2; reference:url,security.stackexchange.com/questions/47253/hacked-site-encrypted-code; classtype:bad-unknown; sid:2023234; metadata:alarm_type 恶意链接;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的IIS整数溢出DoS（CVE-2015-1635）"; flow:established,to_server; content:"18446744073709551615"; http_header; fast_pattern; content:"Range|3a|"; nocase; http_header; pcre:"/^Range\x3a[^\r\n]*?18446744073709551615/Hmi"; reference:cve,2015-1635; classtype:web-application-attack; sid:2020912; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER Cisco IOS HTTP服务器执行命令执行尝试"; flow:to_server,established; content:"/level/15/exec/-/"; fast_pattern; nocase; http_uri; pcre:"/\x2Flevel\x2F15\x2Fexec\x2F\x2D\x2F[a-z]/Ui"; reference:url,doc.emergingthreats.net/2010623; classtype:web-application-attack; sid:2010623; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER Binget PHP库用户代理入站"; flow:established,to_server; content:"Binget/"; nocase; http_user_agent; depth:7; reference:url,www.bin-co.com/php/scripts/load/; reference:url,www.useragentstring.com/pages/useragentstring.php; classtype:attempted-recon; sid:2013049; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER pxyscand可疑用户代理入站"; flow:established,to_server; content:"pxyscand/"; nocase; http_user_agent; depth:9; reference:url,www.useragentstring.com/pages/useragentstring.php; classtype:attempted-recon; sid:2013051; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PyCurl可疑用户代理入站"; flow:established,to_server; content:"User-Agent|3a 20|PyCurl"; nocase; http_header; reference:url,www.useragentstring.com/pages/useragentstring.php; classtype:attempted-recon; sid:2013053; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER入站PHP用户代理"; flow:established,to_server; content:"PHP/"; nocase; http_user_agent; depth:4; reference:url,www.useragentstring.com/pages/useragentstring.php; classtype:attempted-recon; sid:2013057; metadata:alarm_type Webshell;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER出站PHP用户代理"; flow:established,to_server; content:"PHP/"; nocase; http_user_agent; depth:4; reference:url,www.useragentstring.com/pages/useragentstring.php; classtype:attempted-recon; sid:2013058; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER SQL注入尝试（Agent CZxt2s）"; flow:to_server,established; content:"czxt2s"; nocase; http_user_agent; depth:6; isdataat:!1,relative; reference:url,doc.emergingthreats.net/2011174; classtype:web-application-attack; sid:2011174; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER自动站点扫描以获取备份数据"; flow:established,to_server; content:"backupdata"; nocase; http_uri; content:"User-Agent|3a 20|Mozilla/4.0|0d 0a|"; http_header; classtype:attempted-recon; sid:2012286; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER自动网站扫描以获取backup_data"; flow:established,to_server; content:"backup_data"; nocase; http_uri; content:"User-Agent|3a 20|Mozilla/4.0|0d 0a|"; http_header; classtype:attempted-recon; sid:2012287; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER Bot搜索RFI扫描（类似Casper的Jcomers Bot扫描）"; flow:established,to_server; content:"Jcomers Bot"; nocase; http_user_agent; depth:11; metadata: former_category WEB_SERVER; reference:url,eromang.zataz.com/2010/07/13/byroenet-casper-bot-search-e107-rce-scanner/; reference:url,doc.emergingthreats.net/2011285; classtype:web-application-attack; sid:2011285; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER攻击工具反抗扫描仪"; flow:established,to_server; content:"revolt"; depth:6; http_user_agent; reference:url,www.Whitehatsecurityresponse.blogspot.com; reference:url,doc.emergingthreats.net/2009288; classtype:web-application-attack; sid:2009288; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER DataCha0s Web扫描仪/机器人"; flow:established,to_server; content:"DataCha0s"; nocase; depth:9; http_user_agent; reference:url,www.internetofficer.com/web-robot/datacha0s.html; reference:url,doc.emergingthreats.net/2003616; classtype:web-application-activity; sid:2003616; metadata:alarm_type 恶意扫描;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的PHP远程执行代码CVE-2019-11043 PoC（入站）"; flow:established,to_server; content:"|25|OA"; http_uri; nocase; content:"=/bin/sh+-c+'"; http_uri; nocase; distance:0; fast_pattern; metadata: former_category WEB_SERVER; reference:url,github.com/neex/phuip-fpizdam; reference:url,github.com/vulhub/vulhub/tree/master/php/CVE-2019-11043; reference:cve,2019-11043; classtype:web-application-attack; sid:2028895; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> any any (msg:"WEB_SERVER JAWS Web服务器未经身份验证的Shell命令执行"; flow:established,to_server; content:"GET"; http_method; content:"/shell?cd%20/tmp|3b|wget%20"; depth:24; http_raw_uri; fast_pattern; content:"Mozilla/5.0%20(Windows|3b|%20U|3b|%20Windows%20NT"; http_raw_header; metadata: former_category WEB_SERVER; reference:md5,a26f67a1d0a50af72c5fd9c94e9f5a1c; classtype:web-application-attack; sid:2029008; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-GODSpy-MySQL"; flow:established,to_server; content:"dbhost="; http_client_body; content:"dbuser="; http_client_body; content:"dbpass="; http_client_body; classtype:trojan-activity; sid:2017086; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Nagios statuswml.cgi远程任意Shell命令注入尝试"; flow:to_server,established; content:"GET"; http_method; content:"/statuswml.cgi?"; http_uri; nocase; content:"ping"; http_uri; nocase; pcre:"/^\s*=\s*([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}|[^\x26\x0D\x0A]*\x3B)/URi"; reference:bugtraq,35464; reference:url,doc.emergingthreats.net/2009670; classtype:web-application-attack; sid:2009670; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER JBOSS / JMX REMOTE WAR部署尝试（POST）"; flow:established,to_server; content:"POST"; http_method; content:"/jmx-console/HtmlAdaptor"; http_uri; nocase; content:"action=invokeOp&name=jboss.deployment"; nocase; content:"flavor%253DURL%252Ctype%253DDeploymentScanner"; within:50; nocase; content:"=http%3A%2F%2F"; within:40; reference:url,www.notsosecure.com/folder2/2009/10/27/hacking-jboss-with-jmx-console/; reference:url,www.nruns.com/_downloads/Whitepaper-Hacking-jBoss-using-a-Browser.pdf; reference:url,doc.emergingthreats.net/2010379; classtype:web-application-attack; sid:2010379; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER JBOSS / JMX REMOTE WAR部署尝试（GET）"; flow:established,to_server; content:"GET"; http_method; content:"/jmx-console/HtmlAdaptor?action=invokeOpByName&name=jboss.deployment"; http_uri; content:"DeploymentScanner"; http_uri; nocase; content:"methodName=addURL"; http_uri; nocase; content:"=http"; http_uri; nocase; reference:url,www.notsosecure.com/folder2/2009/10/27/hacking-jboss-with-jmx-console/; reference:url,www.nruns.com/_downloads/Whitepaper-Hacking-jBoss-using-a-Browser.pdf; reference:url,doc.emergingthreats.net/2010380; classtype:web-application-attack; sid:2010380; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER HP OpenView网络节点管理器CGI目录遍历"; flow:to_server,established; content:"GET"; http_method; content:"/OvCgi/"; nocase; http_uri;content:"/OpenView5.exe?"; nocase; distance:0; fast_pattern; http_uri; content:"Action=../../"; nocase; distance:0; http_uri; http_protocol; content:"HTTP/1."; reference:bugtraq,28745; reference:cve,CVE-2008-0068; reference:url,aluigi.altervista.org/adv/closedviewx-adv.txt; reference:url,doc.emergingthreats.net/2008171; classtype:web-application-attack; sid:2008171; metadata:alarm_type 目录遍历;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET 1024: (msg:"WEB_SERVER可能的HTTP 401 XSS尝试（本地源）"; flow:from_server,established; content:"401"; http_stat_code; content:"Unauthorized"; nocase; http_stat_msg; file_data; content:"<script"; nocase; depth:280; fast_pattern; threshold:type threshold,track by_src,count 10,seconds 60; reference:url,doc.emergingthreats.net/2010513; classtype:web-application-attack; sid:2010513; metadata:alarm_type XSS;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的D-Link路由器HNAP协议安全绕过尝试"; flow:established,to_server; urilen:7; content:"POST"; http_method; content:"/HNAP1/"; nocase; isdataat:!1,relative; fast_pattern; http_uri; content:"SOAPAction|3a 20|"; nocase; http_header; content:"/HNAP1/"; http_header; distance:0; pcre:"/^(?:set|get)/HRi"; content:"DeviceSettings"; within:14; http_header; reference:url,www.securityfocus.com/bid/37690; reference:url,doc.emergingthreats.net/2010698; classtype:web-application-attack; sid:2010698; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER HP OpenView /OvCgi/Toolbar.exe接受语言堆缓冲区溢出尝试"; flow:established,to_server; content:"POST"; http_method; content:"/OvCgi/Toolbar.exe"; nocase; fast_pattern; http_uri; content:"Accept-Language|3a 20|"; nocase; isdataat:1350,relative; http_header; content:!"|0A|"; within:1350; http_header; content:"Content-Length|3a|"; distance:0; http_header; reference:cve,2009-0921; reference:url,doc.emergingthreats.net/2010864; classtype:web-application-attack; sid:2010864; metadata:alarm_type 漏洞利用;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER可能的Darkleech C2"; flow:established,to_server; content:"/blog/?"; http_uri; depth:7; fast_pattern; content:"&utm_source="; http_uri; distance:0; pcre:"/^\/blog\/\?[a-z]{3,20}+\&utm_source=\d+\x3a\d+\x3a\d+$/U"; pcre:"/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/W"; http_header_names; content:!"Referer|0d 0a|"; metadata: former_category WEB_SERVER; reference:url,blog.sucuri.net/2015/12/evolution-of-pseudo-darkleech.html; classtype:command-and-control; sid:2022260; metadata:alarm_type 木马病毒;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER FOX-SRT-后门-CryptoPHP Shell C2 POST（fsockopen）"; flow:established,to_server; content:"POST"; http_method; content:"serverKey="; fast_pattern; content:"data="; content:"key="; http_header_names; content:!"Referer|0d 0a|"; content:!"User-Agent"; content:!"Cookie|0d 0a|"; http_connection; content:"close"; depth:5; isdataat:!1,relative; http_content_type; content:"application/x-www-form-urlencoded"; depth:33; threshold: type limit, track by_src, count 1, seconds 600; metadata: former_category WEB_SERVER; reference:url,blog.fox-it.com/2014/11/18/cryptophp-analysis-of-a-hidden-threat-inside-popular-content-management-systems/; classtype:command-and-control; sid:2019749; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER检测到WeBaCoo Web后门"; flow:to_server,established; content:"GET"; http_method; content:"cm="; http_cookie; content:"cn=M-cookie|3b|"; fast_pattern; http_cookie; content:"cp="; http_cookie; reference:url,panagioto.com/webacoo-backdoor-detection; classtype:web-application-activity; sid:2022295; metadata:alarm_type 木马病毒;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER FOX-SRT-后门-CryptoPHP Shell C2 POST"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition|3a 20|form-data|3b 20|name=|22|serverKey|22|"; http_client_body; fast_pattern; content:"Content-Disposition|3a 20|form-data|3b 20|name=|22|data|22|"; http_client_body; content:"Content-Disposition|3a 20|form-data|3b 20|name=|22|key|22|"; http_client_body; http_header_names; content:!"Referer|0d 0a|"; content:!"User-Agent"; content:!"Cookie|0d 0a|"; threshold: type limit, track by_src, count 1, seconds 600; metadata: former_category WEB_SERVER; reference:url,blog.fox-it.com/2014/11/18/cryptophp-analysis-of-a-hidden-threat-inside-popular-content-management-systems/; classtype:command-and-control; sid:2019748; metadata:alarm_type 木马病毒;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER Magento XMLRPC-利用尝试"; flow:established,to_server; content:"POST"; nocase; http_method; content:"/api/xmlrpc"; http_uri; content:"file|3a 2f 2f 2f|"; http_client_body; fast_pattern; reference:url,www.magentocommerce.com/blog/comments/important-security-update-zend-platform-vulnerability/; reference:url,www.magentocommerce.com/blog/update-zend-framework-vulnerability-security-update; reference:url,www.exploit-db.com/exploits/19793/; classtype:web-application-attack; sid:2015625; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER SHOW CHARACTER SET SQL注入尝试"; flow:established,to_server; content:"SHOW"; http_uri; nocase; content:"CHARACTER"; http_uri; nocase; distance:0; content:"SET"; nocase; distance:0; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,dev.mysql.com/doc/refman/5.0/en/show-character-set.html; reference:url,doc.emergingthreats.net/2010964; classtype:web-application-attack; sid:2010964; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER LANDesk命令注入尝试"; flow:established,to_server; content:"POST"; http_method; content:"/gsb/datetime.php"; http_uri; nocase; content:"delBackupName"; nocase; http_client_body; content:"backupRestoreFormSubmitted"; distance:0; nocase; http_client_body; reference:url,www.coresecurity.com/content/landesk-csrf-vulnerability; reference:cve,2010-0369; reference:url,doc.emergingthreats.net/2010863; classtype:web-application-attack; sid:2010863; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的HP OpenView网络节点管理器椭圆臂.exe CGI缓冲区溢出尝试"; flow:established,to_server; content:"GET"; http_method; nocase; content:"/OvCgi/ovalarm.exe"; http_uri; nocase; fast_pattern; content:"OVABverbose="; http_uri; nocase; distance:0; pcre:"/^(1|on|true)/URi"; http_accept_lang; isdataat:100,relative; reference:cve,2009-4179; reference:url,doc.emergingthreats.net/2010704; classtype:web-application-attack; sid:2010704; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的思科自适应安全设备Web VPN FTP或CIFS身份验证表单网络钓鱼尝试"; flow:established,to_server; content:"+CSCOE+/files/browse.html"; nocase; http_uri; fast_pattern; content:"code=init"; http_uri; nocase; distance:0; content:"path=ftp"; http_uri; nocase; distance:0; reference:url,www.securityfocus.com/bid/35475/info; reference:cve,2009-1203; reference:url,doc.emergingthreats.net/2010457; classtype:attempted-user; sid:2010457; metadata:alarm_type 恶意链接;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER WSO 2.6 Webshel​​l"; flow:established,to_client; file.data; content:"WebShellOrb 2.6</title>"; nocase; fast_pattern; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029860; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER WSO 2.5 Webshel​​l"; flow:established,to_client; file.data; content:"WSO 2.5</title>"; nocase; fast_pattern; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029862; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER X-Sec Webshel​​l"; flow:established,to_client; file.data; content:"<title>X-Sec Shell V."; nocase; fast_pattern; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029864; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部受损服务器上访问WEB_SERVER ALFA TEaM Webshel​​l"; flow:established,to_client; file.data; content:"ALFA TEaM Shell - v"; nocase; fast_pattern; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029866; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER内部受损服务器上访问的WSO 4.2.5 Webshel​​l"; flow:established,to_client; file.data; content:"WSO 4.2.5</title>"; nocase; fast_pattern; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029868; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER WSO 4.2.6 Webshel​​l"; flow:established,to_client; file.data; content:"WSO 4.2.6</title>"; nocase; fast_pattern; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029870; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER内部受损服务器上访问的Kageyama Webshel​​l"; flow:established,to_client; file.data; content:"<H1><center>Shell Kageyama</center></H1>"; nocase; fast_pattern; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029872; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用WSO Webshel​​l"; flow:established,to_client; file.data; content:"<span>Uname:<br>User:<br>Php:<br>Hdd:<br>Cwd:</span></td><td><nobr>"; nocase; fast_pattern; content:"<span>Group:</span>"; nocase; distance:0; content:"<span>Safe mode:</span>"; nocase; distance:0; content:"<span>Datetime:</span>"; nocase; distance:0; content:"<span>Free:</span>"; nocase; distance:0; content:"<span>Server IP:</span>"; nocase; distance:0; content:"<span>Client IP:</span>"; nocase; distance:0; content:">Self remove</a>"; nocase; distance:0; content:"<h1>File manager</h1>"; nocase; distance:0; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029874; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER MINI MO Webshel​​l"; flow:established,to_client; file.data; content:"<title>MINI MO Shell</title>"; nocase; fast_pattern; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029876; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受感染的服务器上访问WEB_SERVER通用WSO Webshel​​l密码提示"; flow:established,to_client; file_data; content:"<form method=post>Password: <input type=password name=pass><input type=submit value='>>'></form>"; fast_pattern; classtype:web-application-attack; sid:2029883; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受感染的服务器上访问WEB_SERVER通用WSO Webshel​​l密码提示"; flow:established,to_client; file_data; content:"<form   method=|20 22|post|22 20|action=|20 22 22|> <input type=|22|input|22 20|name =|22|f_pp|22 20|value=|20 22 22|/><input type=|20 22|submit|22 20|value="; fast_pattern; classtype:web-application-attack; sid:2029885; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER匿名Webshel​​l"; flow:established,to_client; file.data; content:"<title>AnonyMous SHell</title>"; nocase; fast_pattern; content:"id=|22|pageheading|22|>AnonyMous SHell"; nocase; distance:0; classtype:web-application-attack; sid:2029887; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用微型Webshel​​l"; flow:established,to_client; file.data; content:"<tr><td>Current Path : <a href=|22|?path=/"; nocase; content:"<tr class=|22|first|22|>"; nocase; distance:0; content:"<td><center>File/Folder Name</center></td>"; nocase; distance:0; content:"<td><center>Size</center></td>"; nocase; distance:0; content:"<td><center>Permissions</center></td>"; nocase; distance:0; content:"<td><center>Options</center></td>"; nocase; distance:0; content:"<td><center><form method=|22|POST|22 20|action=|22|?option&path="; nocase; distance:0; fast_pattern; content:"<td><a href=|22|?filesrc="; nocase; distance:0; content:"<option value=|22|delete|22|>Delete</option>"; nocase; distance:0; content:"<option value=|22|chmod|22|>Chmod</option>"; nocase; distance:0; content:"<option value=|22|rename|22|>Rename</option>"; nocase; distance:0; content:"<option value=|22|edit|22|>Edit</option>"; nocase; distance:0; classtype:web-application-attack; sid:2029889; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受感染的服务器上访问WEB_SERVER通用Webshel​​l密码提示"; flow:established,to_client; file_data; content:"<form method=post>password<br><input type=password name=pass style=|22|background-color:whitesmoke|3b|border:1px solid #fff|3b|outline:none|3b|' required>"; content:"<input type=submit name=|22|watching|22 20|value=|22|submit|22 20|style=|22|border:none|3b|background-color:#56ad15|3b|color:#fff|3b|cursor:pointer|3b 22|></form>"; distance:0; fast_pattern; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029891; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受感染的服务器上访问WEB_SERVER通用Webshel​​l密码提示"; flow:established,to_client; file.data; content:"<form method=post>Password<br><input type=password name=pass style='background-color:whitesmoke|3b|border:1px solid #FFF|3b|outline:none|3b|' required>"; content:"<input type=submit name='watching' value='submit' style='border:none|3b|background-color:#56AD15|3b|color:#fff|3b|cursor:pointer|3b|'></form>"; distance:0; fast_pattern; classtype:web-application-attack; sid:2029901; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问WEB_SERVER WSO Webshel​​l密码提示"; flow:established,to_client; file.data; content:"<form action=|22 22 20|method=|22|post|22|><input type=|22|text|22 20|name=|22|_nv|22|><input type=|22|submit|22 20|value=|22|>>|22|></form>"; distance:0; fast_pattern; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029903; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER叶子PHPMailer"; flow:established,to_client; file.data; content:"<title>Leaf PHPMailer"; fast_pattern; content:"<li>[-email-] : <b>Reciver Email"; content:"<li>[-emailuser-] : <b>Email User"; classtype:web-application-attack; sid:2029905; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER猫头鹰PHPMailer"; flow:established,to_client; file.data; content:"<title>Owl PHPMailer"; fast_pattern; content:"function stopSending()"; content:"function startSending()"; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029907; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受感染的服务器上访问WEB_SERVER通用Webshel​​l密码提示"; flow:established,to_client; file.data; content:"<input type=password name=pass style='background-color:whitesmoke|3b|border:1px solid #FFF|3b|outline:none|3b|' required>"; content:"<input type=submit name='watching' value='>>' style="; distance:0; fast_pattern; classtype:web-application-attack; sid:2029909; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER内部受损服务器上访问的16Shop网络钓鱼工具包"; flow:established,to_client; file.data; content:"<title>16SHOP"; fast_pattern; content:"<label>Public Key"; distance:0; content:"<label>Password"; distance:0; classtype:web-application-attack; sid:2029915; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<font><font>file Manager</font></font>"; nocase; distance:0; content:"<font><font>Back Connect"; nocase; distance:0; content:"<font><font>CgiShell</font></font>"; nocase; distance:0; content:"<font><font>Symlink</font></font>"; nocase; distance:0; content:"Mailer</font></font>"; nocase; distance:0; content:"<font><font>Auto r00t</font></font>"; nocase; distance:0; content:"<font><font>Upload</font></font>"; nocase; distance:0; content:"Exploiter & scan Tools</font></font>"; nocase; distance:0; fast_pattern; content:"<font><font>Self remove</font></font>"; nocase; distance:0; classtype:web-application-attack; sid:2029917; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<meta name=|22|description|22 20|content=|22|This Mini Shell"; nocase; content:"<meta name=|22|author|22 20|content=|22|An0n 3xPloiTeR"; fast_pattern; distance:0; nocase; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029919; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER WSO 2.6 Webshel​​l"; flow:established,to_client; file.data; content:"WSO 2.6</title>"; nocase; fast_pattern; classtype:web-application-attack; sid:2029935; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用PHP邮件程序"; flow:established,to_client; file.data; content:"<title>DRIV3R KR PRIV8 MAILER"; fast_pattern; nocase; classtype:web-application-attack; sid:2029937; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<meta name=|22|Description|22 20|content=|22|Mr.Rm19"; nocase; content:">Time On Server : <font color="; nocase; distance:0; content:">Server IP : <font color="; nocase; distance:0; content:">Current Dir : </font><a href="; nocase; distance:0; content:">Mass Deface</a>"; nocase; distance:0; fast_pattern; classtype:web-application-attack; sid:2029939; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用PHP邮件程序"; flow:established,to_client; file.data; content:"<title>|20 7c 20|Log In|20 7c 20|Power Mailer Inbox"; nocase; content:"</a>Welcome To Power Mailer Inbox"; nocase; distance:0; fast_pattern; classtype:web-application-attack; sid:2029941; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用PHP邮件程序"; flow:established,to_client; file.data; content:"<title>F. Mortolino</title>"; nocase; content:"MortoLino - mode*SPAMMER"; nocase; distance:0; fast_pattern; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029943; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用PHP邮件程序"; flow:established,to_client; file.data; content:"<title>GwEx Mailer"; nocase; fast_pattern; content:">GwEx Mailer </font>"; nocase; distance:0; classtype:web-application-attack; sid:2029945; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用PHP邮件程序"; flow:established,to_client; file.data; content:"<title>W0rmVps PRIV8 MAILER"; nocase; fast_pattern; classtype:web-application-attack; sid:2029947; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用PHP邮件程序"; flow:established,to_client; file.data; content:"<title>SMTP Mailer</title>"; nocase; fast_pattern; content:">Inbox SMTP Mailer</div>"; nocase; distance:0; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2029949; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用PHP邮件程序"; flow:established,to_client; file.data; content:"<title>Priv8 Mailer Inbox"; nocase; fast_pattern; content:"document.getElementById(|22|xmailer"; nocase; distance:0; classtype:web-application-attack; sid:2029951; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER perl发布尝试"; flow:to_server,established; http.method; content:"POST"; http.uri; content:"/perl/"; reference:bugtraq,5520; reference:cve,2002-1436; reference:nessus,11158; classtype:web-application-attack; sid:2101979; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Oracle Java Process Manager访问"; flow:to_server,established; http.uri; content:"/oprocmgr-status"; reference:nessus,10851; classtype:web-application-activity; sid:2101874; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER Apache APR apr_fnmatch堆栈溢出拒绝服务"; flow:to_server,established; urilen:>1400; http.uri; content:"|2F 3F|P|3D 2A 3F 2A 3F 2A 3F 2A 3F 2A 3F|"; pcre:"/(?:\x2a\x3f){700}/"; reference:cve,2011-0419; reference:url,cxib.net/stuff/apr_fnmatch.txt; reference:url,bugzilla.redhat.com/show_bug.cgi?id=703390; classtype:attempted-dos; sid:2012926; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER perl命令尝试"; flow:to_server,established; http.uri; content:"/perl?"; nocase; reference:arachnids,219; reference:cve,1999-0509; reference:nessus,10173; reference:url,www.cert.org/advisories/CA-1996-11.html; classtype:attempted-recon; sid:2101649; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能的文件远程文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=file|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2013002; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能的php远程文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=php|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2013001; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能的ftps本地文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=ftps|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2013000; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能的ftp远程文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=ftp|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2012999; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能的https本地文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=https|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2012998; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能的zlib远程文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=zlib|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2013014; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能的数据远程文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=data|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2013003; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能的glob远程文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=glob|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2013004; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能的Phar远程文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=phar|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2013005; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能的ssh2远程文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=ssh2|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2013006; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能的rar远程文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=rar|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2013007; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能包含ogg远程文件的尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=ogg|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2013008; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP可能期望远程文件包含尝试"; flow:established,to_server; http.uri; content:".php?"; content:"=expect|3a|//"; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:2013009; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PUT网站毁损尝试"; flow:established,to_server; http.method; content:"PUT"; http.request_body; content:"<title>.|3a 3a|[+] Defaced by "; nocase; classtype:web-application-attack; sid:2013365; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER DNS更改器cPanel尝试"; flow:to_server,established; http.request_body; content:"pwCfm=Dn5Ch4ng3"; classtype:web-application-attack; sid:2013921; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER JBoss jmx-console探针"; flow:to_server,established; http.method; content:"HEAD"; http.uri; content:"/jmx-console/HtmlAdaptor?"; nocase; reference:cve,2010-0738; classtype:web-application-activity; sid:2014017; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER JBoss jmx控制台访问控制绕过尝试"; flow:to_server,established; http.method; content:"HEAD"; http.uri; content:"/jmx-console/HtmlAdaptor?"; nocase; content:"Runtime.getRuntime().exec("; reference:cve,2010-0738; classtype:web-application-activity; sid:2014018; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ASP.NET表单身份验证绕过"; flow:to_server,established; content:"CreateUserStepContainer"; content:"UserName="; distance:0; content:"%00"; distance:0; pcre:"/UserName\x3d[^\x26]+\x2500/"; http.uri; content:"/CreatingUserAccounts.aspx"; reference:cve,2011-3416; classtype:attempted-user; sid:2014100; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER mod_gzip_status访问"; flow:to_server,established; http.uri; content:"/mod_gzip_status"; reference:nessus,11685; classtype:web-application-activity; sid:2102156; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER globals.pl访问"; flow:to_server,established; http.uri; content:"/globals.pl"; reference:bugtraq,2671; reference:cve,2001-0330; classtype:web-application-activity; sid:2102073; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"在URI中检测到WEB_SERVER / etc / shadow"; flow:to_server,established; http.uri; content:"/etc/shadow"; nocase; reference:url,en.wikipedia.org/wiki/Shadow_password; reference:url,doc.emergingthreats.net/2009485; classtype:attempted-recon; sid:2009485; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER eval / base64_decode攻击尝试入站"; flow:established,to_server; http.uri; content:"eval|28|base64_decode|28|"; classtype:web-application-attack; sid:2014296; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"使用MSSQL sp_configure命令进行WEB_SERVER可能的Webshell"; flow:established,to_server; http.uri; content:"sp_configure"; nocase; reference:url,technet.microsoft.com/en-us/library/ms188787.aspx; reference:url,technet.microsoft.com/en-us/library/ms190693.aspx; classtype:web-application-attack; sid:2011424; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER apache？M = D目录列表尝试"; flow:to_server,established; http.uri; content:"/?M=D"; reference:bugtraq,3009; reference:cve,2001-0731; classtype:web-application-activity; sid:2101519; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Tomcat服务器侦听访问"; flow:to_server,established; http.uri; content:"/jsp/snp/"; content:".snp"; reference:bugtraq,1532; reference:cve,2000-0760; classtype:attempted-recon; sid:2101108; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Tomcat目录遍历尝试"; flow:to_server,established; http.uri; content:"|00|.jsp"; reference:bugtraq,2518; classtype:web-application-attack; sid:2101055; metadata:alarm_type 目录遍历;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER /〜root访问"; flow:to_server,established; http.uri; content:"/~root"; nocase; classtype:attempted-recon; sid:2101145; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER .htaccess访问"; flow:to_server,established; http.uri; content:".htaccess"; nocase; classtype:attempted-recon; sid:2101129; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER / bin / ksh可能的Shell命令执行尝试"; flow:established,to_server; http.uri; content:"/bin/ksh"; nocase; classtype:web-application-attack; sid:2011467; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER / bin / tsh可能的Shell命令执行尝试"; flow:established,to_server; http.uri; content:"/bin/tsh"; nocase; classtype:web-application-attack; sid:2011466; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER / bin / sh可能的Shell命令执行尝试"; flow:established,to_server; http.uri; content:"/bin/sh"; nocase; classtype:web-application-attack; sid:2011465; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER / bin / csh可能的Shell命令执行尝试"; flow:established,to_server; http.uri; content:"/bin/csh"; nocase; classtype:web-application-attack; sid:2011464; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER删除尝试"; flow:to_server,established; http.method; content:"DELETE"; nocase; reference:nessus,10498; classtype:web-application-activity; sid:2101603; metadata:alarm_type Webshell;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WEB_SERVER可能观察到的Apache DDos UA（DDos Apache）出站"; flow:established,to_server; http.header; content:"User-Agent|3a 20|DDos Apache"; classtype:attempted-dos; sid:2029983; metadata:alarm_type DDos;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER IIS INDEX_ALLOCATION身份验证绕过尝试"; flow:established,to_server; http.uri; content:"|3a|$INDEX_ALLOCATION"; nocase; reference:url,lists.grok.org.uk/pipermail/full-disclosure/2012-June/087269.html; classtype:bad-unknown; sid:2014886; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能尝试枚举MS SQL Server版本"; flow:established,to_server; http.uri; content:"@@version"; nocase; reference:url,support.microsoft.com/kb/321185; classtype:attempted-admin; sid:2014890; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的IBM Rational Directory Server（RDS）帮助系统href浏览器重定向"; flow:established,to_server; http.uri; content:"/rds-help/advanced/deferredView.jsp?"; nocase; content:"href="; nocase; pcre:"/^\s*(?:ftps?|https?|php)\:\//Ri"; reference:url,secunia.com/advisories/49627/; classtype:web-application-attack; sid:2014986; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的IBM Rational Directory Server（RDS）帮助系统href跨站点脚本尝试"; flow:established,to_server; http.uri; content:"/rds-help/advanced/deferredView.jsp?"; nocase; content:"href="; nocase; pcre:"/^.+(?:script|alert|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange|javascript)/Ri"; reference:url,secunia.com/advisories/49627/; classtype:web-application-attack; sid:2014987; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的SAP Crystal Report Server 2008路径参数目录遍历漏洞"; flow:established,to_server; content:"|2e 2e 2f|"; nocase; depth:200; http.uri; content:"/PerformanceManagement/jsp/qa.jsp?"; nocase; content:"func="; nocase; content:"root="; nocase; content:"path="; nocase; reference:url,1337day.com/exploits/15332; classtype:web-application-attack; sid:2015035; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER SQL注入批量插入以将文件内容插入数据库表"; flow:established,to_server; http.uri; content:"BULK"; nocase; content:"INSERT"; nocase; distance:0; reference:url,msdn.microsoft.com/en-us/library/ms188365.aspx; reference:url,msdn.microsoft.com/en-us/library/ms175915.aspx; reference:url,www.sqlteam.com/article/using-bulk-insert-to-load-a-text-file; reference:url,doc.emergingthreats.net/2011035; classtype:web-application-attack; sid:2011035; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER伪造的Googlebot UA 2入站"; flow:established,to_server; http.user_agent; content:"Googlebot-"; fast_pattern; nocase; content:!"Googlebot-News"; startswith; content:!"Googlebot-Image/1.0"; startswith; content:!"Googlebot-Video/1.0"; startswith; content:!"Mobile/2.1|3b| +http|3a|//www.google.com/bot.html)"; endswith; reference:url,www.incapsula.com/the-incapsula-blog/item/369-was-that-really-a-google-bot-crawling-my-site; reference:url,support.google.com/webmasters/bin/answer.py?hl=en&answer=1061943; classtype:network-scan; sid:2015527; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER python访问尝试"; flow:to_server,established; http.uri; content:"python "; nocase; classtype:web-application-attack; sid:2101350; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER author.exe访问"; flow:to_server,established; http.uri; content:"/_vti_bin/_vti_aut/author.exe"; nocase; classtype:web-application-activity; sid:2100952; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER authors.pwd访问"; flow:to_server,established; http.uri; content:"/authors.pwd"; nocase; reference:bugtraq,989; reference:cve,1999-0386; reference:nessus,10078; classtype:web-application-activity; sid:2100951; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER service.cnf访问"; flow:to_server,established; http.uri; content:"/_vti_pvt/service.cnf"; nocase; reference:bugtraq,4078; reference:nessus,10575; classtype:web-application-activity; sid:2100958; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER service.pwd"; flow:to_server,established; http.uri; content:"/service.pwd"; nocase; reference:bugtraq,1205; classtype:web-application-activity; sid:2100959; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER services.cnf访问"; flow:to_server,established; http.uri; content:"/_vti_pvt/services.cnf"; nocase; reference:bugtraq,4078; reference:nessus,10575; classtype:web-application-activity; sid:2100961; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER writeto.cnf访问"; flow:to_server,established; http.uri; content:"/_vti_pvt/writeto.cnf"; nocase; reference:bugtraq,4078; reference:nessus,10575; classtype:web-application-activity; sid:2100965; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER /scripts/iisadmin/default.htm访问"; flow:to_server,established; http.uri; content:"/scripts/iisadmin/default.htm"; nocase; classtype:web-application-attack; sid:2100994; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER global.asa访问"; flow:to_server,established; http.uri; content:"/global.asa"; nocase; reference:cve,2000-0778; reference:nessus,10491; reference:nessus,10991; classtype:web-application-activity; sid:2101016; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER iisadmin访问"; flow:to_server,established; http.uri; content:"/iisadmin"; nocase; reference:bugtraq,189; reference:cve,1999-1538; reference:nessus,11032; classtype:web-application-attack; sid:2100993; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER视图代码访问"; flow:to_server,established; http.uri; content:"/viewcode"; reference:cve,1999-0737; reference:nessus,10576; reference:nessus,12048; classtype:web-application-attack; sid:2101403; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER 403禁止"; flow:from_server,established; http.stat_code; content:"403"; classtype:attempted-recon; sid:2101201; metadata:alarm_type 信息泄露;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER Brutus扫描入站"; flow:established,to_server; http.user_agent; content:"Brutus/AET"; classtype:attempted-recon; sid:2015703; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER已检测到Wordpress登录暴力破解"; flow:to_server,established; threshold: type both, track by_src, count 5, seconds 60; http.method; content:"POST"; http.uri; content:"/wp-login.php"; nocase; http.request_body; content:"log|3d|"; content:"pwd|3d|"; classtype:attempted-recon; sid:2014020; metadata:alarm_type 暴力破解;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"带有模糊PHP的WEB_SERVER图像内容类型（在C99 Shell中可见）"; flow:from_server,established; http.content_type; content:"image/"; startswith; file.data; content:"eval(gzinflate(base64_decode("; distance:0; fast_pattern; reference:url,malwaremustdie.blogspot.jp/2012/10/how-far-phpc99shell-malware-can-go-from.html; classtype:attempted-user; sid:2015755; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"不带t（时间）参数的WEB_SERVER WebResource.axd访问-可能的ASP填充-Oracle漏洞利用"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/WebResource.axd"; nocase; content:!"&t="; nocase; content:!"&amp|3b|t="; nocase; detection_filter:track by_src,count 15,seconds 2; reference:url,netifera.com/research/; reference:url,www.microsoft.com/technet/security/advisory/2416728.mspx; classtype:web-application-attack; sid:2011807; metadata:alarm_type 漏洞利用;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER FaTaLisTiCz_Fx检测到Webshel​​l"; flow:established,from_server; http.cookie; content:"visitz="; file.data; content:"FaTaLisTiCz_Fx"; classtype:web-application-activity; sid:2015811; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER WebShell-通用-基于c99shell的POST结构w / multipart"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"form-data\; name=|22|a|22|"; content:"form-data\; name=|22|c|22|"; content:"form-data\; name=|22|p1|22|"; classtype:attempted-user; sid:2015920; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER WebShell-PHP电子邮件"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"form-data|3b| name=|22|from|22|"; content:"form-data|3b| name=|22|realname|22|"; content:"form-data|3b| name=|22|amount|22|"; classtype:web-application-activity; sid:2015924; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER WebShell-邮递员"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"form-data|3b| name=|22|formSubmited|22|"; content:"form-data|3b| name=|22|scriptPassword|22|"; classtype:misc-activity; sid:2015937; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER PIWIK Backdored版本调用了主页"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/x.php"; http.host; content:"prostoivse.com"; endswith; http.request_body; content:"reff="; nocase; reference:url,piwik.org/blog/2012/11/security-report-piwik-org-webserver-hacked-for-a-few-hours-on-2012-nov-26th/; reference:url,forum.piwik.org/read.php?2,97666; classtype:web-application-attack; sid:2015953; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ColdFusion路径遍历（区域设置1/5）"; flow:to_server,established; content:"locale=../../"; nocase; http.method; content:"POST"; nocase; http.uri; content:"/CFIDE/wizards/common/_logintowizard.cfm"; reference:url,h30507.www3.hp.com/t5/Following-the-White-Rabbit-A/Adobe-ColdFusion-s-Directory-Traversal-Disaster/ba-p/81964; reference:url,www.gnucitizen.org/blog/coldfusion-directory-traversal-faq-cve-2010-2861/; reference:cve,CVE-2010-2861; reference:url,www.exploit-db.com/exploits/14641/; classtype:web-application-attack; sid:2011358; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ColdFusion路径遍历（语言环境2/5）"; flow:to_server,established; content:"locale=../../"; nocase; http.method; content:"POST"; http.uri; content:"/CFIDE/administrator/archives/index.cfm"; nocase; reference:url,h30507.www3.hp.com/t5/Following-the-White-Rabbit-A/Adobe-ColdFusion-s-Directory-Traversal-Disaster/ba-p/81964; reference:url,www.gnucitizen.org/blog/coldfusion-directory-traversal-faq-cve-2010-2861/; reference:cve,CVE-2010-2861; reference:url,www.exploit-db.com/exploits/14641/; classtype:web-application-attack; sid:2011359; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ColdFusion路径遍历（语言环境5/5）"; flow:to_server,established; content:"locale=../../"; nocase; http.method; content:"POST"; http.uri; content:"/CFIDE/administrator/enter.cfm"; nocase; reference:url,h30507.www3.hp.com/t5/Following-the-White-Rabbit-A/Adobe-ColdFusion-s-Directory-Traversal-Disaster/ba-p/81964; reference:url,www.gnucitizen.org/blog/coldfusion-directory-traversal-faq-cve-2010-2861/; reference:cve,CVE-2010-2861; reference:url,www.exploit-db.com/exploits/14641/; classtype:web-application-attack; sid:2011362; metadata:alarm_type 目录遍历;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-JSP文件管理-POST结构-目录"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"dir="; content:"&sort="; content:"&command="; content:"&Submit="; classtype:attempted-user; sid:2016153; metadata:alarm_type Webshell;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER ColdFusion adminapi访问"; flow:established,to_server; http.method; content:"GET"; nocase; http.uri; content:"/CFIDE/adminapi"; nocase; reference:url,www.adobe.com/support/security/advisories/apsa13-01.html; classtype:web-application-attack; sid:2016183; metadata:alarm_type Webshell;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER ColdFusion组件实用程序访问"; flow:established,to_server; http.method; content:"GET"; nocase; http.uri; content:"/CFIDE/componentutils"; nocase; reference:url,www.adobe.com/support/security/advisories/apsa13-01.html; classtype:web-application-attack; sid:2016182; metadata:alarm_type Webshell;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER ColdFusion管理员访问权限"; flow:established,to_server; http.method; content:"GET"; nocase; http.uri; content:"/CFIDE/administrator"; nocase; reference:url,www.adobe.com/support/security/advisories/apsa13-01.html; classtype:web-application-attack; sid:2016184; metadata:alarm_type Webshell;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"Joomla / com_content /目录中的WEB_SERVER非标准HTML页面"; flow:established,to_server; http.uri; content:"/components/com_content/"; content:!"index.html"; nocase; within:10; content:".html"; nocase; distance:0; classtype:bad-unknown; sid:2016311; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER WSO WebShell活动POST结构2"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:" name=|22|c|22|"; content:"name=|22|p1|22|"; fast_pattern; pcre:"/name=(?P<q>[\x22\x27])a(?P=q)[^\r\n]*\r\n[\r\n\s]+(?:S(?:e(?:lfRemove|cInfo)|tringTools|afeMode|ql)|(?:Bruteforc|Consol)e|FilesMan|Network|Logout|Php)/i"; classtype:attempted-user; sid:2016354; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER WebShell-通用-基于c99shell的POST结构"; flow:established,to_server; content:"|0d 0a 0d 0a|act="; fast_pattern; http.method; content:"POST"; http.request_body; content:"act="; depth:4; content:"&d="; within:20; classtype:attempted-user; sid:2016516; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-MySQL接口-客户端Cookie mysql_web_admin * ="; flow:established,to_server; http.cookie; content:"mysql_web_admin_"; classtype:bad-unknown; sid:2016575; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER WebShell-MySQL接口-服务器设置Cookie mysql_web_admin * ="; flow:established,to_client; http.cookie; content:"mysql_web_admin_"; classtype:bad-unknown; sid:2016576; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的SQL注入（varchar2）"; flow:established,to_server; http.uri; content:"varchar2("; nocase; reference:url,doc.emergingthreats.net/2008175; classtype:attempted-admin; sid:2016596; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER LOIC Javascript DDoS入站"; flow:established,to_server; threshold: type both, track by_src, count 5, seconds 60; http.method; content:"GET"; http.uri; content:"?id="; content:"&msg="; distance:13; within:5; pcre:"/\?id=[0-9]{13}&msg=[^&]+$/"; reference:url,isc.sans.org/diary/Javascript+DDoS+Tool+Analysis/12442; reference:url,www.wired.com/threatlevel/2012/01/anons-rickroll-botnet; classtype:attempted-dos; sid:2014140; metadata:alarm_type DDos;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 200响应中的WEB_SERVER SQL错误（mssql_query）"; flow:from_server,established; http.stat_code; content:"200"; file.data; content:"mssql_query"; classtype:bad-unknown; sid:2016664; metadata:alarm_type SQL注入;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 500响应中的WEB_SERVER SQL错误（mssql_query）"; flow:from_server,established; http.stat_code; content:"500"; file.data; content:"mssql_query"; classtype:bad-unknown; sid:2016665; metadata:alarm_type SQL注入;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 200响应中的WEB_SERVER SQL错误（pgsql_query）"; flow:from_server,established; http.stat_code; content:"200"; file.data; content:"pgsql_query"; classtype:bad-unknown; sid:2016666; metadata:alarm_type SQL注入;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 500响应中的WEB_SERVER SQL错误（pgsql_query）"; flow:from_server,established; http.stat_code; content:"500"; file.data; content:"pgsql_query"; classtype:bad-unknown; sid:2016667; metadata:alarm_type SQL注入;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 200响应中的WEB_SERVER SQL错误（mysql_query）"; flow:from_server,established; http.stat_code; content:"200"; file.data; content:"mysql_query"; classtype:bad-unknown; sid:2016668; metadata:alarm_type SQL注入;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 500响应中的WEB_SERVER SQL错误（mysql_query）"; flow:from_server,established; http.stat_code; content:"500"; file.data; content:"mysql_query"; classtype:bad-unknown; sid:2016669; metadata:alarm_type SQL注入;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 200响应中的WEB_SERVER SQL错误（SqlException）"; flow:from_server,established; http.stat_code; content:"200"; file.data; content:"SqlException"; classtype:bad-unknown; sid:2016670; metadata:alarm_type SQL注入;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 500响应中的WEB_SERVER SQL错误（SqlException）"; flow:from_server,established; http.stat_code; content:"500"; file.data; content:"SqlException"; classtype:bad-unknown; sid:2016671; metadata:alarm_type SQL注入;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 500响应中的WEB_SERVER SQL错误（SQL语法错误）"; flow:from_server,established; http.stat_code; content:"500"; file.data; content:"error in your SQL syntax"; classtype:bad-unknown; sid:2016673; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell通用-Netsh防火墙"; flow:established,to_server; http.request_body; content:"netsh"; nocase; fast_pattern; content:"firewall"; within:15; classtype:bad-unknown; sid:2016681; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell通用-注册表HKEY_LOCAL_MACHINE"; flow:established,to_server; http.request_body; content:"reg"; nocase; content:"HKEY_LOCAL_MACHINE"; nocase; within:80; classtype:bad-unknown; sid:2016682; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell通用-wget http-POST"; flow:established,to_server; http.request_body; content:"wget"; nocase; content:"http"; nocase; within:11; classtype:bad-unknown; sid:2016683; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 200响应中的WEB_SERVER SQL错误（接近或接近ERROR语法错误）"; flow:from_server,established; http.stat_code; content:"200"; file.data; content:"ERROR|3a|  syntax error at or near"; classtype:bad-unknown; sid:2016674; metadata:alarm_type SQL注入;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"HTTP 500响应中的WEB_SERVER SQL错误（接近或接近ERROR语法错误）"; flow:from_server,established; http.stat_code; content:"500"; file.data; content:"ERROR|3a|  syntax error at or near"; classtype:bad-unknown; sid:2016675; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-PHPShell-Haxplorer URI"; flow:established,to_server; http.uri; content:".php?&s=r&cmd=dir&dir="; classtype:attempted-user; sid:2016761; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-PHPShell-PHPKonsole URI"; flow:established,to_server; http.uri; content:".php?&s=r&cmd=con"; classtype:attempted-user; sid:2016762; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Wordpress Super Cache插件PHP注入mfunc"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"comment"; nocase; content:"mfunc"; fast_pattern; nocase; distance:0; pcre:"/(?:%3C%21|\<\!)--[\r\n\s]*?mfunc/i"; classtype:attempted-user; sid:2016788; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Wordpress Super Cache插件PHP注入mclude"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"comment"; nocase; content:"mclude"; fast_pattern; nocase; distance:0; pcre:"/(?:%3C%21|\<\!)--[\r\n\s]*?mclude/i"; classtype:attempted-user; sid:2016789; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Wordpress Super Cache插件PHP注入dynamic-cached-content"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"comment"; nocase; content:"dynamic-cached-content"; fast_pattern; nocase; distance:0; pcre:"/(?:%3C%21|\<\!)--[\r\n\s]*?dynamic-cached-content/i"; classtype:attempted-user; sid:2016790; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET 8880 (msg:"WEB_SERVER Plesk面板可能的HTTP_AUTH_LOGIN SQLi CVE-2012-1557"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/enterprise/control/agent.php"; http.header; content:"HTTP_AUTH_LOGIN|3a|"; pcre:"/^[^\r\n]*?[\x27\x22\t\\%\x00\x08\x26]/R"; reference:cve,CVE-2012-1557; classtype:attempted-user; sid:2016792; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的SQL注入尝试char（）与Danmec相关"; flow:established,to_server; http.uri; content:"CHAR("; nocase; pcre:"/^[0-9]{2,3}\)char\([^\x0d\x0a\x20]{98}/Ri"; classtype:attempted-admin; sid:2014352; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ColdFusion password.properties访问"; flow:established,to_server; http.method; content:"GET"; nocase; http.uri; content:"password.properties"; nocase; reference:url,cxsecurity.com/issue/WLB-2013050065; classtype:web-application-attack; sid:2016836; metadata:alarm_type 未授权访问;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER ColdFusion路径公开以获取绝对路径"; flow:established,to_server; http.method; content:"GET"; nocase; http.uri; content:"/administrator/analyzer/index.cfm"; nocase; http.uri.raw; content:"|2e 2e 2f|"; reference:url,www.exploit-db.com/exploits/25305/; classtype:web-application-attack; sid:2016841; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ColdFusion调度任务访问"; flow:established,to_server; http.uri; content:"/CFIDE/administrator/scheduler/scheduletasks.cfm"; nocase; reference:url,exploit-db.com/exploits/24946/; classtype:web-application-attack; sid:2016842; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ColdFusion时间表编辑访问"; flow:established,to_server; http.uri; content:"/CFIDE/administrator/scheduler/scheduleedit.cfm"; nocase; reference:url,exploit-db.com/exploits/24946/; classtype:web-application-attack; sid:2016843; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER访问/ phppath / php可能的Plesk 0天漏洞利用2013年6月5日"; flow:established,to_server; http.uri; content:"/phppath/php"; pcre:"/^\b/R"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:attempted-admin; sid:2016983; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell通用-已上传ELF文件"; flow:established,to_server; http.request_body; content:"|7F|ELF"; classtype:bad-unknown; sid:2017054; metadata:alarm_type Webshell;)
alert http any any -> any any (msg:"WEB_SERVER WebShell-GODSpy-Cookie"; flow:established; http.cookie; content:"godid="; classtype:trojan-activity; sid:2017085; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-GODSPy-身份验证"; flow:established,to_server; http.request_body; content:"ctr="; content:"haz=pasa"; classtype:trojan-activity; sid:2017088; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-Pouya-URI-raiz"; flow:established,to_server; http.uri; content:".asp?raiz="; classtype:trojan-activity; sid:2017090; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER叶子PHPMailer"; flow:established,to_client; file.data; content:"Leaf PHPMailer</title>"; fast_pattern; content:"<li>[-email-] : <b>Reciver Email"; content:"<li>[-emailuser-] : <b>Email User"; classtype:web-application-attack; sid:2030016; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在受损的内部服务器上访问WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<title>D3V1l H4X0R Priv8 Shell"; fast_pattern; classtype:web-application-attack; sid:2030018; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在受损的内部服务器上访问WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"Upload File : <input type=|22|file|22 20|name=|22|file|22|"; fast_pattern; nocase; content:">Name</center></td>"; nocase; distance:0; content:">Size</center></td>"; nocase; distance:0; content:">Permissions</center></td>"; nocase; distance:0; content:">Options</center></td>"; nocase; distance:0; content:"<option value=|22|delete|22|>Delete</option>"; nocase; distance:0; content:"<option value=|22|chmod|22|>Chmod</option>"; nocase; distance:0; content:"<option value=|22|rename|22|>Rename</option>"; nocase; distance:0; content:"<form method=|22|POST|22 20|action=|22|?option&path="; nocase; distance:0; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2030020; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在受损的内部服务器上访问WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<title>-:- Stupidc0de Shell"; nocase; fast_pattern; classtype:web-application-attack; sid:2030022; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell通用-已上传ASP文件"; flow:established,to_server; http.request_body; content:"|0D 0A|"; content:"<%"; within:5; fast_pattern; content:"%>"; distance:0; pcre:"/<%[\x00-\x7f]{20}/"; classtype:trojan-activity; sid:2017260; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的OpenX后门后门访问flowplayer的POST"; flow:established,to_server; http.method; content:"POST"; nocase; http.uri; content:"/flowplayer-3.1.1.min.js"; nocase; reference:url,blog.sucuri.net/2013/08/openx-org-compromised-and-downloads-injected-with-a-backdoor.html; classtype:trojan-activity; sid:2017280; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Apache Struts OGNL命令执行CVE-2013-2251重定向"; flow:established,to_server; http.uri; content:".action?"; content:"redirect|3a|"; distance:0; content:"{"; distance:0; pcre:"/[\?&]redirect\x3a/"; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; classtype:attempted-user; sid:2017155; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Apache Struts OGNL命令执行CVE-2013-2251 redirectAction"; flow:established,to_server; http.uri; content:".action?"; content:"redirectAction|3a|"; distance:0; content:"{"; distance:0; pcre:"/[\?&]redirectAction\x3a/"; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; classtype:attempted-user; sid:2017156; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Apache Struts OGNL命令执行CVE-2013-2251操作"; flow:established,to_server; http.uri; content:".action?"; content:"action|3a|"; distance:0; content:"{"; distance:0; pcre:"/[\?&]action\x3a/"; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; classtype:attempted-user; sid:2017157; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-ASPyder-文件浏览器-POST结构"; flow:established,to_server; http.method; content:"POST"; nocase; http.request_body; content:"txtpath="; depth:8; content:"&cmd="; classtype:trojan-activity; sid:2017392; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-ASPyder-文件上传-POST结构"; flow:established,to_server; http.method; content:"POST"; nocase; http.uri; content:"?upload=@&txtpath="; http.request_body; content:"Upload !"; classtype:trojan-activity; sid:2017393; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"POST中的WEB_SERVER可能的加密Webshel​​l"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"eval"; content:"mcrypt_decrypt"; distance:0; reference:url,blog.sucuri.net/2013/10/backdoor-evasion-using-encrypted-content.html; classtype:bad-unknown; sid:2017641; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的SUPERMICRO IPMI login.cgi名称参数缓冲区溢出尝试CVE-2013-3621"; flow:established,to_server; http.method; content:"POST"; nocase; http.uri; content:"/cgi/login.cgi"; nocase; http.request_body; content:"name="; nocase; content:"pwd="; nocase; pcre:"/(?:^|[\n\&])pwd=/i"; pcre:"/(?:^|[\n\&])name=(?:%\d{2}|[^%&]){129}/i"; reference:cve,CVE-2013-3621; reference:url,community.rapid7.com/community/metasploit/blog/2013/11/06/supermicro-ipmi-firmware-vulnerabilities; classtype:attempted-admin; sid:2017684; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的SUPERMICRO IPMI login.cgi PWD参数缓冲区溢出尝试CVE-2013-3621"; flow:established,to_server; http.method; content:"POST"; nocase; http.uri; content:"/cgi/login.cgi"; nocase; http.request_body; content:"name="; nocase; content:"pwd="; nocase; pcre:"/(?:^|[\n\&])name=/i"; pcre:"/(?:^|[\n\&])pwd=(?:%\d{2}|[^%&]){25}/i"; reference:cve,CVE-2013-3621; reference:url,community.rapid7.com/community/metasploit/blog/2013/11/06/supermicro-ipmi-firmware-vulnerabilities; classtype:attempted-admin; sid:2017685; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的SUPERMICRO IPMI close_window.cgi sess_sid参数缓冲区溢出尝试CVE-2013-3623"; flow:established,to_server; http.method; content:"POST"; nocase; http.uri; content:"/cgi/close_window.cgi"; nocase; http.request_body; content:"sess_sid="; nocase; pcre:"/(?:^|[\n\&])sess_sid=(?:%\d{2}|[^%&]){21}/"; reference:cve,CVE-2013-3623; reference:url,community.rapid7.com/community/metasploit/blog/2013/11/06/supermicro-ipmi-firmware-vulnerabilities; classtype:attempted-admin; sid:2017686; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的SUPERMICRO IPMI close_window.cgi ACT参数缓冲区溢出尝试CVE-2013-3623"; flow:established,to_server; http.method; content:"POST"; nocase; http.uri; content:"/cgi/close_window.cgi"; nocase; http.request_body; content:"ACT="; nocase; pcre:"/(?:^|[\n\&])ACT=(?:%\d{2}|[^%&]){21}/i"; reference:cve,CVE-2013-3623; reference:url,community.rapid7.com/community/metasploit/blog/2013/11/06/supermicro-ipmi-firmware-vulnerabilities; classtype:attempted-admin; sid:2017687; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的SUPERMICRO IPMI url_redirect.cgi目录遍历尝试"; flow:established,to_server; http.method; content:"GET"; nocase; http.uri; content:"/cgi/url_redirect.cgi"; nocase; http.uri.raw; content:"|2e 2e 2f|"; reference:url,community.rapid7.com/community/metasploit/blog/2013/11/06/supermicro-ipmi-firmware-vulnerabilities; classtype:attempted-admin; sid:2017688; metadata:alarm_type 目录遍历;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的WebLogic管理员使用默认凭据登录"; flow:to_server,established; http.method; content:"POST"; nocase; http.uri; content:"/console/j_security_check"; nocase; http.request_body; content:"j_username=system"; nocase; content:"j_password=Passw0rd"; reference:url,media.blackhat.com/us-13/US-13-Polyakov-Practical-Pentesting-of-ERPs-and-Business-Applications-Slides.pdf; classtype:attempted-admin; sid:2017803; metadata:alarm_type 弱口令;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的WebLogic管理员使用默认凭据登录"; flow:to_server,established; http.method; content:"POST"; nocase; http.uri; content:"/console/j_security_check"; nocase; http.request_body; content:"j_username=system"; content:"j_password=password"; reference:url,media.blackhat.com/us-13/US-13-Polyakov-Practical-Pentesting-of-ERPs-and-Business-Applications-Slides.pdf; classtype:attempted-admin; sid:2017804; metadata:alarm_type 弱口令;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的WebLogic Monitor使用默认凭据登录"; flow:to_server,established; http.method; content:"POST"; nocase; http.uri; content:"/console/j_security_check"; nocase; http.request_body; content:"j_username=monitor"; content:"j_password=password"; reference:url,media.blackhat.com/us-13/US-13-Polyakov-Practical-Pentesting-of-ERPs-and-Business-Applications-Slides.pdf; classtype:attempted-user; sid:2017805; metadata:alarm_type 弱口令;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的WebLogic操作员使用默认凭据登录"; flow:to_server,established; http.method; content:"POST"; nocase; http.uri; content:"/console/j_security_check"; nocase; http.request_body; content:"j_username=operator"; content:"j_password=password"; reference:url,media.blackhat.com/us-13/US-13-Polyakov-Practical-Pentesting-of-ERPs-and-Business-Applications-Slides.pdf; classtype:attempted-user; sid:2017806; metadata:alarm_type 弱口令;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的MySQL SQLi用户转储尝试"; flow:to_server,established; http.uri; content:"select"; nocase; content:"mysql.user"; nocase; distance:1; reference:url,pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet; classtype:web-application-attack; sid:2017807; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER可能的MySQL SQLi尝试信息架构访问"; flow:to_server,established; http.uri; content:"information_schema"; nocase; reference:url,pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet; classtype:web-application-attack; sid:2017808; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ATTACKER WebShell-PHP违规者-POST命令"; flow:established,to_server; http.request_body; content:"work_dir="; content:"command="; content:"submit_btn=Execute+Command"; classtype:web-application-attack; sid:2017952; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Oracle报告表格RCE CVE-2012-3152"; flow:established,to_server; http.uri; content:"/reports/rwservlet?"; nocase; content:"JOBTYPE"; nocase; content:"rwurl"; nocase; content:"URLPARAMETER"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]?(?:f(?:ile|tp)|gopher|https?|mailto)\s*?\x3a/Ri"; reference:url,netinfiltration.com; classtype:web-application-attack; sid:2018092; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> any any (msg:"WEB_SERVER AntSword Webshel​​l命令入站"; flow:established,to_server; http.method; content:"POST"; http.header; content:"User-Agent|3a 20|antSword/v"; fast_pattern; http.request_body; content:"cmd="; depth:4; reference:url,github.com/AntSwordProject/antSword; classtype:web-application-attack; sid:2030036; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> any any (msg:"WEB_SERVER可能的AntSword Webshel​​l命令入站"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"Response.Write(|25|22"; within:50; nocase; content:"eval(System.Text.Encoding.GetEncoding(|25|22"; nocase; distance:0; content:"|25|22).GetString(System.Convert.FromBase64String(|25|22"; nocase; distance:0; content:")|25|3BResponse.End()|25|3B&"; nocase; distance:0; fast_pattern; reference:url,github.com/AntSwordProject/antSword; classtype:web-application-attack; sid:2030037; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用邮件程序"; flow:established,to_client; file.data; content:"<title>Cazanova SMTP Mailer"; nocase; content:">Cazanova SMTP Mailer</div>"; nocase; distance:0; classtype:web-application-attack; sid:2030060; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用邮件程序"; flow:established,to_client; file.data; content:"SCRIPT MAILER INBOX"; content:">SMTP Login:</font></div>"; nocase; distance:0; fast_pattern; classtype:web-application-attack; sid:2030062; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用邮件检查"; flow:established,to_client; file.data; content:"Upload is <b><"; content:"Check  Mailling ..<br>"; nocase; distance:0; fast_pattern; content:"<input type=|22|submit|22 20|value=|22|Send test >>|22|>"; nocase; distance:0; classtype:web-application-attack; sid:2030064; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<form method=post style=|22|font-family:fantasy|3b 22|>"; content:"Password: <input type=password name=pass style=|22|background-color|3a|whitesmoke|3b|border|3a|1px solid #FFF|3b 22|><input type=submit value='>>' style=|22|border|3a|none|3b|background-color|3a|"; nocase; distance:0; fast_pattern; classtype:web-application-attack; sid:2030066; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP搜寻器"; flow:established,to_server; threshold:type limit, track by_src, count 1, seconds 300; http.user_agent; content:"PHPCrawl"; depth:8; reference:url,phpcrawl.cuab.de/; classtype:attempted-user; sid:2018607; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Adob​​e Flash Player Rosetta Flash在URI中压缩了CWS"; flow:established,to_server; urilen:>70; http.uri; content:"callback=CWS"; nocase; pcre:"/^[a-z0-9\.\_]{5}hC[a-z0-9\.\_]{50}/Ri"; reference:url,miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/; reference:cve,2014-4671; classtype:attempted-user; sid:2018740; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<title>Genol Shell"; nocase; fast_pattern; content:"><b>Uname|20 3a 20|Linux|20|"; nocase; distance:0; metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2030074; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<title> Mailer Created By"; nocase; fast_pattern; content:"type=|22|submit|22 20|name=|22|Enoc|22 20|value=|22|Enviar|22|"; nocase; distance:0; classtype:web-application-attack; sid:2030076; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用邮件程序"; flow:established,to_client; file.data; content:"<title>alexusMailer 2.0</title>"; nocase; fast_pattern; classtype:web-application-attack; sid:2030078; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用被盗凭证"; flow:established,to_client; file.data; content:"---------0nline Inf0---------------"; nocase; fast_pattern; content:"Email"; nocase; distance:0; content:"Password"; nocase; distance:0; classtype:web-application-attack; sid:2030080; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用被盗凭证"; flow:established,to_client; file.data; content:">E-MAIL INFORMATION</font> ]-_-_-_-_-_-_-"; nocase; fast_pattern; content:">INFO VICTIM</font> ]-_-_-_-_-_-_-"; nocase; distance:0; classtype:web-application-attack; sid:2030082; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER内部服务器上访问的Cpanel Cracker"; flow:established,to_client; file.data; content:"<title>HEx CPanel Cracker"; nocase; fast_pattern; content:"<strong>CPanelCracker Script"; nocase; distance:0; classtype:web-application-attack; sid:2030084; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用邮件程序"; flow:established,to_client; file.data; content:"<title>Pro Mailer V2</title>"; nocase; classtype:web-application-attack; sid:2030086; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的SQL注入尝试SELECT FROM"; flow:established,to_server; http.uri; content:"SELECT"; nocase; content:"FROM"; nocase; distance:0; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,doc.emergingthreats.net/2006445; classtype:web-application-attack; sid:2006445; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER SQL sp_start_job尝试"; flow:to_server,established; http.uri; content:"sp_start_job"; nocase; reference:url,doc.emergingthreats.net/2010004; classtype:attempted-user; sid:2010004; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的SQL注入INTO OUTFILE任意文件写入尝试"; flow:established,to_server; http.uri; content:"INTO"; nocase; content:"OUTFILE"; nocase; distance:0; reference:url,www.milw0rm.com/papers/372; reference:url,www.greensql.net/publications/backdoor-webserver-using-mysql-sql-injection; reference:url,websec.wordpress.com/2007/11/17/mysql-into-outfile/; reference:url,doc.emergingthreats.net/2010037; classtype:web-application-attack; sid:2010037; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER SQL注入尝试（Agent CZ32ts）"; flow:to_server,established; http.user_agent; content:"CZ32ts"; nocase; reference:url,doc.emergingthreats.net/2009029; reference:url,www.Whitehatsecurityresponse.blogspot.com; classtype:web-application-attack; sid:2010621; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"URI中的WEB_SERVER / bin / bash，可能在Web Exploit中尝试执行Shell命令"; flow:established,to_server; http.uri; content:"/bin/bash"; reference:url,doc.emergingthreats.net/2010667; classtype:web-application-attack; sid:2010667; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP扫描前体"; flow:established,to_server; http.uri; content:"/thisdoesnotexistahaha.php"; reference:url,doc.emergingthreats.net/2010720; classtype:web-application-attack; sid:2010720; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER Casper Bot搜索RFI扫描"; flow:established,to_server; http.user_agent; content:"Casper Bot"; nocase; reference:url,doc.emergingthreats.net/2011175; classtype:web-application-attack; sid:2011175; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER DD-WRT信息公开尝试"; flow:established,to_server; flowbits:set,et.ddwrt.infodis; http.uri; content:"/Info.live.htm"; nocase; reference:url,www.exploit-db.com/exploits/15842/; classtype:attempted-recon; sid:2012116; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER PHP URI中的大型次普通双精度浮点数PHP DoS"; flow:established,to_server; http.uri; content:"2.2250738585072011e-308"; nocase; reference:url,bugs.php.net/bug.php?id=53632; classtype:attempted-dos; sid:2012150; metadata:alarm_type DDos;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Joomla组件SQLi尝试"; flow:established,to_server; http.uri; content:"option=com_"; nocase; content:"union"; nocase; distance:0; content:"select"; nocase; distance:0; content:"from"; nocase; distance:0; content:"jos_users"; distance:0; nocase; fast_pattern; classtype:web-application-attack; sid:2015984; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Ruby on Rails CVE-2013-0333尝试"; flow:established,to_server; http.request_body; content:"!ruby/"; nocase; content:"NamedRouteCollection"; nocase; reference:url,gist.github.com/4660248; classtype:web-application-activity; sid:2016305; metadata:alarm_type 漏洞利用;)
alert http any any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP Cookie"; flow:established,to_server; http.cookie; content:"|28 29 20 7b|"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019239; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER WEB-PHP phpinfo访问"; flow:to_server,established; http.uri; content:"/phpinfo.php"; nocase; reference:bugtraq,5789; reference:cve,2002-1149; reference:url,www.osvdb.org/displayvuln.php?osvdb_id=3356; classtype:successful-recon-limited; sid:2019526; metadata:alarm_type 信息泄露;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER printenv访问"; flow:to_server,established; http.uri; content:"/printenv"; reference:bugtraq,1658; reference:cve,2000-0868; reference:nessus,10188; reference:nessus,10503; classtype:web-application-activity; sid:2101877; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HOME_NET [9200,9292] (msg:"WEB_SERVER可能的CVE-2014-3120弹性搜索远程代码执行尝试"; flow:established,to_server; http.uri; content:"search"; nocase; content:"source="; nocase; distance:0; content:"script_fields"; nocase; distance:0; content:"import"; distance:0; nocase; content:"java."; nocase; distance:0; reference:url,bouk.co/blog/elasticsearch-rce/; classtype:attempted-admin; sid:2018495; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER PHP.//HTTP POST中的输入"; flow:established,to_server; http.method; content:"POST"; http.uri.raw; content:"php|3a 2f 2f|input"; fast_pattern; http.request_body; content:"<?"; depth:2; reference:url,www.deependresearch.org/2014/07/another-linux-ddos-bot-via-cve-2012-1823.html; classtype:trojan-activity; sid:2019804; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"URI（../）中的WEB_SERVER双重编码字符"; flow:to_server,established; http.uri.raw; content:"%252E%252E%252F"; nocase; classtype:misc-attack; sid:2019880; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER Insomnia Shell HTTP请求"; flow:to_server,established; http.method; content:"POST"; http.uri; content:".aspx"; http.request_body; content:"txtRemoteHost="; fast_pattern; content:"txtRemotePort="; distance:0; content:"txtBindPort="; distance:0; content:"txtPipeName="; distance:0; reference:url,www.insomniasec.com/releases; classtype:trojan-activity; sid:2019899; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER检测到Weevely PHP后门（使用了shell_exec（）函数）"; flow:to_server,established; http.header; content:"aGVsbF9l"; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013939; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER检测到Weevely PHP后门（使用了proc_open（）函数）"; flow:to_server,established; http.header; content:"JHAgPSBhcnJheShhcnJh"; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013940; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER检测到Weevely PHP后门（使用了popen（）函数）"; flow:to_server,established; http.header; content:"JGggPSBwb3Bl"; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013941; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER检测到Weevely PHP后门（使用了perl-> system（）函数）"; flow:to_server,established; http.header; content:"JHBlcmwgPSBuZXcg"; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013944; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER检测到Weevely PHP后门（使用了exec（）函数）"; flow:to_server,established; http.header; content:"ZXhlYygn"; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013945; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER检测到Weevely PHP后门（使用了system（）函数）"; flow:to_server,established; http.header; content:"QHN5c3Rl"; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013937; metadata:alarm_type 木马病毒;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER MorXploit Shell命令"; flow:established,to_server; http.uri; content:"?cmd=ZXhpdA=="; fast_pattern; http.user_agent; content:"Mozilla 5"; startswith; reference:url,seclists.org/fulldisclosure/2014/Nov/78; classtype:bad-unknown; sid:2019951; metadata:alarm_type Webshell;)
alert http any any -> any any (msg:"WEB_SERVER ATTACKER WebShell-1337w0rm-cPanel Cracker"; flow:established,to_server; http.request_body; content:"user=CRACKER"; classtype:trojan-activity; sid:2020097; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"HTTP POST中的WEB_SERVER PHP系统命令"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"<?"; content:"system|28|"; distance:0; classtype:web-application-attack; sid:2020102; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER WPScan用户代理"; flow:established,to_server; threshold: type limit, count 1, seconds 60, track by_src; http.user_agent; content:"WPScan v"; depth:8; reference:url,github.com/wpscanteam/wpscan; classtype:web-application-attack; sid:2020338; metadata:alarm_type 恶意扫描;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER ATTACKER WebShell-Weevely-已发布"; flow:established,to_server; http.request_body; content:"<?php|0A|$"; content:"="; distance:4; within:2; content:" str_replace("; distance:0; classtype:trojan-activity; sid:2020556; metadata:alarm_type Webshell;)
alert http any any -> $EXTERNAL_NET any (msg:"WEB_SERVER ATTACKER WebShell-Weevely-Cookie"; flow:established,to_server; http.header; content:"ing|3a| identity|0D 0A|Host|3a|"; http.cookie; content:"SESS="; content:"|3B| SID="; distance:0; content:"|3B| PREF="; distance:0; content:"|3B|SSID="; distance:0; classtype:trojan-activity; sid:2020557; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-ASPyder-文件创建-POST结构"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"Fname="; depth:6; content:"&cmd="; classtype:trojan-activity; sid:2020572; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER利用可疑的PHP注入攻击（cmd =）"; flow:to_server,established; http.method; content:"GET"; nocase; http.uri; content:".php?"; nocase; content:"cmd="; fast_pattern; nocase; pcre:"/[&?]cmd=[^\x26\x28]*(?:cd|\;|echo|cat|perl|curl|wget|id|uname|t?ftp)/i"; reference:cve,2002-0953; reference:url,doc.emergingthreats.net/2010920; classtype:web-application-attack; sid:2010920; metadata:alarm_type SQL注入;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB_SERVER ElasticSearch目录遍历尝试（CVE-2015-3337）"; flow:to_server,established; http.uri.raw; content:"/_plugin/"; fast_pattern; pcre:"/(?:%2(?:52e(?:%2(?:52e(?:%(?:(?:25)?2|c0%a)f|\/)|e(?:%(?:(?:25)?2|c0%a)f|\/))|\.(?:%(?:(?:25)?2|c0%a)f|\/))|e(?:%2(?:52e(?:%(?:(?:25)?2|c0%a)f|\/)|e(?:%(?:(?:25)?2|c0%a)f|\/))|\.(?:%(?:(?:25)?2|c0%a)f|\/)))|\.(?:%2(?:52e(?:%(?:(?:25)?2|c0%a)f|\/)|e(?:%(?:(?:25)?2|c0%a)f|\/))|\.(?:%(?:(?:25)?2|c0%a)f|\/)))/Ri"; reference:cve,2015-3337; classtype:web-application-attack; sid:2021138; metadata:alarm_type 漏洞利用;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用PHP上传器"; flow:established,to_client; file.data; content:"PHP Uploader - By Phenix-TN & Mr.Anderson"; nocase; fast_pattern; content:"<input type=|22|submit|22 20|value=|22|File Reload|22|"; nocase; distance:0; classtype:web-application-attack; sid:2030213; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<title>Witch3r Mini Shell"; nocase; fast_pattern; content:"Mini-Shell</h1></font>"; nocase; distance:0; classtype:web-application-attack; sid:2030217; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER SmailMax PHPMailer"; flow:established,to_client; file.data; content:"SmailMax SMTP Mailer</title>"; fast_pattern; content:"SERVER SETUP</font>"; content:"SMTP Login:</font>";  metadata: former_category WEB_SERVER; classtype:web-application-attack; sid:2030228; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell通用-净用户"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"net"; nocase; content:!"work"; within:4; nocase; content:"user"; nocase; within:11; content:!"-agent"; nocase; within:6; pcre:"/net(?:%(?:25)?20|\s)+user/i"; classtype:bad-unknown; sid:2016680; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受损服务器上访问的WEB_SERVER通用电子邮件欺骗工具"; flow:established,to_client; file.data; content:"<title>Email Spoofer"; content:"id=|22|title|22|>Email Spoofer"; content:"id=|22|from|22 20|placeholder=|22 20|Email Spoofed"; content:"id=|22|name|22 20|placeholder=|22|Name Spoofed"; content:"var mailist = $(|22|#to|22|).val().split("; classtype:web-application-attack; sid:2030246; metadata:alarm_type 未授权访问;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER WebShell-ASPyder-身份验证"; flow:established,to_server; http.request_body; content:!"&date="; content:"code="; depth:5; content:"&submit="; distance:0; classtype:trojan-activity; sid:2017389; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<title>anaLTEAM"; nocase; fast_pattern; content:"name=|22|command|22 20|value=|22|Crotz|22|"; nocase; distance:0; content:"value=|22|Upload Bos"; nocase; distance:0; classtype:web-application-attack; sid:2030319; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<title>b374k"; nocase; fast_pattern; content:"class='inputz' type='password"; nocase; distance:0; content:"class='inputzbut' type='submit'"; nocase; distance:0; classtype:web-application-attack; sid:2030321; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用Webshel​​l"; flow:established,to_client; file.data; content:"<title> By Gentoo"; nocase; fast_pattern; content:"<h2>Gentoo @ MyHack"; nocase; distance:0; content:"function ChMod(chdir, file) {var o = prompt('Chmod:"; nocase; distance:0; classtype:web-application-attack; sid:2030323; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受感染的服务器上访问WEB_SERVER通用Webshel​​l密码提示"; flow:established,to_client; file.data; content:"<pre align=center><form method=post>Password: <input type='password' name='pass'><input type='submit' value='>>'></form></pre>"; fast_pattern; classtype:web-application-attack; sid:2030325; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受感染的服务器上访问WEB_SERVER通用Webshel​​l密码提示"; flow:established,to_client; file.data; content:"<form|20 20 20|method=|20 22|post|22 20|action=|20 22 22|>|20|<input type=|22|input|22 20|name =|22|f_pp|22 20|value=|20 22 22|/><input type=|20 22|submit|22 20|value=|20 22|&gt|3b 22|/>"; fast_pattern; classtype:web-application-attack; sid:2030327; metadata:alarm_type Webshell;)
alert tcp any any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB_SERVER可能的CVE-2014-6271尝试使用HTTP版本号"; flow:established,to_server; http.protocol; content:"|28 29 20 7b|"; startswith; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:2019236; metadata:alarm_type 漏洞利用;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER可能受损的Web服务器检索注入"; flow:established,to_server; http.uri; content:"/blog/?"; depth:7; pcre:"/^\/blog\/\?[a-z]+&utm_source=\d+\x3a\d+\x3a\d+$/"; http.host; pcre:"/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\x3a\d{1,5})?$/"; classtype:trojan-activity; sid:2022485; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Apache Struts OGNL命令执行CVE-2013-2251重定向"; flow:established,to_server; http.request_body; content:"redirect|3a|"; content:"{"; distance:0; pcre:"/\bredirect\x3a/"; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; classtype:attempted-user; sid:2017174; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Apache Struts OGNL命令执行CVE-2013-2251 redirectAction"; flow:established,to_server; http.request_body; content:"redirectAction|3a|"; content:"{"; pcre:"/\bredirectAction\x3a/"; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; classtype:attempted-user; sid:2017175; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的Apache Struts OGNL命令执行CVE-2013-2251操作"; flow:established,to_server; http.request_body; content:"action|3a|"; content:"{"; distance:0; pcre:"/\baction\x3a/"; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; classtype:attempted-user; sid:2017176; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的自定义内容类型管理器WP后门访问"; flow:established,to_server; http.uri; content:"/plugins/custom-content-type-manager/auto-update.php"; fast_pattern; nocase; reference:url,blog.sucuri.net/2016/03/when-wordpress-plugin-goes-bad.html; classtype:trojan-activity; sid:2022596; metadata:alarm_type 木马病毒;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"WEB_SERVER捕食者在内部受感染服务器上访问的小偷密码提示"; flow:established,to_client; file.data; content:"<title>Predator The Thief"; fast_pattern; nocase; content:"<form method=|22|POST|22 20|class=|22|sign-box|22|"; nocase; distance:0; content:"<input type=|22|text|22 20|class=|22|form-control|22 20|name=|22|login|22 20|value=|22 22 20|placeholder="; nocase; distance:0; content:"<input type=|22|password|22 20|class=|22|form-control|22 20|name=|22|password|22 20|placeholder="; nocase; distance:0; classtype:web-application-attack; sid:2030447; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER通用邮件程序"; flow:established,to_client; file.data; content:"<title>Cordoba Mailer</title>"; nocase; classtype:web-application-attack; sid:2030473; metadata:alarm_type 未授权访问;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"在内部服务器上访问WEB_SERVER FiercePhish密码提示"; flow:established,to_client; file.data; content:"<title>FiercePhish"; fast_pattern; content:"/fiercephish_logo.png|22 20|alt=|22|FiercePhish"; content:"placeholder=|22|Username|22|"; content:"<input type=|22|password|22|"; classtype:web-application-attack; sid:2030499; metadata:alarm_type Webshell;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"内部受感染的服务器上访问WEB_SERVER通用Webshel​​l密码提示"; flow:established,to_client; file.data; content:"<form method=|22|POST|22|>|0d 0a|"; content:"Password|3a 0d 0a|"; distance:0; content:"<input type=|22|hidden|22 20|name=|22|auth|22 20|value=|22|"; distance:0; content:"<input type=|22|password|22 20|name=|22|password|22|>|0d 0a|"; distance:0; content:"<input type=|22|submit|22 20|value=|22|>>|22|>|0d 0a|"; fast_pattern; distance:0; classtype:web-application-attack; sid:2030501; metadata:alarm_type Webshell;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2016-5118利用SVG尝试M1"; flow:established,to_server; http.request_body; content:"<svg"; nocase; content:"|78 6c 69 6e 6b 3a 68 72 65 66 3d 22 7c|"; reference:url,seclists.org/oss-sec/2016/q2/432; reference:cve,2016-5118; classtype:trojan-activity; sid:2022846; metadata:alarm_type 漏洞利用;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB_SERVER可能的CVE-2016-5118利用SVG尝试M2"; flow:established,to_server; http.request_body; content:"<svg"; nocase; content:"|78 6c 69 6e 6b 3a 68 72 65 66 3d 27 7c|"; nocase; reference:url,seclists.org/oss-sec/2016/q2/432; reference:cve,2016-5118; classtype:trojan-activity; sid:2022847; metadata:alarm_type 漏洞利用;)

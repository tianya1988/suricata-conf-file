alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"COINMINER W32 / BitCoinMiner.MultiThreat Stratum协议挖掘。通知初始连接服务器响应"; flow:established,to_client; content:"|22|result|22 3A| [[|22|mining.notify|22|"; depth:120; metadata: former_category COINMINER; reference:url,research.zscaler.com/2013/12/bitcoin-mining-operation-seen-across.html; reference:url,www.btcguild.com/new_protocol.php; reference:url,mining.bitcoin.cz/stratum-mining; classtype:coin-mining; sid:2017872; metadata:alarm_type 挖矿;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"COINMINER W32 / BitCoinMiner.MultiThreat Stratum协议挖掘。通知工作服务器响应"; flow:established,to_client; content:"|22|params|22 3A| [|22|"; depth:120; content:"|22|method|22 3A| |22|mining.notify|22|"; distance:0; metadata: former_category COINMINER; reference:url,research.zscaler.com/2013/12/bitcoin-mining-operation-seen-across.html; reference:url,www.btcguild.com/new_protocol.php; reference:url,mining.bitcoin.cz/stratum-mining; classtype:coin-mining; sid:2017873; metadata:alarm_type 挖矿;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"COINMINER W32 / BitCoinMiner.MultiThreat Getblocktemplate协议服务器连接"; flow:established,to_server; content:"{|22|id|22 3A|"; depth:6; content:"|22|method|22 3A| |22|getblocktemplate|22|"; within:40; metadata: former_category COINMINER; reference:url,en.bitcoin.it/wiki/Getblocktemplate; classtype:coin-mining; sid:2017878; metadata:alarm_type 挖矿;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"COINMINER W32 / BitCoinMiner.MultiThreat Getblocktemplate协议服务器Coinbasetxn开始挖掘响应"; flow:established,to_client; content:"|22|result|22 3A| {"; depth:50; content:"|22|coinbasetxn|22 3A| {"; within:30; content:"|22|data|22 3A| |22|"; within:30; metadata: former_category COINMINER; reference:url,en.bitcoin.it/wiki/Getblocktemplate; classtype:coin-mining; sid:2017879; metadata:alarm_type 挖矿;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 8080: (msg:"代币PrimeCoinMiner.Protominer"; flow:established,to_server; content:"|01 27 00 00 05 00 00 00 09|"; depth:9; content:"node"; nocase; distance:0; within:4; content:"Protominer"; distance:14; within:10; metadata: former_category COINMINER; reference:md5,4cab48eec2b882ec33db2e2a13ecffe6; classtype:coin-mining; sid:2018014; metadata:alarm_type 挖矿;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"COINMINER W32 / BitCoinMiner.MultiThreat订阅/授权层协议消息"; flow:established,to_server; content:"|22|id|22 3A|"; content:"|22|method|22 3A|"; content:"|22|mining."; within:9; content:"|22|params|22|"; within:50; pcre:"/\x22mining\x2E(subscribe|authorize)\x22/"; metadata: former_category COINMINER; reference:url,research.zscaler.com/2013/12/bitcoin-mining-operation-seen-across.html; reference:url,www.btcguild.com/new_protocol.php; reference:url,mining.bitcoin.cz/stratum-mining; classtype:coin-mining; sid:2017871; metadata:alarm_type 挖矿;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"COINMINER加密货币矿工登录"; flow:to_server,established; content:"|7b 22|method|22 3a|"; depth:10; fast_pattern; content:"|22|login|22 2c|"; distance:0; within:9; content:"|22|params|22 3a|"; distance:0; within:10; content:"|7b 22|login"; nocase; distance:0; within:8; content:"agent|22 3a|"; nocase; distance:0; metadata: former_category COINMINER; reference:md5,d1082e445f932938366a449631b82946; reference:md5,33d7a82fe13c9737a103bcc4a21f9425; reference:md5,ebe1aeb5dd692b222f8cf964e7785a55; classtype:coin-mining; sid:2022886; metadata:alarm_type 挖矿;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"在CVE-2017-10271攻击后看到的COINMINER CoinMiner恶意Authline"; flow:established,to_server; content:"{|22|id|22 3A|"; depth:6; content:"|22|method|22 3a 20 22|mining.authorize|22 2c|"; within:100; content:"|22|params|22|"; within:50; content:"|5b 22|4AQe5sAFWZKECiaeNTt59LG7kVtqRoSRJMjrmQ6GiMFAeUvoL3MFeTE6zwwHkFPrAyNw2JHDxUSWL82RiZThPpk4SEg7Vqe|22 2c 20 22|"; distance:0; metadata: former_category COINMINER; reference:url,otx.alienvault.com/pulse/5a4e1c4993199b299f90a212; classtype:coin-mining; sid:2025186; metadata:alarm_type 挖矿;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"检测到Coinminer CoinHive浏览器内矿工"; flow:established,from_server; file_data; content:"coinhive.min.js"; nocase; fast_pattern; content:"start"; nocase; distance:0; content:"script"; content:"var"; distance:0; pcre:"/^\s*(?P<var>[a-zA-Z0-9]{3,20})\s*=\s*new\s*CoinHive\s*\.\s*[^\(]+\(\s*[\x22\x27][A-Za-z0-9]+\s*[\x22\x27]\s*(?:\x2c\s*\x7b\s*\w+\x3a\s*\d\.\d\x7d)?\)\s*\x3b\s+(?P=var)\s*\.\s*start/Ri"; metadata: former_category COINMINER; classtype:coin-mining; sid:2024721; metadata:alarm_type 挖矿;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"COINMINER随机哈希Pascal硬币矿工签到"; flow:established,to_server; content:"{|22|params|22|:[|22|rhminer/"; depth:20; metadata: former_category COINMINER; classtype:coin-mining; sid:2026750; metadata:alarm_type 挖矿;)
alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"COINMINER观察到可疑SSL证书（Minerpool-CoinMining）"; flow:from_server,established; tls_cert_subject; content:"CN=eu.minerpool.pw"; nocase; fast_pattern; endswith; tls_cert_issuer; content:"C=US, O=Let's Encrypt, CN=Let's Encrypt Authority X3"; metadata: former_category COINMINER; classtype:coin-mining; sid:2028623; metadata:alarm_type 挖矿;)
alert dns $HOME_NET any -> any any (msg:"COINMINER观察到对浏览器Coinminer的DNS查询（crypto-loot [。] com）"; dns_query; content:"crypto-loot.com"; endswith; metadata: former_category COINMINER; classtype:coin-mining; sid:2024828; metadata:alarm_type 挖矿;)
alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"COINMINER观察到恶意SSL证书（浏览器挖掘中的Coin-Hive）"; flow:established,to_client; tls_cert_subject; content:"CN=*.coin-hive.com"; nocase; endswith; metadata: former_category COINMINER; classtype:coin-mining; sid:2025536; metadata:alarm_type 挖矿;)
alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"COINMINER观察到恶意SSL证书（Coinhive URL缩短器）"; flow:established,to_client; tls_cert_subject; content:"CN=cnhv.co"; nocase; endswith; metadata: former_category COINMINER; reference:url,blog.sucuri.net/2018/05/cryptomining-through-disguised-url-shorteners.html; classtype:coin-mining; sid:2025582; metadata:alarm_type 挖矿;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"COINMINER比特币采矿扩展头"; flow:to_server,established; http.method; content:"POST"; http.header; content:"X-Mining-Extensions|3a|"; metadata: former_category POLICY; classtype:coin-mining; sid:2016758; metadata:alarm_type 挖矿;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"COINMINER Cryptexplorer API检查-潜在的CoinMiner流量"; flow:established,to_server; http.uri; content:"/api/"; startswith; content:"coin/balance/"; distance:0; fast_pattern; pcre:"/^\/api\/(?:bit|lite)coin\/balance\//"; metadata: former_category COINMINER; reference:md5,8e29a15caef546aab0f19a9a81732163; classtype:coin-mining; sid:2019825; metadata:alarm_type 挖矿;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"COINMINER可能的BitCoin Miner用户代理（miner）"; flow:established,to_server; http.user_agent; content:"miner"; nocase; pcre:"/miner[^a-z]/i"; metadata: former_category COINMINER; reference:url,abcpool.co/mining-software-comparison.php; classtype:coin-mining; sid:2016067; metadata:alarm_type 挖矿;)
